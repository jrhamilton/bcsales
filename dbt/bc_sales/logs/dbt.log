

============================== 2023-04-17 19:06:42.732527 | c670c343-3d3f-4674-adc6-adfbc0546de4 ==============================
[0m19:06:42.732527 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:06:42.733730 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/j/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:06:42.733851 [debug] [MainThread]: Tracking: tracking
[0m19:06:42.734900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a51ef54b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a51ef4970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a51ef5360>]}
[0m19:06:42.742539 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:06:42.742859 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:06:42.743055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c670c343-3d3f-4674-adc6-adfbc0546de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a51f094e0>]}
[0m19:06:43.243689 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m19:06:43.253681 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m19:06:43.298848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c670c343-3d3f-4674-adc6-adfbc0546de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a51e9a8c0>]}
[0m19:06:43.303597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c670c343-3d3f-4674-adc6-adfbc0546de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a51e91c60>]}
[0m19:06:43.303849 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:06:43.304042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c670c343-3d3f-4674-adc6-adfbc0546de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a51ef54b0>]}
[0m19:06:43.304961 [info ] [MainThread]: 
[0m19:06:43.306259 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:06:43.307366 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_tbl'
[0m19:06:43.307675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:43.624783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c670c343-3d3f-4674-adc6-adfbc0546de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a51ef54b0>]}
[0m19:06:43.625408 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:06:43.625640 [info ] [MainThread]: 
[0m19:06:43.629385 [debug] [Thread-1 (]: Began running node test.bc_sales.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:06:43.629716 [debug] [Thread-2 (]: Began running node test.bc_sales.not_null_my_second_dbt_model_id.151b76d778
[0m19:06:43.629998 [debug] [Thread-3 (]: Began running node test.bc_sales.unique_my_first_dbt_model_id.16e066b321
[0m19:06:43.630223 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m19:06:43.630681 [debug] [Thread-4 (]: Began running node test.bc_sales.unique_my_second_dbt_model_id.57a0f8c493
[0m19:06:43.630891 [info ] [Thread-2 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m19:06:43.631212 [info ] [Thread-3 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m19:06:43.631763 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.bc_sales.not_null_my_first_dbt_model_id.5fb22c2710'
[0m19:06:43.631987 [info ] [Thread-4 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m19:06:43.632556 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.bc_sales.not_null_my_second_dbt_model_id.151b76d778'
[0m19:06:43.633046 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.bc_sales.unique_my_first_dbt_model_id.16e066b321'
[0m19:06:43.633273 [debug] [Thread-1 (]: Began compiling node test.bc_sales.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:06:43.633750 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.bc_sales.unique_my_second_dbt_model_id.57a0f8c493'
[0m19:06:43.633954 [debug] [Thread-2 (]: Began compiling node test.bc_sales.not_null_my_second_dbt_model_id.151b76d778
[0m19:06:43.634151 [debug] [Thread-3 (]: Began compiling node test.bc_sales.unique_my_first_dbt_model_id.16e066b321
[0m19:06:43.639725 [debug] [Thread-4 (]: Began compiling node test.bc_sales.unique_my_second_dbt_model_id.57a0f8c493
[0m19:06:43.644669 [debug] [Thread-1 (]: Writing injected SQL for node "test.bc_sales.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:06:43.647966 [debug] [Thread-2 (]: Writing injected SQL for node "test.bc_sales.not_null_my_second_dbt_model_id.151b76d778"
[0m19:06:43.653056 [debug] [Thread-3 (]: Writing injected SQL for node "test.bc_sales.unique_my_first_dbt_model_id.16e066b321"
[0m19:06:43.656172 [debug] [Thread-4 (]: Writing injected SQL for node "test.bc_sales.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:06:43.657119 [debug] [Thread-4 (]: Timing info for test.bc_sales.unique_my_second_dbt_model_id.57a0f8c493 (compile): 2023-04-17 19:06:43.653243 => 2023-04-17 19:06:43.657061
[0m19:06:43.657322 [debug] [Thread-4 (]: Began executing node test.bc_sales.unique_my_second_dbt_model_id.57a0f8c493
[0m19:06:43.657500 [debug] [Thread-3 (]: Timing info for test.bc_sales.unique_my_first_dbt_model_id.16e066b321 (compile): 2023-04-17 19:06:43.648159 => 2023-04-17 19:06:43.657442
[0m19:06:43.662873 [debug] [Thread-2 (]: Timing info for test.bc_sales.not_null_my_second_dbt_model_id.151b76d778 (compile): 2023-04-17 19:06:43.644862 => 2023-04-17 19:06:43.662815
[0m19:06:43.671867 [debug] [Thread-4 (]: Writing runtime sql for node "test.bc_sales.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:06:43.672157 [debug] [Thread-3 (]: Began executing node test.bc_sales.unique_my_first_dbt_model_id.16e066b321
[0m19:06:43.672348 [debug] [Thread-1 (]: Timing info for test.bc_sales.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 2023-04-17 19:06:43.634294 => 2023-04-17 19:06:43.672285
[0m19:06:43.672591 [debug] [Thread-2 (]: Began executing node test.bc_sales.not_null_my_second_dbt_model_id.151b76d778
[0m19:06:43.674667 [debug] [Thread-1 (]: Began executing node test.bc_sales.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:06:43.676580 [debug] [Thread-2 (]: Writing runtime sql for node "test.bc_sales.not_null_my_second_dbt_model_id.151b76d778"
[0m19:06:43.678412 [debug] [Thread-3 (]: Writing runtime sql for node "test.bc_sales.unique_my_first_dbt_model_id.16e066b321"
[0m19:06:43.680981 [debug] [Thread-1 (]: Writing runtime sql for node "test.bc_sales.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:06:43.681310 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:06:43.681713 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:06:43.682003 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:06:43.682584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:06:43.683773 [debug] [Thread-2 (]: On test.bc_sales.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "test.bc_sales.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `datatalksclub-375802`.`bandcamp_sales_tbl`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m19:06:43.684686 [debug] [Thread-4 (]: On test.bc_sales.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "test.bc_sales.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `datatalksclub-375802`.`bandcamp_sales_tbl`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:06:43.685751 [debug] [Thread-1 (]: On test.bc_sales.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "test.bc_sales.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `datatalksclub-375802`.`bandcamp_sales_tbl`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m19:06:43.686610 [debug] [Thread-3 (]: On test.bc_sales.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "test.bc_sales.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `datatalksclub-375802`.`bandcamp_sales_tbl`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:06:44.562632 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "test.bc_sales.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `datatalksclub-375802`.`bandcamp_sales_tbl`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m19:06:44.563236 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset datatalksclub-375802:bandcamp_sales_tbl was not found in location US

Location: US
Job ID: 3a05ee57-357c-47ee-ab1f-b25208c62d0f

[0m19:06:44.563475 [debug] [Thread-2 (]: Timing info for test.bc_sales.not_null_my_second_dbt_model_id.151b76d778 (execute): 2023-04-17 19:06:43.675187 => 2023-04-17 19:06:44.563418
[0m19:06:44.565384 [debug] [Thread-2 (]: Runtime Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  404 Not found: Dataset datatalksclub-375802:bandcamp_sales_tbl was not found in location US
  
  Location: US
  Job ID: 3a05ee57-357c-47ee-ab1f-b25208c62d0f
  
[0m19:06:44.565731 [error] [Thread-2 (]: 2 of 4 ERROR not_null_my_second_dbt_model_id ................................... [[31mERROR[0m in 0.93s]
[0m19:06:44.567012 [debug] [Thread-2 (]: Finished running node test.bc_sales.not_null_my_second_dbt_model_id.151b76d778
[0m19:06:44.654509 [debug] [Thread-4 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "test.bc_sales.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `datatalksclub-375802`.`bandcamp_sales_tbl`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:06:44.654775 [debug] [Thread-4 (]: BigQuery adapter: 404 Not found: Dataset datatalksclub-375802:bandcamp_sales_tbl was not found in location US

Location: US
Job ID: d5e300d5-aeaa-48e0-87bf-da2fc8932278

[0m19:06:44.654981 [debug] [Thread-4 (]: Timing info for test.bc_sales.unique_my_second_dbt_model_id.57a0f8c493 (execute): 2023-04-17 19:06:43.657646 => 2023-04-17 19:06:44.654935
[0m19:06:44.655652 [debug] [Thread-4 (]: Runtime Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  404 Not found: Dataset datatalksclub-375802:bandcamp_sales_tbl was not found in location US
  
  Location: US
  Job ID: d5e300d5-aeaa-48e0-87bf-da2fc8932278
  
[0m19:06:44.655873 [error] [Thread-4 (]: 4 of 4 ERROR unique_my_second_dbt_model_id ..................................... [[31mERROR[0m in 1.02s]
[0m19:06:44.656139 [debug] [Thread-4 (]: Finished running node test.bc_sales.unique_my_second_dbt_model_id.57a0f8c493
[0m19:06:44.781662 [debug] [Thread-3 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "test.bc_sales.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `datatalksclub-375802`.`bandcamp_sales_tbl`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:06:44.781864 [debug] [Thread-3 (]: BigQuery adapter: 404 Not found: Dataset datatalksclub-375802:bandcamp_sales_tbl was not found in location US

Location: US
Job ID: fce550da-dab6-4fd2-88c7-5c6604e36949

[0m19:06:44.782061 [debug] [Thread-3 (]: Timing info for test.bc_sales.unique_my_first_dbt_model_id.16e066b321 (execute): 2023-04-17 19:06:43.672894 => 2023-04-17 19:06:44.782019
[0m19:06:44.783159 [debug] [Thread-3 (]: Runtime Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  404 Not found: Dataset datatalksclub-375802:bandcamp_sales_tbl was not found in location US
  
  Location: US
  Job ID: fce550da-dab6-4fd2-88c7-5c6604e36949
  
[0m19:06:44.783447 [error] [Thread-3 (]: 3 of 4 ERROR unique_my_first_dbt_model_id ...................................... [[31mERROR[0m in 1.15s]
[0m19:06:44.783765 [debug] [Thread-3 (]: Finished running node test.bc_sales.unique_my_first_dbt_model_id.16e066b321
[0m19:06:44.784124 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "test.bc_sales.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `datatalksclub-375802`.`bandcamp_sales_tbl`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m19:06:44.784507 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset datatalksclub-375802:bandcamp_sales_tbl was not found in location US

Location: US
Job ID: c90abcf7-656e-489e-9f87-24ce558cc045

[0m19:06:44.784753 [debug] [Thread-1 (]: Timing info for test.bc_sales.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 2023-04-17 19:06:43.678642 => 2023-04-17 19:06:44.784710
[0m19:06:44.785368 [debug] [Thread-1 (]: Runtime Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  404 Not found: Dataset datatalksclub-375802:bandcamp_sales_tbl was not found in location US
  
  Location: US
  Job ID: c90abcf7-656e-489e-9f87-24ce558cc045
  
[0m19:06:44.785591 [error] [Thread-1 (]: 1 of 4 ERROR not_null_my_first_dbt_model_id .................................... [[31mERROR[0m in 1.15s]
[0m19:06:44.785844 [debug] [Thread-1 (]: Finished running node test.bc_sales.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:06:44.786916 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:06:44.787321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:06:44.787446 [debug] [MainThread]: Connection 'test.bc_sales.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m19:06:44.787541 [debug] [MainThread]: Connection 'test.bc_sales.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m19:06:44.787642 [debug] [MainThread]: Connection 'test.bc_sales.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m19:06:44.787728 [debug] [MainThread]: Connection 'test.bc_sales.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m19:06:44.787855 [info ] [MainThread]: 
[0m19:06:44.788031 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 1.48 seconds (1.48s).
[0m19:06:44.788354 [debug] [MainThread]: Command end result
[0m19:06:44.793325 [info ] [MainThread]: 
[0m19:06:44.793596 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m19:06:44.793795 [info ] [MainThread]: 
[0m19:06:44.794005 [error] [MainThread]: [33mRuntime Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)[0m
[0m19:06:44.794183 [error] [MainThread]:   404 Not found: Dataset datatalksclub-375802:bandcamp_sales_tbl was not found in location US
[0m19:06:44.794367 [error] [MainThread]:   
[0m19:06:44.794537 [error] [MainThread]:   Location: US
[0m19:06:44.794722 [error] [MainThread]:   Job ID: 3a05ee57-357c-47ee-ab1f-b25208c62d0f
[0m19:06:44.794891 [error] [MainThread]:   
[0m19:06:44.795058 [info ] [MainThread]: 
[0m19:06:44.795213 [error] [MainThread]: [33mRuntime Error in test unique_my_second_dbt_model_id (models/example/schema.yml)[0m
[0m19:06:44.795379 [error] [MainThread]:   404 Not found: Dataset datatalksclub-375802:bandcamp_sales_tbl was not found in location US
[0m19:06:44.795529 [error] [MainThread]:   
[0m19:06:44.795691 [error] [MainThread]:   Location: US
[0m19:06:44.795851 [error] [MainThread]:   Job ID: d5e300d5-aeaa-48e0-87bf-da2fc8932278
[0m19:06:44.796011 [error] [MainThread]:   
[0m19:06:44.796172 [info ] [MainThread]: 
[0m19:06:44.796341 [error] [MainThread]: [33mRuntime Error in test unique_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m19:06:44.796492 [error] [MainThread]:   404 Not found: Dataset datatalksclub-375802:bandcamp_sales_tbl was not found in location US
[0m19:06:44.796649 [error] [MainThread]:   
[0m19:06:44.796812 [error] [MainThread]:   Location: US
[0m19:06:44.796965 [error] [MainThread]:   Job ID: fce550da-dab6-4fd2-88c7-5c6604e36949
[0m19:06:44.797119 [error] [MainThread]:   
[0m19:06:44.797527 [info ] [MainThread]: 
[0m19:06:44.797743 [error] [MainThread]: [33mRuntime Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m19:06:44.797909 [error] [MainThread]:   404 Not found: Dataset datatalksclub-375802:bandcamp_sales_tbl was not found in location US
[0m19:06:44.798063 [error] [MainThread]:   
[0m19:06:44.798228 [error] [MainThread]:   Location: US
[0m19:06:44.798384 [error] [MainThread]:   Job ID: c90abcf7-656e-489e-9f87-24ce558cc045
[0m19:06:44.798562 [error] [MainThread]:   
[0m19:06:44.798759 [info ] [MainThread]: 
[0m19:06:44.798936 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m19:06:44.799190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a51ef54b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4971c640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4971c460>]}
[0m19:06:44.799398 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 21:03:28.864624 | 71353b68-cce6-4169-a315-79ccb35e7808 ==============================
[0m21:03:28.864624 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:03:28.865972 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/j/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:03:28.866123 [debug] [MainThread]: Tracking: tracking
[0m21:03:28.867162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1761616620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175e7e0670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175e7e0fd0>]}
[0m21:03:28.874391 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m21:03:28.890276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m21:03:28.890612 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/staging/schema.yml
[0m21:03:28.890793 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/staging/stg_sales.sql
[0m21:03:28.900817 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales.sql
[0m21:03:28.959677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71353b68-cce6-4169-a315-79ccb35e7808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175d5f2740>]}
[0m21:03:28.964718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71353b68-cce6-4169-a315-79ccb35e7808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175e57be20>]}
[0m21:03:28.964980 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m21:03:28.965175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71353b68-cce6-4169-a315-79ccb35e7808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1761616620>]}
[0m21:03:28.966094 [info ] [MainThread]: 
[0m21:03:28.967386 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:03:28.968429 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m21:03:28.968763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:29.291762 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_datatalksclub-375802_bandcamp_sales_tbl'
[0m21:03:29.292208 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_datatalksclub-375802_bandcamp_sales_tbl'
[0m21:03:29.292403 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='datatalksclub-375802', schema='bandcamp_sales_tbl', identifier=None)"
[0m21:03:29.299782 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:29.300945 [debug] [ThreadPool]: On create_datatalksclub-375802_bandcamp_sales_tbl: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "connection_name": "create_datatalksclub-375802_bandcamp_sales_tbl"} */
create schema if not exists `datatalksclub-375802`.`bandcamp_sales_tbl`
  
[0m21:03:30.713728 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:US:00ffc64d-6fad-45ba-8d0d-601d1a53aceb&page=queryresults
[0m21:03:30.715543 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_tbl'
[0m21:03:30.715868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:31.019663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71353b68-cce6-4169-a315-79ccb35e7808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175e5b3730>]}
[0m21:03:31.020267 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:03:31.020488 [info ] [MainThread]: 
[0m21:03:31.024683 [debug] [Thread-1 (]: Began running node model.bc_sales.my_first_dbt_model
[0m21:03:31.024999 [debug] [Thread-2 (]: Began running node model.bc_sales.stg_sales
[0m21:03:31.025310 [info ] [Thread-1 (]: 1 of 3 START sql table model bandcamp_sales_tbl.my_first_dbt_model ............. [RUN]
[0m21:03:31.025708 [info ] [Thread-2 (]: 2 of 3 START sql table model bandcamp_sales_tbl.stg_sales ...................... [RUN]
[0m21:03:31.026214 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bc_sales.my_first_dbt_model'
[0m21:03:31.026708 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales'
[0m21:03:31.026916 [debug] [Thread-1 (]: Began compiling node model.bc_sales.my_first_dbt_model
[0m21:03:31.027111 [debug] [Thread-2 (]: Began compiling node model.bc_sales.stg_sales
[0m21:03:31.029274 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.my_first_dbt_model"
[0m21:03:31.031394 [debug] [Thread-2 (]: Writing injected SQL for node "model.bc_sales.stg_sales"
[0m21:03:31.031821 [debug] [Thread-1 (]: Timing info for model.bc_sales.my_first_dbt_model (compile): 2023-04-17 21:03:31.027244 => 2023-04-17 21:03:31.031759
[0m21:03:31.032025 [debug] [Thread-1 (]: Began executing node model.bc_sales.my_first_dbt_model
[0m21:03:31.056779 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.my_first_dbt_model"
[0m21:03:31.056988 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_sales (compile): 2023-04-17 21:03:31.029504 => 2023-04-17 21:03:31.056925
[0m21:03:31.057310 [debug] [Thread-2 (]: Began executing node model.bc_sales.stg_sales
[0m21:03:31.059303 [debug] [Thread-2 (]: Writing runtime sql for node "model.bc_sales.stg_sales"
[0m21:03:31.059657 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:03:31.059877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:31.061028 [debug] [Thread-2 (]: On model.bc_sales.stg_sales: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_tbl`.`stg_sales`
    
    
    OPTIONS()
    as (
      

select * from
    );
  
[0m21:03:31.061949 [debug] [Thread-1 (]: On model.bc_sales.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.my_first_dbt_model"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_tbl`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m21:03:31.571628 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [14:5]')
[0m21:03:32.599192 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:US:df7e75c9-75ab-4607-b77e-36f291c017c6&page=queryresults
[0m21:03:32.599778 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_sales (execute): 2023-04-17 21:03:31.057420 => 2023-04-17 21:03:32.599693
[0m21:03:32.601806 [debug] [Thread-2 (]: Database Error in model stg_sales (models/staging/stg_sales.sql)
  Syntax error: Unexpected ")" at [14:5]
  compiled Code at target/run/bc_sales/models/staging/stg_sales.sql
[0m21:03:32.602121 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71353b68-cce6-4169-a315-79ccb35e7808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175d5f23b0>]}
[0m21:03:32.602467 [error] [Thread-2 (]: 2 of 3 ERROR creating sql table model bandcamp_sales_tbl.stg_sales ............. [[31mERROR[0m in 1.58s]
[0m21:03:32.603755 [debug] [Thread-2 (]: Finished running node model.bc_sales.stg_sales
[0m21:03:33.830615 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:US:d9ba5d04-590c-4178-9900-fab07e32610e&page=queryresults
[0m21:03:33.842751 [debug] [Thread-1 (]: Timing info for model.bc_sales.my_first_dbt_model (execute): 2023-04-17 21:03:31.032135 => 2023-04-17 21:03:33.842695
[0m21:03:33.843277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71353b68-cce6-4169-a315-79ccb35e7808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175d5f3070>]}
[0m21:03:33.843600 [info ] [Thread-1 (]: 1 of 3 OK created sql table model bandcamp_sales_tbl.my_first_dbt_model ........ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.82s]
[0m21:03:33.843875 [debug] [Thread-1 (]: Finished running node model.bc_sales.my_first_dbt_model
[0m21:03:33.844791 [debug] [Thread-4 (]: Began running node model.bc_sales.my_second_dbt_model
[0m21:03:33.845099 [info ] [Thread-4 (]: 3 of 3 START sql view model bandcamp_sales_tbl.my_second_dbt_model ............. [RUN]
[0m21:03:33.845605 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bc_sales.my_second_dbt_model'
[0m21:03:33.845760 [debug] [Thread-4 (]: Began compiling node model.bc_sales.my_second_dbt_model
[0m21:03:33.849340 [debug] [Thread-4 (]: Writing injected SQL for node "model.bc_sales.my_second_dbt_model"
[0m21:03:33.849648 [debug] [Thread-4 (]: Timing info for model.bc_sales.my_second_dbt_model (compile): 2023-04-17 21:03:33.845854 => 2023-04-17 21:03:33.849601
[0m21:03:33.849810 [debug] [Thread-4 (]: Began executing node model.bc_sales.my_second_dbt_model
[0m21:03:33.865290 [debug] [Thread-4 (]: Writing runtime sql for node "model.bc_sales.my_second_dbt_model"
[0m21:03:33.865602 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:03:33.866621 [debug] [Thread-4 (]: On model.bc_sales.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.my_second_dbt_model"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_tbl`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `datatalksclub-375802`.`bandcamp_sales_tbl`.`my_first_dbt_model`
where id = 1;


[0m21:03:34.675544 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:US:5c2802d4-758b-4989-8c44-112847d8a0c3&page=queryresults
[0m21:03:34.676852 [debug] [Thread-4 (]: Timing info for model.bc_sales.my_second_dbt_model (execute): 2023-04-17 21:03:33.849913 => 2023-04-17 21:03:34.676800
[0m21:03:34.677380 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71353b68-cce6-4169-a315-79ccb35e7808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175c5cded0>]}
[0m21:03:34.677718 [info ] [Thread-4 (]: 3 of 3 OK created sql view model bandcamp_sales_tbl.my_second_dbt_model ........ [[32mCREATE VIEW (0 processed)[0m in 0.83s]
[0m21:03:34.677987 [debug] [Thread-4 (]: Finished running node model.bc_sales.my_second_dbt_model
[0m21:03:34.679187 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:03:34.679617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:34.679753 [debug] [MainThread]: Connection 'model.bc_sales.my_first_dbt_model' was properly closed.
[0m21:03:34.679850 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales' was properly closed.
[0m21:03:34.679937 [debug] [MainThread]: Connection 'model.bc_sales.my_second_dbt_model' was properly closed.
[0m21:03:34.680080 [info ] [MainThread]: 
[0m21:03:34.680280 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 5.71 seconds (5.71s).
[0m21:03:34.680569 [debug] [MainThread]: Command end result
[0m21:03:34.687203 [info ] [MainThread]: 
[0m21:03:34.687455 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:03:34.687615 [info ] [MainThread]: 
[0m21:03:34.687768 [error] [MainThread]: [33mDatabase Error in model stg_sales (models/staging/stg_sales.sql)[0m
[0m21:03:34.687933 [error] [MainThread]:   Syntax error: Unexpected ")" at [14:5]
[0m21:03:34.688074 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/staging/stg_sales.sql
[0m21:03:34.688220 [info ] [MainThread]: 
[0m21:03:34.688361 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:03:34.688566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175d6b1870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175e57af80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175e57b940>]}
[0m21:03:34.688741 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 21:04:24.837543 | d2b43ab8-ad6b-4871-939f-e8cac10ab598 ==============================
[0m21:04:24.837543 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:04:24.838758 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/j/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:04:24.838880 [debug] [MainThread]: Tracking: tracking
[0m21:04:24.839968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb4a85510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb4a84fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb4a84820>]}
[0m21:04:24.847295 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m21:04:24.863033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:04:24.863364 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/staging/stg_sales.sql
[0m21:04:24.873340 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales.sql
[0m21:04:24.890282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2b43ab8-ad6b-4871-939f-e8cac10ab598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb486a4a0>]}
[0m21:04:24.927280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2b43ab8-ad6b-4871-939f-e8cac10ab598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb49fe500>]}
[0m21:04:24.927558 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m21:04:24.927784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2b43ab8-ad6b-4871-939f-e8cac10ab598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb49bb220>]}
[0m21:04:24.928790 [info ] [MainThread]: 
[0m21:04:24.930175 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:04:24.931194 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m21:04:24.931516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:25.212210 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_tbl'
[0m21:04:25.212494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:04:25.479133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2b43ab8-ad6b-4871-939f-e8cac10ab598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb6a502e0>]}
[0m21:04:25.479711 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:04:25.479958 [info ] [MainThread]: 
[0m21:04:25.482576 [debug] [Thread-1 (]: Began running node model.bc_sales.my_first_dbt_model
[0m21:04:25.482886 [debug] [Thread-2 (]: Began running node model.bc_sales.stg_sales
[0m21:04:25.483216 [info ] [Thread-1 (]: 1 of 3 START sql table model bandcamp_sales_tbl.my_first_dbt_model ............. [RUN]
[0m21:04:25.483611 [info ] [Thread-2 (]: 2 of 3 START sql view model bandcamp_sales_tbl.stg_sales ....................... [RUN]
[0m21:04:25.484124 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bc_sales.my_first_dbt_model'
[0m21:04:25.484594 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales'
[0m21:04:25.484806 [debug] [Thread-1 (]: Began compiling node model.bc_sales.my_first_dbt_model
[0m21:04:25.484996 [debug] [Thread-2 (]: Began compiling node model.bc_sales.stg_sales
[0m21:04:25.487274 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.my_first_dbt_model"
[0m21:04:25.489458 [debug] [Thread-2 (]: Writing injected SQL for node "model.bc_sales.stg_sales"
[0m21:04:25.489914 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_sales (compile): 2023-04-17 21:04:25.487457 => 2023-04-17 21:04:25.489858
[0m21:04:25.490098 [debug] [Thread-2 (]: Began executing node model.bc_sales.stg_sales
[0m21:04:25.495355 [debug] [Thread-1 (]: Timing info for model.bc_sales.my_first_dbt_model (compile): 2023-04-17 21:04:25.485133 => 2023-04-17 21:04:25.495287
[0m21:04:25.500689 [debug] [Thread-1 (]: Began executing node model.bc_sales.my_first_dbt_model
[0m21:04:25.515971 [debug] [Thread-2 (]: Writing runtime sql for node "model.bc_sales.stg_sales"
[0m21:04:25.522686 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:04:25.527446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:04:25.528751 [debug] [Thread-2 (]: On model.bc_sales.stg_sales: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_tbl`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandamp_sales_tbl`.`bc_sales`;


[0m21:04:26.072295 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.my_first_dbt_model"
[0m21:04:26.072720 [debug] [Thread-1 (]: On model.bc_sales.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.my_first_dbt_model"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_tbl`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m21:04:26.153833 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_tbl`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandamp_sales_tbl`.`bc_sales`;


[0m21:04:26.154382 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset datatalksclub-375802:bandamp_sales_tbl was not found in location US

Location: US
Job ID: 1fcc6854-bafc-4ef4-98c6-64ec1b322cdc

[0m21:04:26.154666 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_sales (execute): 2023-04-17 21:04:25.490204 => 2023-04-17 21:04:26.154596
[0m21:04:26.156492 [debug] [Thread-2 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  404 Not found: Dataset datatalksclub-375802:bandamp_sales_tbl was not found in location US
  
  Location: US
  Job ID: 1fcc6854-bafc-4ef4-98c6-64ec1b322cdc
  
[0m21:04:26.156789 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b43ab8-ad6b-4871-939f-e8cac10ab598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb4136b60>]}
[0m21:04:26.157118 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model bandcamp_sales_tbl.stg_sales .............. [[31mERROR[0m in 0.67s]
[0m21:04:26.158391 [debug] [Thread-2 (]: Finished running node model.bc_sales.stg_sales
[0m21:04:28.292564 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:US:ba2f6fdf-29fb-4b6c-bc74-5b3059894d35&page=queryresults
[0m21:04:28.311482 [debug] [Thread-1 (]: Timing info for model.bc_sales.my_first_dbt_model (execute): 2023-04-17 21:04:25.505931 => 2023-04-17 21:04:28.311404
[0m21:04:28.312317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b43ab8-ad6b-4871-939f-e8cac10ab598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb4a87c10>]}
[0m21:04:28.312842 [info ] [Thread-1 (]: 1 of 3 OK created sql table model bandcamp_sales_tbl.my_first_dbt_model ........ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.83s]
[0m21:04:28.313311 [debug] [Thread-1 (]: Finished running node model.bc_sales.my_first_dbt_model
[0m21:04:28.314169 [debug] [Thread-4 (]: Began running node model.bc_sales.my_second_dbt_model
[0m21:04:28.314474 [info ] [Thread-4 (]: 3 of 3 START sql view model bandcamp_sales_tbl.my_second_dbt_model ............. [RUN]
[0m21:04:28.314989 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bc_sales.my_second_dbt_model'
[0m21:04:28.315143 [debug] [Thread-4 (]: Began compiling node model.bc_sales.my_second_dbt_model
[0m21:04:28.317177 [debug] [Thread-4 (]: Writing injected SQL for node "model.bc_sales.my_second_dbt_model"
[0m21:04:28.317503 [debug] [Thread-4 (]: Timing info for model.bc_sales.my_second_dbt_model (compile): 2023-04-17 21:04:28.315237 => 2023-04-17 21:04:28.317458
[0m21:04:28.317676 [debug] [Thread-4 (]: Began executing node model.bc_sales.my_second_dbt_model
[0m21:04:28.319909 [debug] [Thread-4 (]: Writing runtime sql for node "model.bc_sales.my_second_dbt_model"
[0m21:04:28.320202 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:04:28.321208 [debug] [Thread-4 (]: On model.bc_sales.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.my_second_dbt_model"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_tbl`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `datatalksclub-375802`.`bandcamp_sales_tbl`.`my_first_dbt_model`
where id = 1;


[0m21:04:29.258908 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:US:db0f0339-3834-4e1f-bf75-7d61784d82d2&page=queryresults
[0m21:04:29.260458 [debug] [Thread-4 (]: Timing info for model.bc_sales.my_second_dbt_model (execute): 2023-04-17 21:04:28.317775 => 2023-04-17 21:04:29.260406
[0m21:04:29.261012 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b43ab8-ad6b-4871-939f-e8cac10ab598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb4a87a60>]}
[0m21:04:29.261339 [info ] [Thread-4 (]: 3 of 3 OK created sql view model bandcamp_sales_tbl.my_second_dbt_model ........ [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m21:04:29.261665 [debug] [Thread-4 (]: Finished running node model.bc_sales.my_second_dbt_model
[0m21:04:29.263098 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:04:29.263735 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:04:29.263955 [debug] [MainThread]: Connection 'model.bc_sales.my_first_dbt_model' was properly closed.
[0m21:04:29.264137 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales' was properly closed.
[0m21:04:29.264296 [debug] [MainThread]: Connection 'model.bc_sales.my_second_dbt_model' was properly closed.
[0m21:04:29.264531 [info ] [MainThread]: 
[0m21:04:29.264767 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 4.34 seconds (4.34s).
[0m21:04:29.265078 [debug] [MainThread]: Command end result
[0m21:04:29.271899 [info ] [MainThread]: 
[0m21:04:29.272171 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:04:29.272351 [info ] [MainThread]: 
[0m21:04:29.272518 [error] [MainThread]: [33mRuntime Error in model stg_sales (models/staging/stg_sales.sql)[0m
[0m21:04:29.272682 [error] [MainThread]:   404 Not found: Dataset datatalksclub-375802:bandamp_sales_tbl was not found in location US
[0m21:04:29.272831 [error] [MainThread]:   
[0m21:04:29.272969 [error] [MainThread]:   Location: US
[0m21:04:29.273116 [error] [MainThread]:   Job ID: 1fcc6854-bafc-4ef4-98c6-64ec1b322cdc
[0m21:04:29.273249 [error] [MainThread]:   
[0m21:04:29.273391 [info ] [MainThread]: 
[0m21:04:29.273533 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:04:29.273740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb4e1ba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb4a984c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb49bb220>]}
[0m21:04:29.273914 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 21:09:32.008149 | 743ed02c-6294-4253-b43a-aa923cf3c609 ==============================
[0m21:09:32.008149 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:09:32.009385 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/j/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:09:32.009507 [debug] [MainThread]: Tracking: tracking
[0m21:09:32.010569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49fee4b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49fee4820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49fee54e0>]}
[0m21:09:32.017673 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m21:09:32.033278 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m21:09:32.033561 [debug] [MainThread]: Partial parsing: deleted file: bc_sales://models/example/my_first_dbt_model.sql
[0m21:09:32.033685 [debug] [MainThread]: Partial parsing: deleted file: bc_sales://models/example/my_second_dbt_model.sql
[0m21:09:32.037299 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m21:09:32.041571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '743ed02c-6294-4253-b43a-aa923cf3c609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49fcce0b0>]}
[0m21:09:32.046097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '743ed02c-6294-4253-b43a-aa923cf3c609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49fc6a3e0>]}
[0m21:09:32.046353 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m21:09:32.046576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '743ed02c-6294-4253-b43a-aa923cf3c609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49fc6a4a0>]}
[0m21:09:32.047396 [info ] [MainThread]: 
[0m21:09:32.048689 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:09:32.049500 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m21:09:32.049827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:09:32.355984 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_tbl'
[0m21:09:32.356282 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:09:32.602726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '743ed02c-6294-4253-b43a-aa923cf3c609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49fbf0d90>]}
[0m21:09:32.603249 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:09:32.603459 [info ] [MainThread]: 
[0m21:09:32.607102 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_sales
[0m21:09:32.607671 [info ] [Thread-1 (]: 1 of 1 START sql view model bandcamp_sales_tbl.stg_sales ....................... [RUN]
[0m21:09:32.608125 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales'
[0m21:09:32.608276 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_sales
[0m21:09:32.646966 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_sales"
[0m21:09:32.647332 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (compile): 2023-04-17 21:09:32.608370 => 2023-04-17 21:09:32.647281
[0m21:09:32.647502 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_sales
[0m21:09:32.672190 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_sales"
[0m21:09:32.672528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:09:32.673684 [debug] [Thread-1 (]: On model.bc_sales.stg_sales: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_tbl`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandamp_sales_tbl`.`bc_sales`;


[0m21:09:33.093002 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_tbl`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandamp_sales_tbl`.`bc_sales`;


[0m21:09:33.093510 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset datatalksclub-375802:bandamp_sales_tbl was not found in location US

Location: US
Job ID: fcdd4bde-0042-47dd-81ac-f303758dd008

[0m21:09:33.093749 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (execute): 2023-04-17 21:09:32.647594 => 2023-04-17 21:09:33.093698
[0m21:09:33.095536 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  404 Not found: Dataset datatalksclub-375802:bandamp_sales_tbl was not found in location US
  
  Location: US
  Job ID: fcdd4bde-0042-47dd-81ac-f303758dd008
  
[0m21:09:33.095827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '743ed02c-6294-4253-b43a-aa923cf3c609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a2d0ac80>]}
[0m21:09:33.096145 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model bandcamp_sales_tbl.stg_sales .............. [[31mERROR[0m in 0.49s]
[0m21:09:33.097329 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_sales
[0m21:09:33.098589 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:09:33.099011 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:09:33.099145 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales' was properly closed.
[0m21:09:33.099277 [info ] [MainThread]: 
[0m21:09:33.099454 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m21:09:33.099671 [debug] [MainThread]: Command end result
[0m21:09:33.104156 [info ] [MainThread]: 
[0m21:09:33.104408 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:09:33.104572 [info ] [MainThread]: 
[0m21:09:33.104739 [error] [MainThread]: [33mRuntime Error in model stg_sales (models/staging/stg_sales.sql)[0m
[0m21:09:33.104895 [error] [MainThread]:   404 Not found: Dataset datatalksclub-375802:bandamp_sales_tbl was not found in location US
[0m21:09:33.105042 [error] [MainThread]:   
[0m21:09:33.105175 [error] [MainThread]:   Location: US
[0m21:09:33.105302 [error] [MainThread]:   Job ID: fcdd4bde-0042-47dd-81ac-f303758dd008
[0m21:09:33.105430 [error] [MainThread]:   
[0m21:09:33.105574 [info ] [MainThread]: 
[0m21:09:33.105718 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:09:33.105926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49fee5540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a1bc8250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49fcf6020>]}
[0m21:09:33.106120 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 21:20:14.976571 | e6a28250-1cb6-470a-91a9-224cc61979c5 ==============================
[0m21:20:14.976571 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:20:14.977757 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/j/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:20:14.977874 [debug] [MainThread]: Tracking: tracking
[0m21:20:14.978902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63ea9f79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63ea9f5240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63ea9f5660>]}
[0m21:20:14.985974 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m21:20:15.001125 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:20:15.001429 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/staging/schema.yml
[0m21:20:15.007615 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m21:20:15.011749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6a28250-1cb6-470a-91a9-224cc61979c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63ea7f6860>]}
[0m21:20:15.016117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6a28250-1cb6-470a-91a9-224cc61979c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63ea8f9450>]}
[0m21:20:15.016395 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m21:20:15.016622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6a28250-1cb6-470a-91a9-224cc61979c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63eda18ca0>]}
[0m21:20:15.017420 [info ] [MainThread]: 
[0m21:20:15.018741 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:20:15.019555 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m21:20:15.019788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:15.322244 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_tbl'
[0m21:20:15.322527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:20:15.621043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6a28250-1cb6-470a-91a9-224cc61979c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63eab6e3e0>]}
[0m21:20:15.621576 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:20:15.621781 [info ] [MainThread]: 
[0m21:20:15.625042 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_sales
[0m21:20:15.625320 [info ] [Thread-1 (]: 1 of 1 START sql view model bandcamp_sales_tbl.stg_sales ....................... [RUN]
[0m21:20:15.625760 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales'
[0m21:20:15.625913 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_sales
[0m21:20:15.628109 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_sales"
[0m21:20:15.628427 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (compile): 2023-04-17 21:20:15.626005 => 2023-04-17 21:20:15.628379
[0m21:20:15.628595 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_sales
[0m21:20:15.652484 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_sales"
[0m21:20:15.652826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:15.653962 [debug] [Thread-1 (]: On model.bc_sales.stg_sales: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_tbl`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandamp_sales_tbl`.`bc_sales`;


[0m21:20:16.015017 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_tbl`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandamp_sales_tbl`.`bc_sales`;


[0m21:20:16.015550 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset datatalksclub-375802:bandamp_sales_tbl was not found in location US

Location: US
Job ID: bc7a0be6-6009-48a7-854b-ea42e1bd9c8f

[0m21:20:16.015778 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (execute): 2023-04-17 21:20:15.628687 => 2023-04-17 21:20:16.015729
[0m21:20:16.017576 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  404 Not found: Dataset datatalksclub-375802:bandamp_sales_tbl was not found in location US
  
  Location: US
  Job ID: bc7a0be6-6009-48a7-854b-ea42e1bd9c8f
  
[0m21:20:16.017856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6a28250-1cb6-470a-91a9-224cc61979c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63ea9f6cb0>]}
[0m21:20:16.018152 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model bandcamp_sales_tbl.stg_sales .............. [[31mERROR[0m in 0.39s]
[0m21:20:16.019373 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_sales
[0m21:20:16.020552 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:20:16.020946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:20:16.021078 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales' was properly closed.
[0m21:20:16.021209 [info ] [MainThread]: 
[0m21:20:16.021386 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m21:20:16.021600 [debug] [MainThread]: Command end result
[0m21:20:16.025989 [info ] [MainThread]: 
[0m21:20:16.026249 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:20:16.026412 [info ] [MainThread]: 
[0m21:20:16.026597 [error] [MainThread]: [33mRuntime Error in model stg_sales (models/staging/stg_sales.sql)[0m
[0m21:20:16.026753 [error] [MainThread]:   404 Not found: Dataset datatalksclub-375802:bandamp_sales_tbl was not found in location US
[0m21:20:16.026890 [error] [MainThread]:   
[0m21:20:16.027018 [error] [MainThread]:   Location: US
[0m21:20:16.027153 [error] [MainThread]:   Job ID: bc7a0be6-6009-48a7-854b-ea42e1bd9c8f
[0m21:20:16.027283 [error] [MainThread]:   
[0m21:20:16.027415 [info ] [MainThread]: 
[0m21:20:16.027564 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:20:16.027768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63eaccf2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63ea9addb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63ecb602e0>]}
[0m21:20:16.027951 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 21:25:02.645357 | e3906c5a-8c95-4590-a5d7-ae000501de5e ==============================
[0m21:25:02.645357 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:25:02.646549 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/j/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:25:02.646688 [debug] [MainThread]: Tracking: tracking
[0m21:25:02.647751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4887e17e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4887e0ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4887e3970>]}
[0m21:25:02.654811 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m21:25:02.669919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:25:02.670239 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/staging/stg_sales.sql
[0m21:25:02.680354 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales.sql
[0m21:25:02.692870 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m21:25:02.696729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3906c5a-8c95-4590-a5d7-ae000501de5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4833069b0>]}
[0m21:25:02.733521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3906c5a-8c95-4590-a5d7-ae000501de5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48875af50>]}
[0m21:25:02.733801 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m21:25:02.734029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3906c5a-8c95-4590-a5d7-ae000501de5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48871f3a0>]}
[0m21:25:02.734889 [info ] [MainThread]: 
[0m21:25:02.736276 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:25:02.737153 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m21:25:02.737589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:25:03.046709 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_tbl'
[0m21:25:03.047034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:25:03.296824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3906c5a-8c95-4590-a5d7-ae000501de5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48871f3a0>]}
[0m21:25:03.297383 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:25:03.297635 [info ] [MainThread]: 
[0m21:25:03.300268 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_sales
[0m21:25:03.300674 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_tbl.stg_sales ...................... [RUN]
[0m21:25:03.301135 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales'
[0m21:25:03.301287 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_sales
[0m21:25:03.303664 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_sales"
[0m21:25:03.304000 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (compile): 2023-04-17 21:25:03.301381 => 2023-04-17 21:25:03.303943
[0m21:25:03.304169 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_sales
[0m21:25:03.332645 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_sales"
[0m21:25:03.332978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:03.334134 [debug] [Thread-1 (]: On model.bc_sales.stg_sales: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_tbl`.`stg_sales`
    
    
    OPTIONS()
    as (
      

select * from `datatalksclub-375802`.`bandamp_sales_tbl`.`bc_sales`
    );
  
[0m21:25:03.774141 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_tbl`.`stg_sales`
    
    
    OPTIONS()
    as (
      

select * from `datatalksclub-375802`.`bandamp_sales_tbl`.`bc_sales`
    );
  
[0m21:25:03.774712 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset datatalksclub-375802:bandamp_sales_tbl was not found in location US

Location: US
Job ID: e00f70d7-7bba-4863-a0e4-e31d29dd32e4

[0m21:25:03.774947 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (execute): 2023-04-17 21:25:03.304266 => 2023-04-17 21:25:03.774897
[0m21:25:03.776793 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  404 Not found: Dataset datatalksclub-375802:bandamp_sales_tbl was not found in location US
  
  Location: US
  Job ID: e00f70d7-7bba-4863-a0e4-e31d29dd32e4
  
[0m21:25:03.777071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3906c5a-8c95-4590-a5d7-ae000501de5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff488598730>]}
[0m21:25:03.777381 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bandcamp_sales_tbl.stg_sales ............. [[31mERROR[0m in 0.48s]
[0m21:25:03.778637 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_sales
[0m21:25:03.779855 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:25:03.780262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:25:03.780391 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales' was properly closed.
[0m21:25:03.780525 [info ] [MainThread]: 
[0m21:25:03.780713 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m21:25:03.780936 [debug] [MainThread]: Command end result
[0m21:25:03.792742 [info ] [MainThread]: 
[0m21:25:03.793002 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:25:03.793165 [info ] [MainThread]: 
[0m21:25:03.793330 [error] [MainThread]: [33mRuntime Error in model stg_sales (models/staging/stg_sales.sql)[0m
[0m21:25:03.793497 [error] [MainThread]:   404 Not found: Dataset datatalksclub-375802:bandamp_sales_tbl was not found in location US
[0m21:25:03.793652 [error] [MainThread]:   
[0m21:25:03.793785 [error] [MainThread]:   Location: US
[0m21:25:03.793912 [error] [MainThread]:   Job ID: e00f70d7-7bba-4863-a0e4-e31d29dd32e4
[0m21:25:03.794038 [error] [MainThread]:   
[0m21:25:03.794173 [info ] [MainThread]: 
[0m21:25:03.794314 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:25:03.794541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48a1ef550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4888b74f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4886ca560>]}
[0m21:25:03.794737 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 21:49:05.670268 | de7853b8-2e96-4941-bc4e-85ad743f91c5 ==============================
[0m21:49:05.670268 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:49:05.671521 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/j/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:49:05.671651 [debug] [MainThread]: Tracking: tracking
[0m21:49:05.672710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d6df71f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d6df5690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d6df4b20>]}
[0m21:49:05.679876 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m21:49:05.685172 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:49:05.685433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'de7853b8-2e96-4941-bc4e-85ad743f91c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d6df4970>]}
[0m21:49:06.183655 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales.sql
[0m21:49:06.224034 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m21:49:06.227871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de7853b8-2e96-4941-bc4e-85ad743f91c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d6d6d360>]}
[0m21:49:06.232309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de7853b8-2e96-4941-bc4e-85ad743f91c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d6d7cb80>]}
[0m21:49:06.232555 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m21:49:06.232785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de7853b8-2e96-4941-bc4e-85ad743f91c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d6e0b760>]}
[0m21:49:06.233601 [info ] [MainThread]: 
[0m21:49:06.234986 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:49:06.235835 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m21:49:06.236180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:06.534339 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m21:49:06.534679 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:49:06.765704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de7853b8-2e96-4941-bc4e-85ad743f91c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d6d6d330>]}
[0m21:49:06.766273 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:49:06.766522 [info ] [MainThread]: 
[0m21:49:06.769085 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_sales
[0m21:49:06.769392 [info ] [Thread-1 (]: 1 of 1 START sql view model bandcamp_sales_schema.stg_sales .................... [RUN]
[0m21:49:06.769831 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales'
[0m21:49:06.769985 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_sales
[0m21:49:06.774484 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_sales"
[0m21:49:06.774858 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (compile): 2023-04-17 21:49:06.770085 => 2023-04-17 21:49:06.774800
[0m21:49:06.775031 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_sales
[0m21:49:06.799918 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_sales"
[0m21:49:06.800247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:06.801428 [debug] [Thread-1 (]: On model.bc_sales.stg_sales: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandamp_sales_schema`.`bc_sales`
limit 100;


[0m21:49:07.144436 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandamp_sales_schema`.`bc_sales`
limit 100;


[0m21:49:07.144965 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset datatalksclub-375802:bandcamp_sales_schema was not found in location US

Location: US
Job ID: bd0a0451-034f-40ae-bf6c-f66a3d4deec9

[0m21:49:07.145197 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (execute): 2023-04-17 21:49:06.775125 => 2023-04-17 21:49:07.145148
[0m21:49:07.146998 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  404 Not found: Dataset datatalksclub-375802:bandcamp_sales_schema was not found in location US
  
  Location: US
  Job ID: bd0a0451-034f-40ae-bf6c-f66a3d4deec9
  
[0m21:49:07.147290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de7853b8-2e96-4941-bc4e-85ad743f91c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d6da9360>]}
[0m21:49:07.147608 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model bandcamp_sales_schema.stg_sales ........... [[31mERROR[0m in 0.38s]
[0m21:49:07.148813 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_sales
[0m21:49:07.149990 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:49:07.150397 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:49:07.150517 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales' was properly closed.
[0m21:49:07.150691 [info ] [MainThread]: 
[0m21:49:07.150894 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m21:49:07.151144 [debug] [MainThread]: Command end result
[0m21:49:07.155595 [info ] [MainThread]: 
[0m21:49:07.155880 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:49:07.156078 [info ] [MainThread]: 
[0m21:49:07.156290 [error] [MainThread]: [33mRuntime Error in model stg_sales (models/staging/stg_sales.sql)[0m
[0m21:49:07.156481 [error] [MainThread]:   404 Not found: Dataset datatalksclub-375802:bandcamp_sales_schema was not found in location US
[0m21:49:07.156666 [error] [MainThread]:   
[0m21:49:07.156830 [error] [MainThread]:   Location: US
[0m21:49:07.157024 [error] [MainThread]:   Job ID: bd0a0451-034f-40ae-bf6c-f66a3d4deec9
[0m21:49:07.157190 [error] [MainThread]:   
[0m21:49:07.157362 [info ] [MainThread]: 
[0m21:49:07.157543 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:49:07.157799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d6f2ece0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d6e02fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d6d5b0d0>]}
[0m21:49:07.157975 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 21:53:32.235939 | 64e59848-d45a-4200-83f0-282acc47c2ee ==============================
[0m21:53:32.235939 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:53:32.237146 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/j/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:53:32.237267 [debug] [MainThread]: Tracking: tracking
[0m21:53:32.238294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fde899b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fde899180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fde899690>]}
[0m21:53:32.245547 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m21:53:32.260598 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:53:32.260770 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:53:32.261128 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m21:53:32.265420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64e59848-d45a-4200-83f0-282acc47c2ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fde65d000>]}
[0m21:53:32.270079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64e59848-d45a-4200-83f0-282acc47c2ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fde625480>]}
[0m21:53:32.270330 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m21:53:32.270519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64e59848-d45a-4200-83f0-282acc47c2ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fe1927ac0>]}
[0m21:53:32.271371 [info ] [MainThread]: 
[0m21:53:32.272676 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:53:32.273524 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m21:53:32.273853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:53:32.560705 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m21:53:32.561028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:53:32.791884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64e59848-d45a-4200-83f0-282acc47c2ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fde89e770>]}
[0m21:53:32.792420 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:53:32.792645 [info ] [MainThread]: 
[0m21:53:32.795130 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_sales
[0m21:53:32.795445 [info ] [Thread-1 (]: 1 of 1 START sql view model bandcamp_sales_schema.stg_sales .................... [RUN]
[0m21:53:32.795901 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales'
[0m21:53:32.796048 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_sales
[0m21:53:32.798295 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_sales"
[0m21:53:32.798639 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (compile): 2023-04-17 21:53:32.796142 => 2023-04-17 21:53:32.798578
[0m21:53:32.798808 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_sales
[0m21:53:32.862209 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_sales"
[0m21:53:32.862622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:32.863794 [debug] [Thread-1 (]: On model.bc_sales.stg_sales: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandamp_sales_schema`.`bc_sales`
limit 100;


[0m21:53:33.274976 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandamp_sales_schema`.`bc_sales`
limit 100;


[0m21:53:33.275507 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset datatalksclub-375802:bandcamp_sales_schema was not found in location US

Location: US
Job ID: 13459cff-f05a-42c0-88a7-39e19f3f971e

[0m21:53:33.275748 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (execute): 2023-04-17 21:53:32.798899 => 2023-04-17 21:53:33.275698
[0m21:53:33.277549 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  404 Not found: Dataset datatalksclub-375802:bandcamp_sales_schema was not found in location US
  
  Location: US
  Job ID: 13459cff-f05a-42c0-88a7-39e19f3f971e
  
[0m21:53:33.277849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64e59848-d45a-4200-83f0-282acc47c2ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fde89cc70>]}
[0m21:53:33.278175 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model bandcamp_sales_schema.stg_sales ........... [[31mERROR[0m in 0.48s]
[0m21:53:33.279634 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_sales
[0m21:53:33.280907 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:53:33.281330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:53:33.281455 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales' was properly closed.
[0m21:53:33.281583 [info ] [MainThread]: 
[0m21:53:33.281785 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m21:53:33.282051 [debug] [MainThread]: Command end result
[0m21:53:33.286191 [info ] [MainThread]: 
[0m21:53:33.286483 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:53:33.286736 [info ] [MainThread]: 
[0m21:53:33.286930 [error] [MainThread]: [33mRuntime Error in model stg_sales (models/staging/stg_sales.sql)[0m
[0m21:53:33.287122 [error] [MainThread]:   404 Not found: Dataset datatalksclub-375802:bandcamp_sales_schema was not found in location US
[0m21:53:33.287284 [error] [MainThread]:   
[0m21:53:33.287462 [error] [MainThread]:   Location: US
[0m21:53:33.287627 [error] [MainThread]:   Job ID: 13459cff-f05a-42c0-88a7-39e19f3f971e
[0m21:53:33.287798 [error] [MainThread]:   
[0m21:53:33.287976 [info ] [MainThread]: 
[0m21:53:33.288157 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:53:33.288393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fde4f34f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fde4f3460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fde898070>]}
[0m21:53:33.288578 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 21:55:34.011174 | 675d1910-87d8-4074-ba81-e5357a767066 ==============================
[0m21:55:34.011174 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:55:34.012398 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/j/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:55:34.012517 [debug] [MainThread]: Tracking: tracking
[0m21:55:34.013529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6fbe0820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6fbe0f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6fbe07c0>]}
[0m21:55:34.020668 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m21:55:34.035680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:55:34.036061 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/staging/schema.yml
[0m21:55:34.046151 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales.sql
[0m21:55:34.102867 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m21:55:34.106752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '675d1910-87d8-4074-ba81-e5357a767066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6f9e3a60>]}
[0m21:55:34.111324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '675d1910-87d8-4074-ba81-e5357a767066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6f967dc0>]}
[0m21:55:34.111581 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m21:55:34.111782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '675d1910-87d8-4074-ba81-e5357a767066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6f967f70>]}
[0m21:55:34.112560 [info ] [MainThread]: 
[0m21:55:34.113849 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:55:34.114735 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m21:55:34.115080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:34.424128 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m21:55:34.424429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:34.668681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '675d1910-87d8-4074-ba81-e5357a767066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6f9f2c80>]}
[0m21:55:34.669224 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:55:34.669441 [info ] [MainThread]: 
[0m21:55:34.671960 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_sales
[0m21:55:34.672290 [info ] [Thread-1 (]: 1 of 1 START sql view model bandcamp_sales_schema.stg_sales .................... [RUN]
[0m21:55:34.672763 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales'
[0m21:55:34.672930 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_sales
[0m21:55:34.677458 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_sales"
[0m21:55:34.677781 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (compile): 2023-04-17 21:55:34.673029 => 2023-04-17 21:55:34.677726
[0m21:55:34.677955 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_sales
[0m21:55:34.702913 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_sales"
[0m21:55:34.703248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:34.704405 [debug] [Thread-1 (]: On model.bc_sales.stg_sales: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`bc_sales`
limit 100;


[0m21:55:35.030576 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`bc_sales`
limit 100;


[0m21:55:35.031202 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset datatalksclub-375802:bandcamp_sales_schema was not found in location US

Location: US
Job ID: da8d9651-d8cd-4109-9d5d-6b09c8891790

[0m21:55:35.031425 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (execute): 2023-04-17 21:55:34.678054 => 2023-04-17 21:55:35.031377
[0m21:55:35.033180 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  404 Not found: Dataset datatalksclub-375802:bandcamp_sales_schema was not found in location US
  
  Location: US
  Job ID: da8d9651-d8cd-4109-9d5d-6b09c8891790
  
[0m21:55:35.033456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '675d1910-87d8-4074-ba81-e5357a767066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6f9c2dd0>]}
[0m21:55:35.033775 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model bandcamp_sales_schema.stg_sales ........... [[31mERROR[0m in 0.36s]
[0m21:55:35.035027 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_sales
[0m21:55:35.036285 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:55:35.036694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:55:35.036820 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales' was properly closed.
[0m21:55:35.036945 [info ] [MainThread]: 
[0m21:55:35.037129 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m21:55:35.037347 [debug] [MainThread]: Command end result
[0m21:55:35.041634 [info ] [MainThread]: 
[0m21:55:35.041884 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:55:35.042055 [info ] [MainThread]: 
[0m21:55:35.042222 [error] [MainThread]: [33mRuntime Error in model stg_sales (models/staging/stg_sales.sql)[0m
[0m21:55:35.042377 [error] [MainThread]:   404 Not found: Dataset datatalksclub-375802:bandcamp_sales_schema was not found in location US
[0m21:55:35.042529 [error] [MainThread]:   
[0m21:55:35.042705 [error] [MainThread]:   Location: US
[0m21:55:35.042840 [error] [MainThread]:   Job ID: da8d9651-d8cd-4109-9d5d-6b09c8891790
[0m21:55:35.042971 [error] [MainThread]:   
[0m21:55:35.043111 [info ] [MainThread]: 
[0m21:55:35.043253 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:55:35.043460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6f967b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd72c17ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6f9f2dd0>]}
[0m21:55:35.043643 [debug] [MainThread]: Flushing usage events


============================== 2023-04-18 23:15:37.982046 | 242e221e-f55c-4f10-b340-49f72310bd71 ==============================
[0m23:15:37.982046 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:15:37.983439 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/j/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:15:37.983568 [debug] [MainThread]: Tracking: tracking
[0m23:15:37.984688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba6bf1b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba6bf11e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba6bf16c0>]}
[0m23:15:37.992186 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:15:38.007902 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:15:38.008098 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:15:38.008483 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m23:15:38.012984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '242e221e-f55c-4f10-b340-49f72310bd71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba6bb9030>]}
[0m23:15:38.017721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '242e221e-f55c-4f10-b340-49f72310bd71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba6b814b0>]}
[0m23:15:38.017975 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:15:38.018166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '242e221e-f55c-4f10-b340-49f72310bd71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba9e1fac0>]}
[0m23:15:38.019096 [info ] [MainThread]: 
[0m23:15:38.020459 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:15:38.021369 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m23:15:38.021700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:15:38.353485 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m23:15:38.353857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:15:38.632926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '242e221e-f55c-4f10-b340-49f72310bd71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba6bfe770>]}
[0m23:15:38.633578 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:15:38.633802 [info ] [MainThread]: 
[0m23:15:38.636521 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_sales
[0m23:15:38.636855 [info ] [Thread-1 (]: 1 of 1 START sql view model bandcamp_sales_schema.stg_sales .................... [RUN]
[0m23:15:38.637310 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales'
[0m23:15:38.637465 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_sales
[0m23:15:38.639910 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_sales"
[0m23:15:38.640262 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (compile): 2023-04-18 23:15:38.637559 => 2023-04-18 23:15:38.640200
[0m23:15:38.640433 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_sales
[0m23:15:38.718000 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_sales"
[0m23:15:38.718542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:15:38.719893 [debug] [Thread-1 (]: On model.bc_sales.stg_sales: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`bc_sales`
limit 100;


[0m23:15:39.125893 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`bc_sales`
limit 100;


[0m23:15:39.126508 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset datatalksclub-375802:bandcamp_sales_schema was not found in location US

Location: US
Job ID: ed4b47b1-f890-4e55-8b76-bd9ca68a97c7

[0m23:15:39.126801 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (execute): 2023-04-18 23:15:38.640527 => 2023-04-18 23:15:39.126736
[0m23:15:39.128733 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  404 Not found: Dataset datatalksclub-375802:bandcamp_sales_schema was not found in location US
  
  Location: US
  Job ID: ed4b47b1-f890-4e55-8b76-bd9ca68a97c7
  
[0m23:15:39.129088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '242e221e-f55c-4f10-b340-49f72310bd71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba6daa3e0>]}
[0m23:15:39.129447 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model bandcamp_sales_schema.stg_sales ........... [[31mERROR[0m in 0.49s]
[0m23:15:39.130989 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_sales
[0m23:15:39.132318 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:15:39.132754 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:15:39.132895 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales' was properly closed.
[0m23:15:39.133032 [info ] [MainThread]: 
[0m23:15:39.133223 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m23:15:39.133518 [debug] [MainThread]: Command end result
[0m23:15:39.137864 [info ] [MainThread]: 
[0m23:15:39.138115 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:15:39.138313 [info ] [MainThread]: 
[0m23:15:39.138495 [error] [MainThread]: [33mRuntime Error in model stg_sales (models/staging/stg_sales.sql)[0m
[0m23:15:39.138686 [error] [MainThread]:   404 Not found: Dataset datatalksclub-375802:bandcamp_sales_schema was not found in location US
[0m23:15:39.138861 [error] [MainThread]:   
[0m23:15:39.139016 [error] [MainThread]:   Location: US
[0m23:15:39.139175 [error] [MainThread]:   Job ID: ed4b47b1-f890-4e55-8b76-bd9ca68a97c7
[0m23:15:39.139330 [error] [MainThread]:   
[0m23:15:39.139490 [info ] [MainThread]: 
[0m23:15:39.139652 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:15:39.139901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba7030250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba6daa860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba6daa0b0>]}
[0m23:15:39.140074 [debug] [MainThread]: Flushing usage events


============================== 2023-04-18 23:24:26.554379 | 081a119d-970b-4534-ac77-009a1d904d2d ==============================
[0m23:24:26.554379 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:24:26.556388 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/j/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:24:26.556588 [debug] [MainThread]: Tracking: tracking
[0m23:24:26.557731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e64a17970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e619e1150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e619e1240>]}
[0m23:24:26.569920 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:24:26.579040 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:24:26.579530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '081a119d-970b-4534-ac77-009a1d904d2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e617faad0>]}
[0m23:24:27.106851 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales.sql
[0m23:24:27.148065 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m23:24:27.151996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '081a119d-970b-4534-ac77-009a1d904d2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e61997eb0>]}
[0m23:24:27.156530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '081a119d-970b-4534-ac77-009a1d904d2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e61859f00>]}
[0m23:24:27.156802 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:24:27.157018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '081a119d-970b-4534-ac77-009a1d904d2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e6175b100>]}
[0m23:24:27.157941 [info ] [MainThread]: 
[0m23:24:27.159342 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:24:27.160217 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m23:24:27.160531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:24:27.471747 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m23:24:27.472130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:24:27.751518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '081a119d-970b-4534-ac77-009a1d904d2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e616edd80>]}
[0m23:24:27.752157 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:24:27.752395 [info ] [MainThread]: 
[0m23:24:27.755087 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_sales
[0m23:24:27.755399 [info ] [Thread-1 (]: 1 of 1 START sql view model bandcamp_sales_schema.stg_sales .................... [RUN]
[0m23:24:27.755874 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales'
[0m23:24:27.756164 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_sales
[0m23:24:27.760969 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_sales"
[0m23:24:27.761314 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (compile): 2023-04-18 23:24:27.756273 => 2023-04-18 23:24:27.761258
[0m23:24:27.761486 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_sales
[0m23:24:27.786768 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_sales"
[0m23:24:27.787118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:27.788384 [debug] [Thread-1 (]: On model.bc_sales.stg_sales: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`bc_sales`
limit 100;


[0m23:24:28.165074 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`bc_sales`
limit 100;


[0m23:24:28.165681 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset datatalksclub-375802:bandcamp_sales_schema was not found in location US

Location: US
Job ID: 864c7a0b-13e1-4c5b-a555-ff337a10a973

[0m23:24:28.165934 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (execute): 2023-04-18 23:24:27.761586 => 2023-04-18 23:24:28.165876
[0m23:24:28.167819 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  404 Not found: Dataset datatalksclub-375802:bandcamp_sales_schema was not found in location US
  
  Location: US
  Job ID: 864c7a0b-13e1-4c5b-a555-ff337a10a973
  
[0m23:24:28.168175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '081a119d-970b-4534-ac77-009a1d904d2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e60886ce0>]}
[0m23:24:28.168539 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model bandcamp_sales_schema.stg_sales ........... [[31mERROR[0m in 0.41s]
[0m23:24:28.170079 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_sales
[0m23:24:28.171389 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:24:28.171789 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:24:28.171913 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales' was properly closed.
[0m23:24:28.172042 [info ] [MainThread]: 
[0m23:24:28.172224 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m23:24:28.172450 [debug] [MainThread]: Command end result
[0m23:24:28.176810 [info ] [MainThread]: 
[0m23:24:28.177058 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:24:28.177218 [info ] [MainThread]: 
[0m23:24:28.177382 [error] [MainThread]: [33mRuntime Error in model stg_sales (models/staging/stg_sales.sql)[0m
[0m23:24:28.177572 [error] [MainThread]:   404 Not found: Dataset datatalksclub-375802:bandcamp_sales_schema was not found in location US
[0m23:24:28.177730 [error] [MainThread]:   
[0m23:24:28.177895 [error] [MainThread]:   Location: US
[0m23:24:28.178041 [error] [MainThread]:   Job ID: 864c7a0b-13e1-4c5b-a555-ff337a10a973
[0m23:24:28.178195 [error] [MainThread]:   
[0m23:24:28.178337 [info ] [MainThread]: 
[0m23:24:28.178519 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:24:28.178796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e61996320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e616ed240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e61762320>]}
[0m23:24:28.178981 [debug] [MainThread]: Flushing usage events


============================== 2023-04-18 23:24:46.575482 | dd7a5a7f-8ddd-4937-8834-ca9d30007170 ==============================
[0m23:24:46.575482 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:24:46.576842 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/j/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:24:46.577129 [debug] [MainThread]: Tracking: tracking
[0m23:24:46.578238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079b5f0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079b5f17e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079b5f1450>]}
[0m23:24:46.585532 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:24:46.591001 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:24:46.591309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dd7a5a7f-8ddd-4937-8834-ca9d30007170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079b5f35b0>]}
[0m23:24:47.091092 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales.sql
[0m23:24:47.131322 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m23:24:47.135181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd7a5a7f-8ddd-4937-8834-ca9d30007170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079b5654e0>]}
[0m23:24:47.139699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd7a5a7f-8ddd-4937-8834-ca9d30007170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079b4ed900>]}
[0m23:24:47.139949 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:24:47.140176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd7a5a7f-8ddd-4937-8834-ca9d30007170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079b5f2da0>]}
[0m23:24:47.141066 [info ] [MainThread]: 
[0m23:24:47.142408 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:24:47.143292 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m23:24:47.143607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:24:47.143921 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/home/j/.creds/gcp/gaci.json''
[0m23:24:47.144690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:24:47.144859 [debug] [MainThread]: Connection 'list_datatalksclub-375802' was properly closed.
[0m23:24:47.144981 [info ] [MainThread]: 
[0m23:24:47.145182 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.00 seconds (0.00s).
[0m23:24:47.145416 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: '/home/j/.creds/gcp/gaci.json'
[0m23:24:47.145657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079b7ab700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079b68fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079b68e9e0>]}
[0m23:24:47.145819 [debug] [MainThread]: Flushing usage events


============================== 2023-04-18 23:25:27.014783 | 0afc57ec-4fb8-40eb-bf21-310e6aa7d502 ==============================
[0m23:25:27.014783 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:25:27.015983 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/j/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:25:27.016105 [debug] [MainThread]: Tracking: tracking
[0m23:25:27.017150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da8780b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da8780820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da87814e0>]}
[0m23:25:27.024397 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:25:27.029814 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:25:27.030077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0afc57ec-4fb8-40eb-bf21-310e6aa7d502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da87811e0>]}
[0m23:25:27.525808 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales.sql
[0m23:25:27.566688 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m23:25:27.570490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0afc57ec-4fb8-40eb-bf21-310e6aa7d502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da8637c70>]}
[0m23:25:27.575010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0afc57ec-4fb8-40eb-bf21-310e6aa7d502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da86343a0>]}
[0m23:25:27.575261 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:25:27.575453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0afc57ec-4fb8-40eb-bf21-310e6aa7d502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da873f670>]}
[0m23:25:27.576294 [info ] [MainThread]: 
[0m23:25:27.577614 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:25:27.578485 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m23:25:27.578878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:25:27.868263 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m23:25:27.868586 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:25:28.123084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0afc57ec-4fb8-40eb-bf21-310e6aa7d502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da854cd30>]}
[0m23:25:28.123751 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:25:28.123988 [info ] [MainThread]: 
[0m23:25:28.126755 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_sales
[0m23:25:28.127168 [info ] [Thread-1 (]: 1 of 1 START sql view model bandcamp_sales_schema.stg_sales .................... [RUN]
[0m23:25:28.127801 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales'
[0m23:25:28.127974 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_sales
[0m23:25:28.132873 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_sales"
[0m23:25:28.133240 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (compile): 2023-04-18 23:25:28.128077 => 2023-04-18 23:25:28.133174
[0m23:25:28.133420 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_sales
[0m23:25:28.158890 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_sales"
[0m23:25:28.159261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:28.160533 [debug] [Thread-1 (]: On model.bc_sales.stg_sales: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`bc_sales`
limit 100;


[0m23:25:28.519171 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`bc_sales`
limit 100;


[0m23:25:28.519800 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset datatalksclub-375802:bandcamp_sales_schema was not found in location US

Location: US
Job ID: 1d8e66c0-a369-46c4-ba87-8b9edcfe7667

[0m23:25:28.520050 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (execute): 2023-04-18 23:25:28.133522 => 2023-04-18 23:25:28.519992
[0m23:25:28.521926 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  404 Not found: Dataset datatalksclub-375802:bandcamp_sales_schema was not found in location US
  
  Location: US
  Job ID: 1d8e66c0-a369-46c4-ba87-8b9edcfe7667
  
[0m23:25:28.522283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0afc57ec-4fb8-40eb-bf21-310e6aa7d502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da85308e0>]}
[0m23:25:28.522676 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model bandcamp_sales_schema.stg_sales ........... [[31mERROR[0m in 0.39s]
[0m23:25:28.524234 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_sales
[0m23:25:28.525525 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:25:28.525960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:25:28.526088 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales' was properly closed.
[0m23:25:28.526218 [info ] [MainThread]: 
[0m23:25:28.526398 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m23:25:28.526649 [debug] [MainThread]: Command end result
[0m23:25:28.531014 [info ] [MainThread]: 
[0m23:25:28.531272 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:25:28.531438 [info ] [MainThread]: 
[0m23:25:28.531607 [error] [MainThread]: [33mRuntime Error in model stg_sales (models/staging/stg_sales.sql)[0m
[0m23:25:28.531771 [error] [MainThread]:   404 Not found: Dataset datatalksclub-375802:bandcamp_sales_schema was not found in location US
[0m23:25:28.531911 [error] [MainThread]:   
[0m23:25:28.532040 [error] [MainThread]:   Location: US
[0m23:25:28.532164 [error] [MainThread]:   Job ID: 1d8e66c0-a369-46c4-ba87-8b9edcfe7667
[0m23:25:28.532300 [error] [MainThread]:   
[0m23:25:28.532434 [info ] [MainThread]: 
[0m23:25:28.532578 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:25:28.532793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da854d660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da8b15360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da860d060>]}
[0m23:25:28.532974 [debug] [MainThread]: Flushing usage events


============================== 2023-04-18 23:33:15.463380 | 8256389f-62d3-4705-951e-55d640e4e12f ==============================
[0m23:33:15.463380 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:33:15.464597 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/j/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:33:15.464719 [debug] [MainThread]: Tracking: tracking
[0m23:33:15.465755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc2ceec80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc2cecf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc2cedb40>]}
[0m23:33:15.472958 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:33:15.488087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:33:15.488406 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/staging/schema.yml
[0m23:33:15.494688 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m23:33:15.498833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8256389f-62d3-4705-951e-55d640e4e12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc2af40d0>]}
[0m23:33:15.503333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8256389f-62d3-4705-951e-55d640e4e12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc2c7d780>]}
[0m23:33:15.503583 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:33:15.503788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8256389f-62d3-4705-951e-55d640e4e12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc2c7d810>]}
[0m23:33:15.504592 [info ] [MainThread]: 
[0m23:33:15.505880 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:33:15.506765 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m23:33:15.506996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:15.813015 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m23:33:15.813330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:33:16.187819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8256389f-62d3-4705-951e-55d640e4e12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc2c6fe50>]}
[0m23:33:16.188474 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:33:16.188683 [info ] [MainThread]: 
[0m23:33:16.192137 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_sales
[0m23:33:16.192474 [info ] [Thread-1 (]: 1 of 1 START sql view model bandcamp_sales_schema.stg_sales .................... [RUN]
[0m23:33:16.192981 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales'
[0m23:33:16.193143 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_sales
[0m23:33:16.195578 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_sales"
[0m23:33:16.195917 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (compile): 2023-04-18 23:33:16.193242 => 2023-04-18 23:33:16.195863
[0m23:33:16.196083 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_sales
[0m23:33:16.219765 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_sales"
[0m23:33:16.220176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:33:16.221456 [debug] [Thread-1 (]: On model.bc_sales.stg_sales: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`bc_sales`
limit 100;


[0m23:33:16.628052 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`bc_sales`
limit 100;


[0m23:33:16.628687 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset datatalksclub-375802:bandcamp_sales_schema was not found in location US

Location: US
Job ID: 0c7d8643-e18d-494c-9bb0-c0aa8f28c0bf

[0m23:33:16.628955 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (execute): 2023-04-18 23:33:16.196178 => 2023-04-18 23:33:16.628894
[0m23:33:16.630893 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  404 Not found: Dataset datatalksclub-375802:bandcamp_sales_schema was not found in location US
  
  Location: US
  Job ID: 0c7d8643-e18d-494c-9bb0-c0aa8f28c0bf
  
[0m23:33:16.631245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8256389f-62d3-4705-951e-55d640e4e12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc2d00730>]}
[0m23:33:16.631606 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model bandcamp_sales_schema.stg_sales ........... [[31mERROR[0m in 0.44s]
[0m23:33:16.633212 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_sales
[0m23:33:16.634569 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:33:16.634952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:33:16.635071 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales' was properly closed.
[0m23:33:16.635201 [info ] [MainThread]: 
[0m23:33:16.635399 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m23:33:16.635705 [debug] [MainThread]: Command end result
[0m23:33:16.640031 [info ] [MainThread]: 
[0m23:33:16.640303 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:33:16.640494 [info ] [MainThread]: 
[0m23:33:16.640696 [error] [MainThread]: [33mRuntime Error in model stg_sales (models/staging/stg_sales.sql)[0m
[0m23:33:16.640900 [error] [MainThread]:   404 Not found: Dataset datatalksclub-375802:bandcamp_sales_schema was not found in location US
[0m23:33:16.641055 [error] [MainThread]:   
[0m23:33:16.641218 [error] [MainThread]:   Location: US
[0m23:33:16.641385 [error] [MainThread]:   Job ID: 0c7d8643-e18d-494c-9bb0-c0aa8f28c0bf
[0m23:33:16.641542 [error] [MainThread]:   
[0m23:33:16.641693 [info ] [MainThread]: 
[0m23:33:16.641877 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:33:16.642119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc2e62740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc2c6fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc2c6fcd0>]}
[0m23:33:16.642331 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 00:01:35.525415 | 1f2964f7-ff9f-4109-badd-89f2a7d39c58 ==============================
[0m00:01:35.525415 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:01:35.526642 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/j/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m00:01:35.526766 [debug] [MainThread]: Tracking: tracking
[0m00:01:35.527839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e9f735b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e9f73f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e9f73910>]}
[0m00:01:35.780419 [debug] [MainThread]: Executing "git --help"
[0m00:01:35.781903 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:01:35.782069 [debug] [MainThread]: STDERR: "b''"
[0m00:01:35.783900 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m00:01:35.784116 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:01:35.785377 [debug] [MainThread]: On debug: select 1 as id
[0m00:01:36.752410 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:US:6825884b-c0f7-43f9-a8b5-063eccee2a17&page=queryresults
[0m00:01:36.752819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e8105f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e80f6b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e80f4f10>]}
[0m00:01:36.753736 [debug] [MainThread]: Flushing usage events
[0m00:01:36.969569 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2023-04-19 00:18:13.998719 | ecec21ec-2802-4fe6-8cfb-1795dd0c0623 ==============================
[0m00:18:13.998719 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:18:13.999952 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/j/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m00:18:14.000073 [debug] [MainThread]: Tracking: tracking
[0m00:18:14.001174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f081639f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f081639fd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f081639efe0>]}
[0m00:18:14.254827 [debug] [MainThread]: Executing "git --help"
[0m00:18:14.256249 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:18:14.256437 [debug] [MainThread]: STDERR: "b''"
[0m00:18:14.258329 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m00:18:14.258547 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:18:14.259821 [debug] [MainThread]: On debug: select 1 as id
[0m00:18:15.430800 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:US:68ba0cd1-62a4-4edb-a88c-a2b2cde563de&page=queryresults
[0m00:18:15.431213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0814995c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0814997e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0814997ca0>]}
[0m00:18:15.431460 [debug] [MainThread]: Flushing usage events
[0m00:18:15.662460 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2023-04-19 00:18:22.320619 | 91ee887e-8b8f-461d-9ddc-24496600bb5f ==============================
[0m00:18:22.320619 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:18:22.321852 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/j/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:18:22.321973 [debug] [MainThread]: Tracking: tracking
[0m00:18:22.323182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5079e1360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5079e0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5079e11e0>]}
[0m00:18:22.330468 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m00:18:22.335838 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:18:22.336099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '91ee887e-8b8f-461d-9ddc-24496600bb5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5077fb730>]}
[0m00:18:22.836036 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales.sql
[0m00:18:22.876550 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m00:18:22.880425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91ee887e-8b8f-461d-9ddc-24496600bb5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff507869990>]}
[0m00:18:22.884974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91ee887e-8b8f-461d-9ddc-24496600bb5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff507869ff0>]}
[0m00:18:22.885224 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:18:22.885421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91ee887e-8b8f-461d-9ddc-24496600bb5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff507913490>]}
[0m00:18:22.886261 [info ] [MainThread]: 
[0m00:18:22.887605 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:18:22.888473 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m00:18:22.888699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:23.184667 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m00:18:23.185029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:23.461792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91ee887e-8b8f-461d-9ddc-24496600bb5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5078b6470>]}
[0m00:18:23.462432 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:18:23.462670 [info ] [MainThread]: 
[0m00:18:23.465354 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_sales
[0m00:18:23.465686 [info ] [Thread-1 (]: 1 of 1 START sql view model bandcamp_sales_schema.stg_sales .................... [RUN]
[0m00:18:23.466143 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales'
[0m00:18:23.466448 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_sales
[0m00:18:23.471252 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_sales"
[0m00:18:23.471596 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (compile): 2023-04-19 00:18:23.466549 => 2023-04-19 00:18:23.471539
[0m00:18:23.471769 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_sales
[0m00:18:23.496766 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_sales"
[0m00:18:23.497138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:23.498392 [debug] [Thread-1 (]: On model.bc_sales.stg_sales: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`bc_sales`
limit 100;


[0m00:18:23.830323 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`bc_sales`
limit 100;


[0m00:18:23.830943 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset datatalksclub-375802:bandcamp_sales_schema was not found in location US

Location: US
Job ID: 45bcd706-cfa6-4de2-a644-58fa1f46686d

[0m00:18:23.831203 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (execute): 2023-04-19 00:18:23.471864 => 2023-04-19 00:18:23.831144
[0m00:18:23.833067 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  404 Not found: Dataset datatalksclub-375802:bandcamp_sales_schema was not found in location US
  
  Location: US
  Job ID: 45bcd706-cfa6-4de2-a644-58fa1f46686d
  
[0m00:18:23.833396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91ee887e-8b8f-461d-9ddc-24496600bb5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5066870a0>]}
[0m00:18:23.833743 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model bandcamp_sales_schema.stg_sales ........... [[31mERROR[0m in 0.37s]
[0m00:18:23.835263 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_sales
[0m00:18:23.836567 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:18:23.836994 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:18:23.837118 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales' was properly closed.
[0m00:18:23.837252 [info ] [MainThread]: 
[0m00:18:23.837592 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m00:18:23.837900 [debug] [MainThread]: Command end result
[0m00:18:23.842260 [info ] [MainThread]: 
[0m00:18:23.842529 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:18:23.842750 [info ] [MainThread]: 
[0m00:18:23.842957 [error] [MainThread]: [33mRuntime Error in model stg_sales (models/staging/stg_sales.sql)[0m
[0m00:18:23.843142 [error] [MainThread]:   404 Not found: Dataset datatalksclub-375802:bandcamp_sales_schema was not found in location US
[0m00:18:23.843316 [error] [MainThread]:   
[0m00:18:23.843485 [error] [MainThread]:   Location: US
[0m00:18:23.843649 [error] [MainThread]:   Job ID: 45bcd706-cfa6-4de2-a644-58fa1f46686d
[0m00:18:23.843817 [error] [MainThread]:   
[0m00:18:23.843983 [info ] [MainThread]: 
[0m00:18:23.844156 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:18:23.844401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5077ee380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50775b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff507761e10>]}
[0m00:18:23.844617 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 00:39:04.556189 | 421b2d29-df97-4842-91e9-fed006cdf2c1 ==============================
[0m00:39:04.556189 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:39:04.557427 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/j/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:39:04.557555 [debug] [MainThread]: Tracking: tracking
[0m00:39:04.558610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8687ce71c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8687ce5450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8687ce49a0>]}
[0m00:39:04.565841 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m00:39:04.571281 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:39:04.571546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '421b2d29-df97-4842-91e9-fed006cdf2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8687ce5510>]}
[0m00:39:05.074541 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales.sql
[0m00:39:05.114809 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m00:39:05.118656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '421b2d29-df97-4842-91e9-fed006cdf2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8687a6a1a0>]}
[0m00:39:05.123163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '421b2d29-df97-4842-91e9-fed006cdf2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8687a6a560>]}
[0m00:39:05.123425 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:39:05.123620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '421b2d29-df97-4842-91e9-fed006cdf2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8687a5b100>]}
[0m00:39:05.124464 [info ] [MainThread]: 
[0m00:39:05.125767 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:39:05.126669 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m00:39:05.126921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:39:05.426426 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m00:39:05.426800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:39:05.703279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '421b2d29-df97-4842-91e9-fed006cdf2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8687ab9720>]}
[0m00:39:05.703911 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:39:05.704137 [info ] [MainThread]: 
[0m00:39:05.706771 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_sales
[0m00:39:05.707159 [info ] [Thread-1 (]: 1 of 1 START sql view model bandcamp_sales_schema.stg_sales .................... [RUN]
[0m00:39:05.707747 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales'
[0m00:39:05.707919 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_sales
[0m00:39:05.712681 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_sales"
[0m00:39:05.713021 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (compile): 2023-04-19 00:39:05.708020 => 2023-04-19 00:39:05.712967
[0m00:39:05.713190 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_sales
[0m00:39:05.738784 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_sales"
[0m00:39:05.739167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:39:05.740430 [debug] [Thread-1 (]: On model.bc_sales.stg_sales: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`bc_sales`
limit 100;


[0m00:39:05.909528 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('POST https://bigquery.googleapis.com/bigquery/v2/projects/datatalksclub-375802/jobs?prettyPrint=false: Location None does not support this operation.')
[0m00:39:06.521366 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:None:59790f24-eaad-4625-870f-4c8947175d68&page=queryresults
[0m00:39:06.521837 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (execute): 2023-04-19 00:39:05.713294 => 2023-04-19 00:39:06.521772
[0m00:39:06.524192 [debug] [Thread-1 (]: Database Error in model stg_sales (models/staging/stg_sales.sql)
  Location None does not support this operation.
  compiled Code at target/run/bc_sales/models/staging/stg_sales.sql
[0m00:39:06.524544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '421b2d29-df97-4842-91e9-fed006cdf2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8687a9c640>]}
[0m00:39:06.524897 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model bandcamp_sales_schema.stg_sales ........... [[31mERROR[0m in 0.82s]
[0m00:39:06.526091 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_sales
[0m00:39:06.527375 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:39:06.527793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:39:06.527919 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales' was properly closed.
[0m00:39:06.528052 [info ] [MainThread]: 
[0m00:39:06.528229 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.40 seconds (1.40s).
[0m00:39:06.528450 [debug] [MainThread]: Command end result
[0m00:39:06.532991 [info ] [MainThread]: 
[0m00:39:06.533242 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:39:06.533401 [info ] [MainThread]: 
[0m00:39:06.533568 [error] [MainThread]: [33mDatabase Error in model stg_sales (models/staging/stg_sales.sql)[0m
[0m00:39:06.533718 [error] [MainThread]:   Location None does not support this operation.
[0m00:39:06.533861 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/staging/stg_sales.sql
[0m00:39:06.533996 [info ] [MainThread]: 
[0m00:39:06.534141 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:39:06.534346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8687a4e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8687b70760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8687ce7e50>]}
[0m00:39:06.534531 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 00:53:10.728161 | 5a9caf5a-e5df-49ba-a617-95dad5529823 ==============================
[0m00:53:10.728161 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:53:10.729464 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/j/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:53:10.729587 [debug] [MainThread]: Tracking: tracking
[0m00:53:10.730682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba497f4a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba497f7af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba497f5330>]}
[0m00:53:10.738448 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m00:53:10.744108 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:53:10.744439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5a9caf5a-e5df-49ba-a617-95dad5529823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba497f56f0>]}
[0m00:53:11.263116 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales.sql
[0m00:53:11.304020 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m00:53:11.307943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a9caf5a-e5df-49ba-a617-95dad5529823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4976d1e0>]}
[0m00:53:11.312481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a9caf5a-e5df-49ba-a617-95dad5529823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4976d5d0>]}
[0m00:53:11.312742 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:53:11.312945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a9caf5a-e5df-49ba-a617-95dad5529823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba49767130>]}
[0m00:53:11.313843 [info ] [MainThread]: 
[0m00:53:11.315233 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:53:11.316121 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m00:53:11.316453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:53:11.616197 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m00:53:11.616512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:53:11.869906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a9caf5a-e5df-49ba-a617-95dad5529823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4976d570>]}
[0m00:53:11.870480 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:53:11.870721 [info ] [MainThread]: 
[0m00:53:11.873419 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_sales
[0m00:53:11.873739 [info ] [Thread-1 (]: 1 of 1 START sql view model bandcamp_sales_schema.stg_sales .................... [RUN]
[0m00:53:11.874174 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales'
[0m00:53:11.874477 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_sales
[0m00:53:11.879108 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_sales"
[0m00:53:11.879455 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (compile): 2023-04-19 00:53:11.874590 => 2023-04-19 00:53:11.879400
[0m00:53:11.879632 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_sales
[0m00:53:11.904801 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_sales"
[0m00:53:11.905137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:11.906347 [debug] [Thread-1 (]: On model.bc_sales.stg_sales: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`bc_sales`
limit 100;


[0m00:53:12.833649 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:4235985c-2022-4ba5-9b35-eec4753a5281&page=queryresults
[0m00:53:12.845739 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (execute): 2023-04-19 00:53:11.879732 => 2023-04-19 00:53:12.845663
[0m00:53:12.846367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a9caf5a-e5df-49ba-a617-95dad5529823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba49787460>]}
[0m00:53:12.846741 [info ] [Thread-1 (]: 1 of 1 OK created sql view model bandcamp_sales_schema.stg_sales ............... [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m00:53:12.847993 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_sales
[0m00:53:12.849298 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:53:12.849719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:53:12.849845 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales' was properly closed.
[0m00:53:12.849978 [info ] [MainThread]: 
[0m00:53:12.850161 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.54 seconds (1.54s).
[0m00:53:12.850637 [debug] [MainThread]: Command end result
[0m00:53:12.855250 [info ] [MainThread]: 
[0m00:53:12.855565 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:53:12.855732 [info ] [MainThread]: 
[0m00:53:12.855883 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:53:12.856130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4975f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba497f47c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4980b880>]}
[0m00:53:12.856334 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 01:10:23.018159 | d18d5383-bde0-4945-acc3-8262b269dc3a ==============================
[0m01:10:23.018159 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:10:23.019482 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/j/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:10:23.019605 [debug] [MainThread]: Tracking: tracking
[0m01:10:23.020718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b4ee47f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b4ee4f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b4ee57e0>]}
[0m01:10:23.028445 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:10:23.034104 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m01:10:23.034421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd18d5383-bde0-4945-acc3-8262b269dc3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b4cfdbd0>]}
[0m01:10:23.565097 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales.sql
[0m01:10:23.608805 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m01:10:23.613232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd18d5383-bde0-4945-acc3-8262b269dc3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b4dd9900>]}
[0m01:10:23.618398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd18d5383-bde0-4945-acc3-8262b269dc3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b4dd9540>]}
[0m01:10:23.618758 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m01:10:23.618968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd18d5383-bde0-4945-acc3-8262b269dc3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b4c5f100>]}
[0m01:10:23.619925 [info ] [MainThread]: 
[0m01:10:23.621342 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:10:23.622358 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m01:10:23.622745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:10:23.932707 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m01:10:23.933106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:10:24.190521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd18d5383-bde0-4945-acc3-8262b269dc3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b4ee4760>]}
[0m01:10:24.191237 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:10:24.191518 [info ] [MainThread]: 
[0m01:10:24.194496 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_sales
[0m01:10:24.194885 [info ] [Thread-1 (]: 1 of 1 START sql view model bandcamp_sales_schema.stg_sales .................... [RUN]
[0m01:10:24.195545 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales'
[0m01:10:24.195726 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_sales
[0m01:10:24.200810 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_sales"
[0m01:10:24.201215 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (compile): 2023-04-19 01:10:24.195832 => 2023-04-19 01:10:24.201145
[0m01:10:24.201412 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_sales
[0m01:10:24.227385 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_sales"
[0m01:10:24.227966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:24.229349 [debug] [Thread-1 (]: On model.bc_sales.stg_sales: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`bc_sales`
limit 100;


[0m01:10:25.146054 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:e872e941-46ae-4be3-afa3-e242bb3fe166&page=queryresults
[0m01:10:25.159829 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (execute): 2023-04-19 01:10:24.201515 => 2023-04-19 01:10:25.159762
[0m01:10:25.160445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd18d5383-bde0-4945-acc3-8262b269dc3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b4cad840>]}
[0m01:10:25.160809 [info ] [Thread-1 (]: 1 of 1 OK created sql view model bandcamp_sales_schema.stg_sales ............... [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m01:10:25.162123 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_sales
[0m01:10:25.163513 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:10:25.163941 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:10:25.164068 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales' was properly closed.
[0m01:10:25.164199 [info ] [MainThread]: 
[0m01:10:25.164381 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.54 seconds (1.54s).
[0m01:10:25.164634 [debug] [MainThread]: Command end result
[0m01:10:25.169396 [info ] [MainThread]: 
[0m01:10:25.169675 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:10:25.169847 [info ] [MainThread]: 
[0m01:10:25.170018 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:10:25.170269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b4cb8310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b4c62140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b4cefb50>]}
[0m01:10:25.170469 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 05:16:25.875797 | 2cbf5c8d-f5da-4307-adf0-1ee07e767237 ==============================
[0m05:16:25.875797 [info ] [MainThread]: Running with dbt=1.4.5
[0m05:16:25.877132 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/j/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:16:25.877327 [debug] [MainThread]: Tracking: tracking
[0m05:16:25.878508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34eaef5510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34eaef4fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34eaef4820>]}
[0m05:16:25.886842 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m05:16:25.902696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:16:25.902921 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:16:25.903335 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m05:16:25.907927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cbf5c8d-f5da-4307-adf0-1ee07e767237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34eaebd210>]}
[0m05:16:25.912825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cbf5c8d-f5da-4307-adf0-1ee07e767237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34eadfd690>]}
[0m05:16:25.913116 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m05:16:25.913337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cbf5c8d-f5da-4307-adf0-1ee07e767237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34edf47730>]}
[0m05:16:25.914200 [info ] [MainThread]: 
[0m05:16:25.915593 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m05:16:25.916556 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m05:16:25.916895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:16:26.221683 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m05:16:26.222069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:16:26.494722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cbf5c8d-f5da-4307-adf0-1ee07e767237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34eaef8e80>]}
[0m05:16:26.495373 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:16:26.495597 [info ] [MainThread]: 
[0m05:16:26.498226 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_sales
[0m05:16:26.498542 [info ] [Thread-1 (]: 1 of 1 START sql view model bandcamp_sales_schema.stg_sales .................... [RUN]
[0m05:16:26.499010 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales'
[0m05:16:26.499160 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_sales
[0m05:16:26.501580 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_sales"
[0m05:16:26.501928 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (compile): 2023-04-19 05:16:26.499268 => 2023-04-19 05:16:26.501873
[0m05:16:26.502097 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_sales
[0m05:16:26.567653 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_sales"
[0m05:16:26.568062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:16:26.569255 [debug] [Thread-1 (]: On model.bc_sales.stg_sales: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`bc_sales`
limit 100;


[0m05:16:27.477013 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:a290f79e-cc3b-4342-904f-bb2ffb97b67e&page=queryresults
[0m05:16:27.490619 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (execute): 2023-04-19 05:16:26.502200 => 2023-04-19 05:16:27.490540
[0m05:16:27.491212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cbf5c8d-f5da-4307-adf0-1ee07e767237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34eaea6ef0>]}
[0m05:16:27.491564 [info ] [Thread-1 (]: 1 of 1 OK created sql view model bandcamp_sales_schema.stg_sales ............... [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m05:16:27.492812 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_sales
[0m05:16:27.494090 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m05:16:27.494520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:16:27.494795 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales' was properly closed.
[0m05:16:27.494958 [info ] [MainThread]: 
[0m05:16:27.495166 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.58 seconds (1.58s).
[0m05:16:27.495450 [debug] [MainThread]: Command end result
[0m05:16:27.499742 [info ] [MainThread]: 
[0m05:16:27.500024 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:16:27.500228 [info ] [MainThread]: 
[0m05:16:27.500431 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:16:27.500684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34eae7bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34eae7ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34eae7be80>]}
[0m05:16:27.500877 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 05:21:53.588302 | c32398dd-c620-403c-8bb3-4fa8432dd436 ==============================
[0m05:21:53.588302 [info ] [MainThread]: Running with dbt=1.4.5
[0m05:21:53.589605 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/j/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:21:53.589727 [debug] [MainThread]: Tracking: tracking
[0m05:21:53.590829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a580ef0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a580eed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a580ef9d0>]}
[0m05:21:53.598343 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m05:21:53.613947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:21:53.614167 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:21:53.614611 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m05:21:53.619292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c32398dd-c620-403c-8bb3-4fa8432dd436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a580b4a30>]}
[0m05:21:53.624256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c32398dd-c620-403c-8bb3-4fa8432dd436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5807cee0>]}
[0m05:21:53.624536 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m05:21:53.624735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c32398dd-c620-403c-8bb3-4fa8432dd436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5807cf40>]}
[0m05:21:53.625544 [info ] [MainThread]: 
[0m05:21:53.626952 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m05:21:53.627861 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m05:21:53.628180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:21:53.958334 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m05:21:53.958710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:21:54.247289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c32398dd-c620-403c-8bb3-4fa8432dd436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a580f9db0>]}
[0m05:21:54.247900 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:21:54.248117 [info ] [MainThread]: 
[0m05:21:54.250701 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_sales
[0m05:21:54.251009 [info ] [Thread-1 (]: 1 of 1 START sql view model bandcamp_sales_schema.stg_sales .................... [RUN]
[0m05:21:54.251455 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales'
[0m05:21:54.251606 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_sales
[0m05:21:54.253971 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_sales"
[0m05:21:54.254313 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (compile): 2023-04-19 05:21:54.251698 => 2023-04-19 05:21:54.254258
[0m05:21:54.254482 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_sales
[0m05:21:54.317678 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_sales"
[0m05:21:54.318075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:21:54.319284 [debug] [Thread-1 (]: On model.bc_sales.stg_sales: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`bc_sales`
limit 100;


[0m05:21:55.238305 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:55dd66f5-290b-4bb3-b80c-37ddcbce33a5&page=queryresults
[0m05:21:55.252008 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (execute): 2023-04-19 05:21:54.254587 => 2023-04-19 05:21:55.251945
[0m05:21:55.252581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32398dd-c620-403c-8bb3-4fa8432dd436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a58641240>]}
[0m05:21:55.252927 [info ] [Thread-1 (]: 1 of 1 OK created sql view model bandcamp_sales_schema.stg_sales ............... [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m05:21:55.254172 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_sales
[0m05:21:55.255554 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m05:21:55.255965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:21:55.256090 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales' was properly closed.
[0m05:21:55.256220 [info ] [MainThread]: 
[0m05:21:55.256401 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.63 seconds (1.63s).
[0m05:21:55.256727 [debug] [MainThread]: Command end result
[0m05:21:55.261035 [info ] [MainThread]: 
[0m05:21:55.261312 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:21:55.261510 [info ] [MainThread]: 
[0m05:21:55.261725 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:21:55.261961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a58654f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a58657a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a58641390>]}
[0m05:21:55.262151 [debug] [MainThread]: Flushing usage events


============================== 2023-04-19 05:22:29.432495 | e3e99c3d-1f1f-435d-9bad-6e5b2ab06761 ==============================
[0m05:22:29.432495 [info ] [MainThread]: Running with dbt=1.4.5
[0m05:22:29.433732 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/j/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_sales'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:22:29.433856 [debug] [MainThread]: Tracking: tracking
[0m05:22:29.434966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14cd18d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14cd18d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14cd18d570>]}
[0m05:22:29.442195 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m05:22:29.457224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:22:29.457399 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:22:29.457741 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m05:22:29.461984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3e99c3d-1f1f-435d-9bad-6e5b2ab06761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ccf51150>]}
[0m05:22:29.466650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3e99c3d-1f1f-435d-9bad-6e5b2ab06761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ccf195d0>]}
[0m05:22:29.466893 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m05:22:29.467083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3e99c3d-1f1f-435d-9bad-6e5b2ab06761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14d0044ca0>]}
[0m05:22:29.467834 [info ] [MainThread]: 
[0m05:22:29.469130 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m05:22:29.469985 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m05:22:29.470320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:22:29.768813 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m05:22:29.769138 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:22:30.010178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3e99c3d-1f1f-435d-9bad-6e5b2ab06761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14cd193490>]}
[0m05:22:30.010853 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:22:30.011096 [info ] [MainThread]: 
[0m05:22:30.013819 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_sales
[0m05:22:30.014181 [info ] [Thread-1 (]: 1 of 1 START sql view model bandcamp_sales_schema.stg_sales .................... [RUN]
[0m05:22:30.014663 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales'
[0m05:22:30.014834 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_sales
[0m05:22:30.017316 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_sales"
[0m05:22:30.017684 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (compile): 2023-04-19 05:22:30.014938 => 2023-04-19 05:22:30.017625
[0m05:22:30.017872 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_sales
[0m05:22:30.083316 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_sales"
[0m05:22:30.083758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:22:30.084955 [debug] [Thread-1 (]: On model.bc_sales.stg_sales: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`bc_sales`
limit 100;


[0m05:22:31.032960 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:623d9981-229f-4bd5-a4e1-8e0597e75912&page=queryresults
[0m05:22:31.046519 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_sales (execute): 2023-04-19 05:22:30.017971 => 2023-04-19 05:22:31.046462
[0m05:22:31.047101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e99c3d-1f1f-435d-9bad-6e5b2ab06761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ccf3ae60>]}
[0m05:22:31.047446 [info ] [Thread-1 (]: 1 of 1 OK created sql view model bandcamp_sales_schema.stg_sales ............... [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m05:22:31.048681 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_sales
[0m05:22:31.049987 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m05:22:31.050392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:22:31.050516 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales' was properly closed.
[0m05:22:31.050667 [info ] [MainThread]: 
[0m05:22:31.050846 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.58 seconds (1.58s).
[0m05:22:31.051085 [debug] [MainThread]: Command end result
[0m05:22:31.055339 [info ] [MainThread]: 
[0m05:22:31.055593 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:22:31.055760 [info ] [MainThread]: 
[0m05:22:31.055920 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:22:31.056157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14d019c1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ccf0bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14cebfd180>]}
[0m05:22:31.056351 [debug] [MainThread]: Flushing usage events
[0m21:01:50.890969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2173a4e500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21729d3010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21729d2f80>]}


============================== 21:01:50.895655 | 5fff0758-598b-49d2-a857-f18577dc2c03 ==============================
[0m21:01:50.895655 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:01:50.896758 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/j/.dbt', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:01:50.897500 [info ] [MainThread]: dbt version: 1.5.0
[0m21:01:50.898222 [info ] [MainThread]: python version: 3.10.6
[0m21:01:50.898892 [info ] [MainThread]: python path: /usr/bin/python3
[0m21:01:50.899562 [info ] [MainThread]: os info: Linux-5.19.0-1022-gcp-x86_64-with-glibc2.35
[0m21:01:50.900301 [info ] [MainThread]: Using profiles.yml file at /home/j/.dbt/profiles.yml
[0m21:01:50.900956 [info ] [MainThread]: Using dbt_project.yml file at /home/j/bcsales/dbt/bc_sales/dbt_project.yml
[0m21:01:50.901612 [info ] [MainThread]: Configuration:
[0m21:01:50.907495 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Runtime Error
    Syntax error near line 12
    ------------------------------
    9  |       threads: 4
    10 | 
    11 |       # These fields come from the service account json keyfile
    12 |       keyfile: {{ env_var('HOME') }}/.creds/gcp/gac.json
    13 | 
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 5, column 7
    did not find expected key
      in "<unicode string>", line 12, column 37
  
[0m21:01:50.908943 [debug] [MainThread]: Command `dbt debug` failed at 21:01:50.908723 after 0.03 seconds
[0m21:01:50.909544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2173a4e500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21729d3e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21729d3ca0>]}
[0m21:01:50.910252 [debug] [MainThread]: Flushing usage events
[0m21:04:51.654476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f627ec52590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f627dbdb0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f627dbdb010>]}


============================== 21:04:51.658339 | 3330cedf-0bd9-41a7-9ceb-2041d7cdbf92 ==============================
[0m21:04:51.658339 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:04:51.659345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:04:51.660207 [info ] [MainThread]: dbt version: 1.5.0
[0m21:04:51.660884 [info ] [MainThread]: python version: 3.10.6
[0m21:04:51.661442 [info ] [MainThread]: python path: /usr/bin/python3
[0m21:04:51.662105 [info ] [MainThread]: os info: Linux-5.19.0-1022-gcp-x86_64-with-glibc2.35
[0m21:04:51.662662 [info ] [MainThread]: Using profiles.yml file at /home/j/.dbt/profiles.yml
[0m21:04:51.663212 [info ] [MainThread]: Using dbt_project.yml file at /home/j/bcsales/dbt/bc_sales/dbt_project.yml
[0m21:04:51.663764 [info ] [MainThread]: Configuration:
[0m21:04:51.668670 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Runtime Error
    Syntax error near line 12
    ------------------------------
    9  |       threads: 4
    10 | 
    11 |       # These fields come from the service account json keyfile
    12 |       keyfile: {{ env_var('GOOGLE_APPLICATION_CREDENTIALS') }}/.creds/gcp/gac.json
    13 | 
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 5, column 7
    did not find expected key
      in "<unicode string>", line 12, column 63
  
[0m21:04:51.672495 [debug] [MainThread]: Command `dbt debug` failed at 21:04:51.672309 after 0.02 seconds
[0m21:04:51.672956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f627ec52590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f627dbdbeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f627dbdbd30>]}
[0m21:04:51.673444 [debug] [MainThread]: Flushing usage events
[0m21:06:52.177561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfefc4a530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfeebcf8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfeebcf850>]}


============================== 21:06:52.181059 | 5595bef9-7b31-418f-b826-e116a43397fd ==============================
[0m21:06:52.181059 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:06:52.182042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'version_check': 'True', 'profiles_dir': '/home/j/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:06:52.182837 [info ] [MainThread]: dbt version: 1.5.0
[0m21:06:52.183521 [info ] [MainThread]: python version: 3.10.6
[0m21:06:52.184095 [info ] [MainThread]: python path: /usr/bin/python3
[0m21:06:52.184648 [info ] [MainThread]: os info: Linux-5.19.0-1022-gcp-x86_64-with-glibc2.35
[0m21:06:52.185194 [info ] [MainThread]: Using profiles.yml file at /home/j/.dbt/profiles.yml
[0m21:06:52.185720 [info ] [MainThread]: Using dbt_project.yml file at /home/j/bcsales/dbt/bc_sales/dbt_project.yml
[0m21:06:52.186252 [info ] [MainThread]: Configuration:
[0m21:06:52.190805 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Runtime Error
    Syntax error near line 7
    ------------------------------
    4  |     dev:
    5  |       type: bigquery
    6  |       method: service-account-json
    7  |       project: {{ env_var('GCP_PROJECT') }}
    8  |       dataset: bandcamp_sales_schema
    9  |       threads: 4
    10 | 
    
    Raw Error:
    ------------------------------
    while constructing a mapping
      in "<unicode string>", line 7, column 16
    found unhashable key
      in "<unicode string>", line 7, column 17
  
[0m21:06:52.191954 [debug] [MainThread]: Command `dbt debug` failed at 21:06:52.191717 after 0.02 seconds
[0m21:06:52.192416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfefc4a530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfee735a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfee735ab0>]}
[0m21:06:52.192883 [debug] [MainThread]: Flushing usage events
[0m21:07:18.768270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b2da42530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b2c6cb640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b2c6cb610>]}


============================== 21:07:18.772033 | 89305500-082d-4737-ab0e-30d1e0215c84 ==============================
[0m21:07:18.772033 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:07:18.773056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/j/.dbt', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:07:18.773864 [info ] [MainThread]: dbt version: 1.5.0
[0m21:07:18.774575 [info ] [MainThread]: python version: 3.10.6
[0m21:07:18.775171 [info ] [MainThread]: python path: /usr/bin/python3
[0m21:07:18.775759 [info ] [MainThread]: os info: Linux-5.19.0-1022-gcp-x86_64-with-glibc2.35
[0m21:07:18.776402 [info ] [MainThread]: Using profiles.yml file at /home/j/.dbt/profiles.yml
[0m21:07:18.776980 [info ] [MainThread]: Using dbt_project.yml file at /home/j/bcsales/dbt/bc_sales/dbt_project.yml
[0m21:07:18.777544 [info ] [MainThread]: Configuration:
[0m21:07:19.951980 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:07:19.974144 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:07:19.975461 [info ] [MainThread]: Required dependencies:
[0m21:07:19.976259 [debug] [MainThread]: Executing "git --help"
[0m21:07:19.979259 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:07:19.979868 [debug] [MainThread]: STDERR: "b''"
[0m21:07:19.980255 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:07:19.981102 [info ] [MainThread]: Connection:
[0m21:07:19.981833 [info ] [MainThread]:   method: service-account-json
[0m21:07:19.982490 [info ] [MainThread]:   database: datatalksclub-375802
[0m21:07:19.983135 [info ] [MainThread]:   schema: bandcamp_sales_schema
[0m21:07:19.983796 [info ] [MainThread]:   location: None
[0m21:07:19.984482 [info ] [MainThread]:   priority: None
[0m21:07:19.985132 [info ] [MainThread]:   timeout_seconds: None
[0m21:07:19.985757 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:07:19.986407 [info ] [MainThread]:   execution_project: datatalksclub-375802
[0m21:07:19.987050 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:07:19.987684 [info ] [MainThread]:   job_retries: 1
[0m21:07:19.988479 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:07:19.989152 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m21:07:19.989803 [info ] [MainThread]:   gcs_bucket: None
[0m21:07:19.990869 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:07:19.991271 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:07:19.991716 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: ''NoneType' object has no attribute 'keys''
[0m21:07:19.992289 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m21:07:19.993084 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:07:19.993804 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  'NoneType' object has no attribute 'keys'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m21:07:19.995830 [debug] [MainThread]: Command `dbt debug` failed at 21:07:19.995627 after 1.24 seconds
[0m21:07:19.996274 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:07:19.996895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b2da42530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1a807d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1a804190>]}
[0m21:07:19.997460 [debug] [MainThread]: Flushing usage events
[0m21:08:57.523251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd47644e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4753d3640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4753d35b0>]}


============================== 21:08:57.526947 | ff788a14-dd20-40bb-9281-ea4ada8a7025 ==============================
[0m21:08:57.526947 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:08:57.527994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:08:57.528853 [info ] [MainThread]: dbt version: 1.5.0
[0m21:08:57.529522 [info ] [MainThread]: python version: 3.10.6
[0m21:08:57.530086 [info ] [MainThread]: python path: /usr/bin/python3
[0m21:08:57.530658 [info ] [MainThread]: os info: Linux-5.19.0-1022-gcp-x86_64-with-glibc2.35
[0m21:08:57.531215 [info ] [MainThread]: Using profiles.yml file at /home/j/.dbt/profiles.yml
[0m21:08:57.531794 [info ] [MainThread]: Using dbt_project.yml file at /home/j/bcsales/dbt/bc_sales/dbt_project.yml
[0m21:08:57.532389 [info ] [MainThread]: Configuration:
[0m21:08:58.534007 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:08:58.557200 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:08:58.558407 [info ] [MainThread]: Required dependencies:
[0m21:08:58.559185 [debug] [MainThread]: Executing "git --help"
[0m21:08:58.562303 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:08:58.562964 [debug] [MainThread]: STDERR: "b''"
[0m21:08:58.563364 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:08:58.564012 [info ] [MainThread]: Connection:
[0m21:08:58.564666 [info ] [MainThread]:   method: service-account-json
[0m21:08:58.565246 [info ] [MainThread]:   database: datatalksclub-375802
[0m21:08:58.565807 [info ] [MainThread]:   schema: bandcamp_sales_schema
[0m21:08:58.566371 [info ] [MainThread]:   location: None
[0m21:08:58.566923 [info ] [MainThread]:   priority: None
[0m21:08:58.567474 [info ] [MainThread]:   timeout_seconds: None
[0m21:08:58.568043 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:08:58.568640 [info ] [MainThread]:   execution_project: datatalksclub-375802
[0m21:08:58.569202 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:08:58.569744 [info ] [MainThread]:   job_retries: 1
[0m21:08:58.570361 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:08:58.570907 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m21:08:58.571462 [info ] [MainThread]:   gcs_bucket: None
[0m21:08:58.572445 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:08:58.572900 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:08:58.573384 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: ''NoneType' object has no attribute 'keys''
[0m21:08:58.573845 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m21:08:58.574418 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:08:58.575000 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  'NoneType' object has no attribute 'keys'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m21:08:58.576058 [debug] [MainThread]: Command `dbt debug` failed at 21:08:58.575878 after 1.06 seconds
[0m21:08:58.576499 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:08:58.576932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd47644e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd463224850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd463224670>]}
[0m21:08:58.577428 [debug] [MainThread]: Flushing usage events
[0m21:09:20.305219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd9a74a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd993cf670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd993cf5e0>]}


============================== 21:09:20.309033 | 84161ba0-04a5-42fc-af6a-2cc5ab60f5a1 ==============================
[0m21:09:20.309033 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:09:20.311061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/j/.dbt', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:09:20.311756 [info ] [MainThread]: dbt version: 1.5.0
[0m21:09:20.312709 [info ] [MainThread]: python version: 3.10.6
[0m21:09:20.313433 [info ] [MainThread]: python path: /usr/bin/python3
[0m21:09:20.314106 [info ] [MainThread]: os info: Linux-5.19.0-1022-gcp-x86_64-with-glibc2.35
[0m21:09:20.314771 [info ] [MainThread]: Using profiles.yml file at /home/j/.dbt/profiles.yml
[0m21:09:20.315431 [info ] [MainThread]: Using dbt_project.yml file at /home/j/bcsales/dbt/bc_sales/dbt_project.yml
[0m21:09:20.316164 [info ] [MainThread]: Configuration:
[0m21:09:21.289973 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:09:21.313591 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:09:21.314708 [info ] [MainThread]: Required dependencies:
[0m21:09:21.315461 [debug] [MainThread]: Executing "git --help"
[0m21:09:21.318641 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:09:21.319238 [debug] [MainThread]: STDERR: "b''"
[0m21:09:21.319615 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:09:21.320262 [info ] [MainThread]: Connection:
[0m21:09:21.320891 [info ] [MainThread]:   method: service-account-json
[0m21:09:21.321461 [info ] [MainThread]:   database: datatalksclub-375802666777
[0m21:09:21.322010 [info ] [MainThread]:   schema: bandcamp_sales_schema
[0m21:09:21.322564 [info ] [MainThread]:   location: None
[0m21:09:21.323106 [info ] [MainThread]:   priority: None
[0m21:09:21.323653 [info ] [MainThread]:   timeout_seconds: None
[0m21:09:21.324235 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:09:21.324790 [info ] [MainThread]:   execution_project: datatalksclub-375802666777
[0m21:09:21.325334 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:09:21.325871 [info ] [MainThread]:   job_retries: 1
[0m21:09:21.326453 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:09:21.327006 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m21:09:21.327553 [info ] [MainThread]:   gcs_bucket: None
[0m21:09:21.328537 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:09:21.328995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:09:21.329476 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: ''NoneType' object has no attribute 'keys''
[0m21:09:21.329962 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m21:09:21.330531 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:09:21.331146 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  'NoneType' object has no attribute 'keys'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m21:09:21.332157 [debug] [MainThread]: Command `dbt debug` failed at 21:09:21.331991 after 1.04 seconds
[0m21:09:21.332602 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:09:21.333021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd9a74a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd875c7bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd875c62f0>]}
[0m21:09:21.333508 [debug] [MainThread]: Flushing usage events
[0m21:18:35.420473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3594e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b345d7640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b345d7610>]}


============================== 21:18:35.424145 | ed1797c7-7480-4473-a8d9-e8a6cab9bec9 ==============================
[0m21:18:35.424145 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:18:35.426127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:18:35.426774 [info ] [MainThread]: dbt version: 1.5.0
[0m21:18:35.427580 [info ] [MainThread]: python version: 3.10.6
[0m21:18:35.428343 [info ] [MainThread]: python path: /usr/bin/python3
[0m21:18:35.429095 [info ] [MainThread]: os info: Linux-5.19.0-1022-gcp-x86_64-with-glibc2.35
[0m21:18:35.429775 [info ] [MainThread]: Using profiles.yml file at /home/j/.dbt/profiles.yml
[0m21:18:35.430465 [info ] [MainThread]: Using dbt_project.yml file at /home/j/bcsales/dbt/bc_sales/dbt_project.yml
[0m21:18:35.431329 [info ] [MainThread]: Configuration:
[0m21:18:36.396377 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:18:36.418373 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:18:36.419255 [info ] [MainThread]: Required dependencies:
[0m21:18:36.419980 [debug] [MainThread]: Executing "git --help"
[0m21:18:36.422880 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:18:36.423404 [debug] [MainThread]: STDERR: "b''"
[0m21:18:36.423740 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:18:36.424755 [info ] [MainThread]: Connection:
[0m21:18:36.425778 [info ] [MainThread]:   method: service-account-json
[0m21:18:36.426730 [info ] [MainThread]:   database: datatalksclub-375802
[0m21:18:36.427701 [info ] [MainThread]:   schema: bandcamp_sales_schema
[0m21:18:36.428457 [info ] [MainThread]:   location: None
[0m21:18:36.429038 [info ] [MainThread]:   priority: None
[0m21:18:36.429582 [info ] [MainThread]:   timeout_seconds: None
[0m21:18:36.430138 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:18:36.430689 [info ] [MainThread]:   execution_project: datatalksclub-375802
[0m21:18:36.431231 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:18:36.431841 [info ] [MainThread]:   job_retries: 1
[0m21:18:36.432400 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:18:36.432962 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m21:18:36.433510 [info ] [MainThread]:   gcs_bucket: None
[0m21:18:36.434426 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:18:36.434845 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:18:36.435306 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: ''NoneType' object has no attribute 'keys''
[0m21:18:36.435907 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m21:18:36.436481 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:18:36.437057 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  'NoneType' object has no attribute 'keys'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m21:18:36.438016 [debug] [MainThread]: Command `dbt debug` failed at 21:18:36.437834 after 1.03 seconds
[0m21:18:36.438428 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:18:36.438842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3594e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b227c8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b227c8670>]}
[0m21:18:36.439306 [debug] [MainThread]: Flushing usage events
[0m21:20:24.956040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff8b64a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff8a5cf640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff8a5cf5b0>]}


============================== 21:20:24.959588 | ccdb21f4-cfe6-49e2-9832-ca2aa58bd43e ==============================
[0m21:20:24.959588 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:20:24.961640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:20:24.962184 [info ] [MainThread]: dbt version: 1.5.0
[0m21:20:24.963149 [info ] [MainThread]: python version: 3.10.6
[0m21:20:24.963872 [info ] [MainThread]: python path: /usr/bin/python3
[0m21:20:24.964562 [info ] [MainThread]: os info: Linux-5.19.0-1022-gcp-x86_64-with-glibc2.35
[0m21:20:24.965196 [info ] [MainThread]: Using profiles.yml file at /home/j/.dbt/profiles.yml
[0m21:20:24.965839 [info ] [MainThread]: Using dbt_project.yml file at /home/j/bcsales/dbt/bc_sales/dbt_project.yml
[0m21:20:24.966478 [info ] [MainThread]: Configuration:
[0m21:20:25.935467 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:20:25.957882 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:20:25.958794 [info ] [MainThread]: Required dependencies:
[0m21:20:25.959501 [debug] [MainThread]: Executing "git --help"
[0m21:20:25.962504 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:20:25.963098 [debug] [MainThread]: STDERR: "b''"
[0m21:20:25.963473 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:20:25.964127 [info ] [MainThread]: Connection:
[0m21:20:25.964846 [info ] [MainThread]:   method: service-account-json
[0m21:20:25.965422 [info ] [MainThread]:   database: datatalksclub-375802
[0m21:20:25.965972 [info ] [MainThread]:   schema: bandcamp_sales_schema
[0m21:20:25.966509 [info ] [MainThread]:   location: us-central1
[0m21:20:25.967054 [info ] [MainThread]:   priority: None
[0m21:20:25.967635 [info ] [MainThread]:   timeout_seconds: None
[0m21:20:25.968237 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:20:25.968791 [info ] [MainThread]:   execution_project: datatalksclub-375802
[0m21:20:25.969333 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:20:25.969865 [info ] [MainThread]:   job_retries: 1
[0m21:20:25.970398 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:20:25.970936 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m21:20:25.971466 [info ] [MainThread]:   gcs_bucket: None
[0m21:20:25.972401 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:20:25.972794 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:20:25.974550 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: ''NoneType' object has no attribute 'keys''
[0m21:20:25.975069 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m21:20:25.975641 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:20:25.976284 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  'NoneType' object has no attribute 'keys'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m21:20:25.977206 [debug] [MainThread]: Command `dbt debug` failed at 21:20:25.977051 after 1.03 seconds
[0m21:20:25.977623 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:20:25.978051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff8b64a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff8a1205e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff8a5cf970>]}
[0m21:20:25.978535 [debug] [MainThread]: Flushing usage events
[0m21:27:38.430205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1bfc4a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1bebcf6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1bebcf670>]}


============================== 21:27:38.434065 | a60c2100-1329-4139-9ea1-4f12c1fab8de ==============================
[0m21:27:38.434065 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:27:38.435087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:27:38.435954 [info ] [MainThread]: dbt version: 1.5.0
[0m21:27:38.436641 [info ] [MainThread]: python version: 3.10.6
[0m21:27:38.437233 [info ] [MainThread]: python path: /usr/bin/python3
[0m21:27:38.437828 [info ] [MainThread]: os info: Linux-5.19.0-1022-gcp-x86_64-with-glibc2.35
[0m21:27:38.438389 [info ] [MainThread]: Using profiles.yml file at /home/j/.dbt/profiles.yml
[0m21:27:38.438969 [info ] [MainThread]: Using dbt_project.yml file at /home/j/bcsales/dbt/bc_sales/dbt_project.yml
[0m21:27:38.439560 [info ] [MainThread]: Configuration:
[0m21:27:39.433943 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:27:39.456090 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:27:39.456985 [info ] [MainThread]: Required dependencies:
[0m21:27:39.457671 [debug] [MainThread]: Executing "git --help"
[0m21:27:39.460615 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:27:39.461148 [debug] [MainThread]: STDERR: "b''"
[0m21:27:39.461512 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:27:39.462389 [info ] [MainThread]: Connection:
[0m21:27:39.463113 [info ] [MainThread]:   method: service-account-json
[0m21:27:39.463858 [info ] [MainThread]:   database: datatalksclub-375802
[0m21:27:39.464787 [info ] [MainThread]:   schema: bandcamp_sales_schema
[0m21:27:39.465473 [info ] [MainThread]:   location: None
[0m21:27:39.466156 [info ] [MainThread]:   priority: None
[0m21:27:39.466813 [info ] [MainThread]:   timeout_seconds: None
[0m21:27:39.467497 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:27:39.468500 [info ] [MainThread]:   execution_project: datatalksclub-375802
[0m21:27:39.469366 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:27:39.470178 [info ] [MainThread]:   job_retries: 1
[0m21:27:39.470868 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:27:39.471516 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m21:27:39.472167 [info ] [MainThread]:   gcs_bucket: None
[0m21:27:39.473137 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:27:39.473584 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:27:39.474054 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: ''NoneType' object has no attribute 'keys''
[0m21:27:39.474539 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m21:27:39.475138 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:27:39.475751 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  'NoneType' object has no attribute 'keys'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m21:27:39.476819 [debug] [MainThread]: Command `dbt debug` failed at 21:27:39.476659 after 1.06 seconds
[0m21:27:39.477252 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:27:39.477674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1bfc4a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1aca762f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1aca77d90>]}
[0m21:27:39.478193 [debug] [MainThread]: Flushing usage events
[0m21:28:52.494556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b9242500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b7ec7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b7ec75e0>]}


============================== 21:28:52.498337 | 8528209d-6485-48a9-b2c7-c3fbf03565f6 ==============================
[0m21:28:52.498337 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:28:52.499405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'debug': 'False', 'profiles_dir': '/home/j/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:28:52.500350 [warn ] [MainThread]: [OpenCommand]: Unable to parse dict {'open_cmd': 'xdg-open', 'profiles_dir': PosixPath('/home/j/.dbt')}
[0m21:28:52.501423 [info ] [MainThread]: To view your profiles.yml file, run:

 
[0m21:28:52.502716 [debug] [MainThread]: Command `dbt debug` succeeded at 21:28:52.502545 after 0.02 seconds
[0m21:28:52.503172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b9242500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b7ec7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b7ec7880>]}
[0m21:28:52.503702 [debug] [MainThread]: Flushing usage events
[0m21:32:49.956889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d04f5e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d03be7640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d03be7610>]}


============================== 21:32:49.962210 | 90578cd4-a93d-44ed-8d6c-3e6543761329 ==============================
[0m21:32:49.962210 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:32:49.964468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:32:49.965150 [info ] [MainThread]: dbt version: 1.5.0
[0m21:32:49.965812 [info ] [MainThread]: python version: 3.10.6
[0m21:32:49.966417 [info ] [MainThread]: python path: /usr/bin/python3
[0m21:32:49.967038 [info ] [MainThread]: os info: Linux-5.19.0-1022-gcp-x86_64-with-glibc2.35
[0m21:32:49.967644 [info ] [MainThread]: Using profiles.yml file at /home/j/.dbt/profiles.yml
[0m21:32:49.968268 [info ] [MainThread]: Using dbt_project.yml file at /home/j/bcsales/dbt/bc_sales/dbt_project.yml
[0m21:32:49.968858 [info ] [MainThread]: Configuration:
[0m21:32:51.083840 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:32:51.106516 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:32:51.107705 [info ] [MainThread]: Required dependencies:
[0m21:32:51.108560 [debug] [MainThread]: Executing "git --help"
[0m21:32:51.112092 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:32:51.112725 [debug] [MainThread]: STDERR: "b''"
[0m21:32:51.113108 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:32:51.113702 [info ] [MainThread]: Connection:
[0m21:32:51.114375 [info ] [MainThread]:   method: service-account-json
[0m21:32:51.114971 [info ] [MainThread]:   database: datatalksclub-375802
[0m21:32:51.115588 [info ] [MainThread]:   schema: bandcamp_sales_schema
[0m21:32:51.116224 [info ] [MainThread]:   location: None
[0m21:32:51.116794 [info ] [MainThread]:   priority: None
[0m21:32:51.117346 [info ] [MainThread]:   timeout_seconds: None
[0m21:32:51.117908 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:32:51.118596 [info ] [MainThread]:   execution_project: datatalksclub-375802
[0m21:32:51.119166 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:32:51.119720 [info ] [MainThread]:   job_retries: 1
[0m21:32:51.120333 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:32:51.120887 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m21:32:51.121436 [info ] [MainThread]:   gcs_bucket: None
[0m21:32:51.122717 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:32:51.123179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:32:51.123682 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: ''NoneType' object has no attribute 'keys''
[0m21:32:51.124258 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m21:32:51.124854 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:32:51.125461 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  'NoneType' object has no attribute 'keys'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m21:32:51.126445 [debug] [MainThread]: Command `dbt debug` failed at 21:32:51.126281 after 1.18 seconds
[0m21:32:51.126880 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:32:51.127319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d04f5e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cf1d5c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cf1d5c670>]}
[0m21:32:51.127859 [debug] [MainThread]: Flushing usage events
[0m21:33:29.015041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41ee5a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41dde3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41dde35e0>]}


============================== 21:33:29.018902 | 53c3789a-8e2a-4387-8e8e-b0ceba6276c7 ==============================
[0m21:33:29.018902 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:33:29.020726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/j/.dbt', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:33:29.021413 [info ] [MainThread]: dbt version: 1.5.0
[0m21:33:29.022054 [info ] [MainThread]: python version: 3.10.6
[0m21:33:29.022619 [info ] [MainThread]: python path: /usr/bin/python3
[0m21:33:29.023203 [info ] [MainThread]: os info: Linux-5.19.0-1022-gcp-x86_64-with-glibc2.35
[0m21:33:29.023832 [info ] [MainThread]: Using profiles.yml file at /home/j/.dbt/profiles.yml
[0m21:33:29.024651 [info ] [MainThread]: Using dbt_project.yml file at /home/j/bcsales/dbt/bc_sales/dbt_project.yml
[0m21:33:29.025399 [info ] [MainThread]: Configuration:
[0m21:33:30.022178 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:33:30.045175 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:33:30.046080 [info ] [MainThread]: Required dependencies:
[0m21:33:30.046789 [debug] [MainThread]: Executing "git --help"
[0m21:33:30.049971 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:33:30.050541 [debug] [MainThread]: STDERR: "b''"
[0m21:33:30.050894 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:33:30.051806 [info ] [MainThread]: Connection:
[0m21:33:30.052595 [info ] [MainThread]:   method: service-account-json
[0m21:33:30.053296 [info ] [MainThread]:   database: datatalksclub-375802
[0m21:33:30.053959 [info ] [MainThread]:   schema: bandcamp_sales_schema
[0m21:33:30.054620 [info ] [MainThread]:   location: None
[0m21:33:30.055355 [info ] [MainThread]:   priority: None
[0m21:33:30.056101 [info ] [MainThread]:   timeout_seconds: None
[0m21:33:30.056727 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:33:30.057285 [info ] [MainThread]:   execution_project: datatalksclub-375802
[0m21:33:30.057836 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:33:30.058379 [info ] [MainThread]:   job_retries: 1
[0m21:33:30.058925 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:33:30.059459 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m21:33:30.060032 [info ] [MainThread]:   gcs_bucket: None
[0m21:33:30.061025 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:33:30.061432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:33:30.061936 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: ''NoneType' object has no attribute 'keys''
[0m21:33:30.062400 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m21:33:30.062959 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:33:30.063538 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  'NoneType' object has no attribute 'keys'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m21:33:30.064541 [debug] [MainThread]: Command `dbt debug` failed at 21:33:30.064383 after 1.06 seconds
[0m21:33:30.064995 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:33:30.065412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41ee5a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40bcd3be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40bcd0940>]}
[0m21:33:30.065919 [debug] [MainThread]: Flushing usage events
[0m21:40:02.319115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71b952440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71a5db550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71a5db520>]}


============================== 21:40:02.322922 | e74a62fd-93b3-4ae1-8f16-fb1d47460729 ==============================
[0m21:40:02.322922 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:40:02.324870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:40:02.325646 [info ] [MainThread]: dbt version: 1.5.0
[0m21:40:02.326343 [info ] [MainThread]: python version: 3.10.6
[0m21:40:02.326928 [info ] [MainThread]: python path: /usr/bin/python3
[0m21:40:02.327540 [info ] [MainThread]: os info: Linux-5.19.0-1022-gcp-x86_64-with-glibc2.35
[0m21:40:02.328228 [info ] [MainThread]: Using profiles.yml file at /home/j/.dbt/profiles.yml
[0m21:40:02.328853 [info ] [MainThread]: Using dbt_project.yml file at /home/j/bcsales/dbt/bc_sales/dbt_project.yml
[0m21:40:02.329429 [info ] [MainThread]: Configuration:
[0m21:40:03.335625 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:40:03.360859 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:40:03.362062 [info ] [MainThread]: Required dependencies:
[0m21:40:03.362867 [debug] [MainThread]: Executing "git --help"
[0m21:40:03.365916 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:40:03.366488 [debug] [MainThread]: STDERR: "b''"
[0m21:40:03.366859 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:40:03.367472 [info ] [MainThread]: Connection:
[0m21:40:03.368143 [info ] [MainThread]:   method: service-account
[0m21:40:03.368752 [info ] [MainThread]:   database: datatalksclub-375802
[0m21:40:03.369327 [info ] [MainThread]:   schema: bandcamp_sales_schema
[0m21:40:03.369899 [info ] [MainThread]:   location: None
[0m21:40:03.370491 [info ] [MainThread]:   priority: None
[0m21:40:03.371051 [info ] [MainThread]:   timeout_seconds: None
[0m21:40:03.371612 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:40:03.372267 [info ] [MainThread]:   execution_project: datatalksclub-375802
[0m21:40:03.372859 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:40:03.373424 [info ] [MainThread]:   job_retries: 1
[0m21:40:03.373975 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:40:03.374547 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m21:40:03.375100 [info ] [MainThread]:   gcs_bucket: None
[0m21:40:03.376082 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:40:03.376513 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:40:03.430848 [debug] [MainThread]: On debug: select 1 as id
[0m21:40:04.374081 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:US:2e760fcd-8836-4522-88c9-d5f6e2dbd200&page=queryresults
[0m21:40:04.374783 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:40:04.375874 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:40:04.377026 [debug] [MainThread]: Command `dbt debug` succeeded at 21:40:04.376808 after 2.07 seconds
[0m21:40:04.377527 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:40:04.377985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71b952440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71b9fca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71a5db520>]}
[0m21:40:04.378505 [debug] [MainThread]: Flushing usage events
[0m21:42:54.872225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf85352530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf83fdb760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf83fdb6d0>]}


============================== 21:42:54.876021 | fc58469b-7973-4aeb-987a-8d23f1ff09b3 ==============================
[0m21:42:54.876021 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:42:54.877100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/j/.dbt', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:42:55.856294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc58469b-7973-4aeb-987a-8d23f1ff09b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf83fdb820>]}
[0m21:42:55.868322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc58469b-7973-4aeb-987a-8d23f1ff09b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf721d2ad0>]}
[0m21:42:55.882043 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m21:42:55.893406 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m21:42:55.894671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fc58469b-7973-4aeb-987a-8d23f1ff09b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf721eb670>]}
[0m21:42:56.802369 [debug] [MainThread]: 1699: static parser successfully parsed stg_country_avg_sales.sql
[0m21:42:56.820717 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales.sql
[0m21:42:56.856907 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bc_sales.stg_country_avg_sales' (models/stg_country_avg_sales.sql) depends on a source named 'staging.bc_sales_clustered' which was not found
[0m21:42:56.858223 [debug] [MainThread]: Command `dbt run` failed at 21:42:56.858020 after 2.00 seconds
[0m21:42:56.858763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf85352530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf71fee710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf71fee7d0>]}
[0m21:42:56.859304 [debug] [MainThread]: Flushing usage events
[0m21:43:37.026222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e2df4a530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e2cbcf7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e2cbcf760>]}


============================== 21:43:37.029869 | 751bf18a-3e78-40c9-8c66-c22681d2f28c ==============================
[0m21:43:37.029869 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:43:37.030875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:43:38.041597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '751bf18a-3e78-40c9-8c66-c22681d2f28c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e2cbcf8b0>]}
[0m21:43:38.053991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '751bf18a-3e78-40c9-8c66-c22681d2f28c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e1ae2a770>]}
[0m21:43:38.067842 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m21:43:38.078095 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m21:43:38.079140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '751bf18a-3e78-40c9-8c66-c22681d2f28c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e1ae3f730>]}
[0m21:43:38.947800 [debug] [MainThread]: 1699: static parser successfully parsed stg_country_avg_sales.sql
[0m21:43:38.965939 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales.sql
[0m21:43:39.001801 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bc_sales.stg_country_avg_sales' (models/stg_country_avg_sales.sql) depends on a source named 'staging.bc_sales_clustered' which was not found
[0m21:43:39.003163 [debug] [MainThread]: Command `dbt build` failed at 21:43:39.002947 after 1.99 seconds
[0m21:43:39.003719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e2df4a530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e1ac467d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e1ac46890>]}
[0m21:43:39.004319 [debug] [MainThread]: Flushing usage events
[0m21:44:15.606083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0be42530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0aac7640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0aac7610>]}


============================== 21:44:15.609793 | f54a5e83-cb68-40bb-8e18-8da782985cb0 ==============================
[0m21:44:15.609793 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:44:15.610781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'debug': 'False', 'profiles_dir': '/home/j/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:44:15.611553 [info ] [MainThread]: dbt version: 1.5.0
[0m21:44:15.612289 [info ] [MainThread]: python version: 3.10.6
[0m21:44:15.612857 [info ] [MainThread]: python path: /usr/bin/python3
[0m21:44:15.613420 [info ] [MainThread]: os info: Linux-5.19.0-1022-gcp-x86_64-with-glibc2.35
[0m21:44:15.614014 [info ] [MainThread]: Using profiles.yml file at /home/j/.dbt/profiles.yml
[0m21:44:15.614565 [info ] [MainThread]: Using dbt_project.yml file at /home/j/bcsales/dbt/bc_sales/dbt_project.yml
[0m21:44:15.615128 [info ] [MainThread]: Configuration:
[0m21:44:16.583262 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:44:16.605734 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:44:16.606615 [info ] [MainThread]: Required dependencies:
[0m21:44:16.607314 [debug] [MainThread]: Executing "git --help"
[0m21:44:16.610307 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:44:16.610866 [debug] [MainThread]: STDERR: "b''"
[0m21:44:16.611210 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:44:16.611813 [info ] [MainThread]: Connection:
[0m21:44:16.612490 [info ] [MainThread]:   method: service-account
[0m21:44:16.613091 [info ] [MainThread]:   database: datatalksclub-375802
[0m21:44:16.613670 [info ] [MainThread]:   schema: bandcamp_sales_schema
[0m21:44:16.614240 [info ] [MainThread]:   location: None
[0m21:44:16.614849 [info ] [MainThread]:   priority: None
[0m21:44:16.615398 [info ] [MainThread]:   timeout_seconds: None
[0m21:44:16.615989 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:44:16.616535 [info ] [MainThread]:   execution_project: datatalksclub-375802
[0m21:44:16.617081 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:44:16.617624 [info ] [MainThread]:   job_retries: 1
[0m21:44:16.618163 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:44:16.618712 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m21:44:16.619247 [info ] [MainThread]:   gcs_bucket: None
[0m21:44:16.620292 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:44:16.620707 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:44:16.671611 [debug] [MainThread]: On debug: select 1 as id
[0m21:44:17.576129 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:US:4f5745f5-831c-4b5b-b264-0957565ba9c8&page=queryresults
[0m21:44:17.576828 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:44:17.577916 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:44:17.579032 [debug] [MainThread]: Command `dbt debug` succeeded at 21:44:17.578873 after 1.98 seconds
[0m21:44:17.579444 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:44:17.579902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0be42530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0b973790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0aac79d0>]}
[0m21:44:17.580397 [debug] [MainThread]: Flushing usage events
[0m21:51:20.516089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f81664d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f6def790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f6def700>]}


============================== 21:51:20.519643 | f63101af-ec1a-491e-9f6a-75a5796dc768 ==============================
[0m21:51:20.519643 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:51:20.520727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:51:21.542004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f63101af-ec1a-491e-9f6a-75a5796dc768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f6def850>]}
[0m21:51:21.554374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f63101af-ec1a-491e-9f6a-75a5796dc768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e4eb7fd0>]}
[0m21:51:21.567227 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m21:51:21.577045 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m21:51:21.578356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f63101af-ec1a-491e-9f6a-75a5796dc768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e4ccf6d0>]}
[0m21:51:22.430435 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_country_avg_sales.sql
[0m21:51:22.449107 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales.sql
[0m21:51:22.485850 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bc_sales.stg_country_avg_sales' (models/staging/stg_country_avg_sales.sql) depends on a source named 'bandcamp_sales_schema.bc_sales_clustered' which was not found
[0m21:51:22.487847 [debug] [MainThread]: Command `dbt build` failed at 21:51:22.487596 after 1.98 seconds
[0m21:51:22.488388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f81664d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e46d2770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e46d2830>]}
[0m21:51:22.488980 [debug] [MainThread]: Flushing usage events
[0m21:51:48.306011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba07772590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba063f7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba063f77c0>]}


============================== 21:51:48.311022 | a352d57d-2cfd-400c-adbf-ca4218f84f10 ==============================
[0m21:51:48.311022 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:51:48.312287 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:51:49.638330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a352d57d-2cfd-400c-adbf-ca4218f84f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba063f7910>]}
[0m21:51:49.650719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a352d57d-2cfd-400c-adbf-ca4218f84f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9f44d42e0>]}
[0m21:51:49.664127 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m21:51:49.673700 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m21:51:49.674659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a352d57d-2cfd-400c-adbf-ca4218f84f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9f4237e80>]}
[0m21:51:50.518887 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_country_avg_sales.sql
[0m21:51:50.537232 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales.sql
[0m21:51:50.574905 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bc_sales.stg_country_avg_sales' (models/staging/stg_country_avg_sales.sql) depends on a source named 'bandcamp_sales_schema.bcsales_clustered' which was not found
[0m21:51:50.576758 [debug] [MainThread]: Command `dbt build` failed at 21:51:50.576539 after 2.29 seconds
[0m21:51:50.577329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba07772590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9f3cf6830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9f3cf68f0>]}
[0m21:51:50.577861 [debug] [MainThread]: Flushing usage events
[0m21:52:22.479183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6785b3e500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67847c77c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67847c7730>]}


============================== 21:52:22.483001 | b6ab462c-e9cb-466a-aab4-e4af9fe7594c ==============================
[0m21:52:22.483001 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:52:22.484584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:52:23.484596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6ab462c-e9cb-466a-aab4-e4af9fe7594c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67847c7880>]}
[0m21:52:23.497058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6ab462c-e9cb-466a-aab4-e4af9fe7594c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67728f8310>]}
[0m21:52:23.510759 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m21:52:23.520369 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m21:52:23.521330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b6ab462c-e9cb-466a-aab4-e4af9fe7594c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67729137f0>]}
[0m21:52:24.373308 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_country_avg_sales.sql
[0m21:52:24.391232 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales.sql
[0m21:52:24.428094 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bc_sales.stg_country_avg_sales' (models/staging/stg_country_avg_sales.sql) depends on a source named 'bandcamp_sales_schema.sales_clustered' which was not found
[0m21:52:24.429422 [debug] [MainThread]: Command `dbt build` failed at 21:52:24.429219 after 1.96 seconds
[0m21:52:24.429951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6785b3e500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f677271a7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f677271a860>]}
[0m21:52:24.430446 [debug] [MainThread]: Flushing usage events
[0m21:59:44.887353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463415a560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4632de3730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4632de3700>]}


============================== 21:59:44.891046 | a60a8d32-7e3e-4778-91bf-018ac9414d5f ==============================
[0m21:59:44.891046 [info ] [MainThread]: Running with dbt=1.5.0
[0m21:59:44.892121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:59:45.895819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a60a8d32-7e3e-4778-91bf-018ac9414d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4632de3850>]}
[0m21:59:45.908114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a60a8d32-7e3e-4778-91bf-018ac9414d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4620ff6ad0>]}
[0m21:59:45.921025 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m21:59:45.930524 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m21:59:45.931455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a60a8d32-7e3e-4778-91bf-018ac9414d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4620e0fb50>]}
[0m21:59:46.763195 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_country_avg_sales.sql
[0m21:59:46.780795 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales.sql
[0m21:59:46.816214 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bc_sales.stg_country_avg_sales' (models/staging/stg_country_avg_sales.sql) depends on a source named 'bandcamp_sales_schema.sales_clustered' which was not found
[0m21:59:46.817591 [debug] [MainThread]: Command `dbt run` failed at 21:59:46.817385 after 1.94 seconds
[0m21:59:46.818128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463415a560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4620812740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4620812800>]}
[0m21:59:46.818611 [debug] [MainThread]: Flushing usage events
[0m22:00:42.404492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3ea056530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e8fdb700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e8fdb6d0>]}


============================== 22:00:42.408203 | b402bc07-ce5e-47a8-9091-4611edbc5f37 ==============================
[0m22:00:42.408203 [info ] [MainThread]: Running with dbt=1.5.0
[0m22:00:42.410225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'profiles_dir': '/home/j/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:00:43.413647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b402bc07-ce5e-47a8-9091-4611edbc5f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e8fdb820>]}
[0m22:00:43.425946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b402bc07-ce5e-47a8-9091-4611edbc5f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3d6ec6aa0>]}
[0m22:00:43.438645 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m22:00:43.448171 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m22:00:43.449158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b402bc07-ce5e-47a8-9091-4611edbc5f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3d6edf640>]}
[0m22:00:44.311515 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_country_avg_sales.sql
[0m22:00:44.330494 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales.sql
[0m22:00:44.366776 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bc_sales.stg_sales' (models/staging/stg_sales.sql) depends on a source named 'staging.bc_sales_ext' which was not found
[0m22:00:44.368183 [debug] [MainThread]: Command `dbt run` failed at 22:00:44.367972 after 1.97 seconds
[0m22:00:44.368747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3ea056530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3d6cda710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3d6cda7d0>]}
[0m22:00:44.369258 [debug] [MainThread]: Flushing usage events
[0m22:01:36.238776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe273452560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2723db790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2723db700>]}


============================== 22:01:36.242429 | 5ea9764f-9a61-4ab2-8e9b-89f87f59491b ==============================
[0m22:01:36.242429 [info ] [MainThread]: Running with dbt=1.5.0
[0m22:01:36.243440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:01:37.231389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ea9764f-9a61-4ab2-8e9b-89f87f59491b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2723db850>]}
[0m22:01:37.243829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ea9764f-9a61-4ab2-8e9b-89f87f59491b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2602e27a0>]}
[0m22:01:37.256938 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m22:01:37.266516 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m22:01:37.267478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ea9764f-9a61-4ab2-8e9b-89f87f59491b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2602eab00>]}
[0m22:01:38.115300 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_country_avg_sales.sql
[0m22:01:38.133478 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales.sql
[0m22:01:38.169430 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bc_sales.stg_country_avg_sales' (models/staging/stg_country_avg_sales.sql) depends on a source named 'bandcamp_sales_schema.sales_clustered' which was not found
[0m22:01:38.171401 [debug] [MainThread]: Command `dbt run` failed at 22:01:38.171176 after 1.94 seconds
[0m22:01:38.172012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe273452560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2600e6740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2600e6800>]}
[0m22:01:38.172628 [debug] [MainThread]: Flushing usage events
[0m22:04:03.612237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77bfe4a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77bedcf5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77bedcf5b0>]}


============================== 22:04:03.615986 | 96580993-031d-454f-ad41-b39a59990470 ==============================
[0m22:04:03.615986 [info ] [MainThread]: Running with dbt=1.5.0
[0m22:04:03.617033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/j/.dbt', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:04:03.617629 [info ] [MainThread]: Setting up your profile.
[0m22:04:09.698614 [debug] [MainThread]: Command `dbt init` succeeded at 22:04:09.698196 after 6.10 seconds
[0m22:04:09.699417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77bfe4a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77bedcebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77bedcf610>]}
[0m22:04:09.700116 [debug] [MainThread]: Flushing usage events
[0m22:12:39.845349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a19e4a530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a18dd3700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a18dd36d0>]}


============================== 22:12:39.849229 | 178ad26c-80b8-46d6-9f99-e09be14e3051 ==============================
[0m22:12:39.849229 [info ] [MainThread]: Running with dbt=1.5.0
[0m22:12:39.850531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:12:40.868818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '178ad26c-80b8-46d6-9f99-e09be14e3051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a18dd3820>]}
[0m22:12:40.881070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '178ad26c-80b8-46d6-9f99-e09be14e3051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a06c2eb60>]}
[0m22:12:40.894972 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m22:12:40.904910 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m22:12:40.905946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '178ad26c-80b8-46d6-9f99-e09be14e3051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a06c47640>]}
[0m22:12:41.781846 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_country_avg_sales.sql
[0m22:12:41.799675 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales.sql
[0m22:12:41.865045 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m22:12:41.872592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '178ad26c-80b8-46d6-9f99-e09be14e3051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0699b1c0>]}
[0m22:12:41.884327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '178ad26c-80b8-46d6-9f99-e09be14e3051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a06c45060>]}
[0m22:12:41.885169 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 353 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m22:12:41.885986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '178ad26c-80b8-46d6-9f99-e09be14e3051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a06c476d0>]}
[0m22:12:41.888000 [info ] [MainThread]: 
[0m22:12:41.889244 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:12:41.890865 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m22:12:41.891490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:12:42.239046 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m22:12:42.239924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:12:42.586052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '178ad26c-80b8-46d6-9f99-e09be14e3051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0699a8c0>]}
[0m22:12:42.587246 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:12:42.588318 [info ] [MainThread]: 
[0m22:12:42.597636 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_country_avg_sales
[0m22:12:42.598639 [info ] [Thread-1 (]: 1 of 2 START sql view model bandcamp_sales_schema.stg_country_avg_sales ........ [RUN]
[0m22:12:42.600274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.stg_country_avg_sales)
[0m22:12:42.600951 [debug] [Thread-2 (]: Began running node model.bc_sales.stg_sales
[0m22:12:42.602291 [info ] [Thread-2 (]: 2 of 2 START sql view model bandcamp_sales_schema.stg_sales .................... [RUN]
[0m22:12:42.601593 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_country_avg_sales
[0m22:12:42.603502 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now model.bc_sales.stg_sales)
[0m22:12:42.608294 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_country_avg_sales"
[0m22:12:42.609938 [debug] [Thread-2 (]: Began compiling node model.bc_sales.stg_sales
[0m22:12:42.614494 [debug] [Thread-2 (]: Writing injected SQL for node "model.bc_sales.stg_sales"
[0m22:12:42.615726 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_avg_sales (compile): 22:12:42.603948 => 22:12:42.615313
[0m22:12:42.616519 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_country_avg_sales
[0m22:12:42.617246 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_sales (compile): 22:12:42.610673 => 22:12:42.616933
[0m22:12:42.639388 [debug] [Thread-2 (]: Began executing node model.bc_sales.stg_sales
[0m22:12:42.666306 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_country_avg_sales"
[0m22:12:42.673206 [debug] [Thread-2 (]: Writing runtime sql for node "model.bc_sales.stg_sales"
[0m22:12:42.674682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:42.675498 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:12:42.769470 [debug] [Thread-2 (]: On model.bc_sales.stg_sales: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales`
  OPTIONS()
  as 

select * from bandcamp_sales_schema.bc_sales_ext
limit 1000;


[0m22:12:42.771532 [debug] [Thread-1 (]: On model.bc_sales.stg_country_avg_sales: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_country_avg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_avg_sales`
  OPTIONS()
  as 

select
  cast(cc_ref as integer) as cc_ref,
  cast(amount_paid_usd as numeric) as amount_paid_usd,

  cast(country_code as string) as country_code,
  cast(country as string) as country

from bandcamp_sales_schema.sales_clustered
limit 1000;


[0m22:12:44.013253 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:95c3d0c8-9544-4a9a-be4a-b6b36bd9d373&page=queryresults
[0m22:12:44.035132 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_avg_sales (execute): 22:12:42.617641 => 22:12:44.034781
[0m22:12:44.036554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '178ad26c-80b8-46d6-9f99-e09be14e3051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a069f6620>]}
[0m22:12:44.037710 [info ] [Thread-1 (]: 1 of 2 OK created sql view model bandcamp_sales_schema.stg_country_avg_sales ... [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m22:12:44.039392 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_country_avg_sales
[0m22:12:44.055196 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:89d4e5c9-68c7-42d9-a3f2-a224e16e1805&page=queryresults
[0m22:12:44.058948 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_sales (execute): 22:12:42.650333 => 22:12:44.058600
[0m22:12:44.060476 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '178ad26c-80b8-46d6-9f99-e09be14e3051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a069f6620>]}
[0m22:12:44.061646 [info ] [Thread-2 (]: 2 of 2 OK created sql view model bandcamp_sales_schema.stg_sales ............... [[32mCREATE VIEW (0 processed)[0m in 1.46s]
[0m22:12:44.063208 [debug] [Thread-2 (]: Finished running node model.bc_sales.stg_sales
[0m22:12:44.066180 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:12:44.066668 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales' was properly closed.
[0m22:12:44.067027 [debug] [MainThread]: Connection 'model.bc_sales.stg_country_avg_sales' was properly closed.
[0m22:12:44.067484 [info ] [MainThread]: 
[0m22:12:44.068227 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.18 seconds (2.18s).
[0m22:12:44.069631 [debug] [MainThread]: Command end result
[0m22:12:44.080891 [info ] [MainThread]: 
[0m22:12:44.082039 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:12:44.082824 [info ] [MainThread]: 
[0m22:12:44.083526 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:12:44.084739 [debug] [MainThread]: Command `dbt run` succeeded at 22:12:44.084564 after 4.25 seconds
[0m22:12:44.085288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a19e4a530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a06a48490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a199794b0>]}
[0m22:12:44.085898 [debug] [MainThread]: Flushing usage events
[0m22:20:23.256105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7740a6a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773f9ef760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773f9ef730>]}


============================== 22:20:23.259993 | 55cdb0b4-ec85-4a17-a9e0-de538acdf8a4 ==============================
[0m22:20:23.259993 [info ] [MainThread]: Running with dbt=1.5.0
[0m22:20:23.261254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:20:24.280510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55cdb0b4-ec85-4a17-a9e0-de538acdf8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773f9ef880>]}
[0m22:20:24.293052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55cdb0b4-ec85-4a17-a9e0-de538acdf8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772d7c8310>]}
[0m22:20:24.306411 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m22:20:24.336112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:20:24.337030 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/staging/stg_country_avg_sales.sql
[0m22:20:24.357424 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_country_avg_sales.sql
[0m22:20:24.380679 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m22:20:24.388607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55cdb0b4-ec85-4a17-a9e0-de538acdf8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772d5ead70>]}
[0m22:20:24.398011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55cdb0b4-ec85-4a17-a9e0-de538acdf8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772d54beb0>]}
[0m22:20:24.398787 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 353 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m22:20:24.399571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55cdb0b4-ec85-4a17-a9e0-de538acdf8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772d54bee0>]}
[0m22:20:24.401587 [info ] [MainThread]: 
[0m22:20:24.402851 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:20:24.404528 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m22:20:24.405137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:20:24.772222 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m22:20:24.773040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:20:25.075545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55cdb0b4-ec85-4a17-a9e0-de538acdf8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772d549e40>]}
[0m22:20:25.076809 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:20:25.077582 [info ] [MainThread]: 
[0m22:20:25.083365 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_country_avg_sales
[0m22:20:25.084167 [debug] [Thread-2 (]: Began running node model.bc_sales.stg_sales
[0m22:20:25.085998 [info ] [Thread-2 (]: 2 of 2 START sql view model bandcamp_sales_schema.stg_sales .................... [RUN]
[0m22:20:25.084960 [info ] [Thread-1 (]: 1 of 2 START sql view model bandcamp_sales_schema.stg_country_avg_sales ........ [RUN]
[0m22:20:25.087514 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales'
[0m22:20:25.088513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.stg_country_avg_sales)
[0m22:20:25.089236 [debug] [Thread-2 (]: Began compiling node model.bc_sales.stg_sales
[0m22:20:25.089818 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_country_avg_sales
[0m22:20:25.093968 [debug] [Thread-2 (]: Writing injected SQL for node "model.bc_sales.stg_sales"
[0m22:20:25.098406 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_country_avg_sales"
[0m22:20:25.099721 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_sales (compile): 22:20:25.090205 => 22:20:25.099358
[0m22:20:25.100567 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_avg_sales (compile): 22:20:25.094536 => 22:20:25.100197
[0m22:20:25.101103 [debug] [Thread-2 (]: Began executing node model.bc_sales.stg_sales
[0m22:20:25.101695 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_country_avg_sales
[0m22:20:25.149166 [debug] [Thread-2 (]: Writing runtime sql for node "model.bc_sales.stg_sales"
[0m22:20:25.156734 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_country_avg_sales"
[0m22:20:25.157873 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:20:25.158755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:25.252370 [debug] [Thread-2 (]: On model.bc_sales.stg_sales: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales`
  OPTIONS()
  as 

select * from bandcamp_sales_schema.bc_sales_ext
limit 1000;


[0m22:20:25.253246 [debug] [Thread-1 (]: On model.bc_sales.stg_country_avg_sales: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_country_avg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_avg_sales`
  OPTIONS()
  as 

select
  cast(cc_ref as integer) as cc_ref,
  cast(amount_paid_usd as numeric) as amount_paid_usd,

  cast(country_code as string) as country_code,
  cast(country as string) as country

from `$GCP_PROJECT`.`bandcamp_sales_schema`.`sales_clustered`
limit 1000;


[0m22:20:25.714662 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid project ID '$GCP_PROJECT'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.")
[0m22:20:26.130997 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:e163c3b6-fe15-478e-9b7a-5c98313ace8b&page=queryresults
[0m22:20:26.157721 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_sales (execute): 22:20:25.102098 => 22:20:26.157427
[0m22:20:26.159152 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55cdb0b4-ec85-4a17-a9e0-de538acdf8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772d7ca4a0>]}
[0m22:20:26.160178 [info ] [Thread-2 (]: 2 of 2 OK created sql view model bandcamp_sales_schema.stg_sales ............... [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m22:20:26.161388 [debug] [Thread-2 (]: Finished running node model.bc_sales.stg_sales
[0m22:20:26.417432 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:014d0d80-08dc-439b-8922-73f12b9d031c&page=queryresults
[0m22:20:26.419134 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_avg_sales (execute): 22:20:25.123102 => 22:20:26.418779
[0m22:20:26.425713 [debug] [Thread-1 (]: Database Error in model stg_country_avg_sales (models/staging/stg_country_avg_sales.sql)
  Invalid project ID '$GCP_PROJECT'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled Code at target/run/bc_sales/models/staging/stg_country_avg_sales.sql
[0m22:20:26.426518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55cdb0b4-ec85-4a17-a9e0-de538acdf8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772d083b80>]}
[0m22:20:26.427430 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model bandcamp_sales_schema.stg_country_avg_sales  [[31mERROR[0m in 1.34s]
[0m22:20:26.428463 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_country_avg_sales
[0m22:20:26.430951 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:20:26.431406 [debug] [MainThread]: Connection 'model.bc_sales.stg_country_avg_sales' was properly closed.
[0m22:20:26.431822 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales' was properly closed.
[0m22:20:26.432274 [info ] [MainThread]: 
[0m22:20:26.433180 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m22:20:26.434422 [debug] [MainThread]: Command end result
[0m22:20:26.443345 [info ] [MainThread]: 
[0m22:20:26.444391 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:20:26.445061 [info ] [MainThread]: 
[0m22:20:26.445754 [error] [MainThread]: [33mDatabase Error in model stg_country_avg_sales (models/staging/stg_country_avg_sales.sql)[0m
[0m22:20:26.446395 [error] [MainThread]:   Invalid project ID '$GCP_PROJECT'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
[0m22:20:26.446991 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/staging/stg_country_avg_sales.sql
[0m22:20:26.447802 [info ] [MainThread]: 
[0m22:20:26.448543 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:20:26.449605 [debug] [MainThread]: Command `dbt run` failed at 22:20:26.449424 after 3.20 seconds
[0m22:20:26.450107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7740a6a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772d06baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772d591660>]}
[0m22:20:26.450622 [debug] [MainThread]: Flushing usage events
[0m22:26:20.930855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8682d52560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86819db730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86819db700>]}


============================== 22:26:20.934703 | 44c5c8f1-2970-4a16-83c4-ef9f9a1900c6 ==============================
[0m22:26:20.934703 [info ] [MainThread]: Running with dbt=1.5.0
[0m22:26:20.935733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:26:21.949979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44c5c8f1-2970-4a16-83c4-ef9f9a1900c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86819db850>]}
[0m22:26:21.962924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44c5c8f1-2970-4a16-83c4-ef9f9a1900c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f866fb46b30>]}
[0m22:26:21.977469 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m22:26:22.016639 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:26:22.017688 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/staging/schema.yml
[0m22:26:22.038610 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_country_avg_sales.sql
[0m22:26:22.065042 [error] [MainThread]: Encountered an error:
Parsing Error
  Failed to render models/staging/schema.yml from project bc_sales: Parsing Error
    Env var required but not provided: '$GCP_PROJECT'
[0m22:26:22.066382 [debug] [MainThread]: Command `dbt run` failed at 22:26:22.066173 after 1.15 seconds
[0m22:26:22.066937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8682d52560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f866f95ace0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f866f95bbe0>]}
[0m22:26:22.067457 [debug] [MainThread]: Flushing usage events
[0m22:26:50.341519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa33ad3e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3399c7700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3399c76d0>]}


============================== 22:26:50.345547 | e428cc13-7ebb-45a7-89f6-3d2cde284318 ==============================
[0m22:26:50.345547 [info ] [MainThread]: Running with dbt=1.5.0
[0m22:26:50.348294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:26:51.379363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e428cc13-7ebb-45a7-89f6-3d2cde284318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3399c7820>]}
[0m22:26:51.391967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e428cc13-7ebb-45a7-89f6-3d2cde284318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa327b2a8c0>]}
[0m22:26:51.405137 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m22:26:51.435238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:26:51.436494 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/staging/schema.yml
[0m22:26:51.457365 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_country_avg_sales.sql
[0m22:26:51.501321 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m22:26:51.509197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e428cc13-7ebb-45a7-89f6-3d2cde284318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3279553c0>]}
[0m22:26:51.519202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e428cc13-7ebb-45a7-89f6-3d2cde284318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3278a71c0>]}
[0m22:26:51.520091 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 353 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m22:26:51.520940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e428cc13-7ebb-45a7-89f6-3d2cde284318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3278a7370>]}
[0m22:26:51.522974 [info ] [MainThread]: 
[0m22:26:51.524334 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:26:51.526060 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m22:26:51.526731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:51.881990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m22:26:51.882866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:26:52.187257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e428cc13-7ebb-45a7-89f6-3d2cde284318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3278a66e0>]}
[0m22:26:52.188856 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:26:52.189779 [info ] [MainThread]: 
[0m22:26:52.195314 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_country_avg_sales
[0m22:26:52.196393 [debug] [Thread-2 (]: Began running node model.bc_sales.stg_sales
[0m22:26:52.198995 [info ] [Thread-2 (]: 2 of 2 START sql view model bandcamp_sales_schema.stg_sales .................... [RUN]
[0m22:26:52.197626 [info ] [Thread-1 (]: 1 of 2 START sql view model bandcamp_sales_schema.stg_country_avg_sales ........ [RUN]
[0m22:26:52.200548 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales'
[0m22:26:52.201648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.stg_country_avg_sales)
[0m22:26:52.202409 [debug] [Thread-2 (]: Began compiling node model.bc_sales.stg_sales
[0m22:26:52.203000 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_country_avg_sales
[0m22:26:52.210996 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_country_avg_sales"
[0m22:26:52.220177 [debug] [Thread-2 (]: Writing injected SQL for node "model.bc_sales.stg_sales"
[0m22:26:52.221542 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_avg_sales (compile): 22:26:52.206081 => 22:26:52.221083
[0m22:26:52.222365 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_country_avg_sales
[0m22:26:52.228511 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_sales (compile): 22:26:52.203417 => 22:26:52.228027
[0m22:26:52.229324 [debug] [Thread-2 (]: Began executing node model.bc_sales.stg_sales
[0m22:26:52.294724 [debug] [Thread-2 (]: Writing runtime sql for node "model.bc_sales.stg_sales"
[0m22:26:52.296642 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_country_avg_sales"
[0m22:26:52.298039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:52.298823 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:26:52.393100 [debug] [Thread-2 (]: On model.bc_sales.stg_sales: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales`
  OPTIONS()
  as 

select * from bandcamp_sales_schema.bc_sales_ext
limit 1000;


[0m22:26:52.395160 [debug] [Thread-1 (]: On model.bc_sales.stg_country_avg_sales: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_country_avg_sales"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_avg_sales`
  OPTIONS()
  as 

select
  cast(cc_ref as integer) as cc_ref,
  cast(amount_paid_usd as numeric) as amount_paid_usd,

  cast(country_code as string) as country_code,
  cast(country as string) as country

from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_clustered`
limit 1000;


[0m22:26:53.457110 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:90811479-fb64-4dbc-90ce-b71308c8300b&page=queryresults
[0m22:26:53.483581 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_avg_sales (execute): 22:26:52.222820 => 22:26:53.483226
[0m22:26:53.485244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e428cc13-7ebb-45a7-89f6-3d2cde284318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa327b32560>]}
[0m22:26:53.487525 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:41e09d6e-81f0-45f6-8f69-064c022134db&page=queryresults
[0m22:26:53.488885 [info ] [Thread-1 (]: 1 of 2 OK created sql view model bandcamp_sales_schema.stg_country_avg_sales ... [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m22:26:53.493568 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_sales (execute): 22:26:52.245428 => 22:26:53.493232
[0m22:26:53.494734 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_country_avg_sales
[0m22:26:53.496292 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e428cc13-7ebb-45a7-89f6-3d2cde284318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa32740f520>]}
[0m22:26:53.497877 [info ] [Thread-2 (]: 2 of 2 OK created sql view model bandcamp_sales_schema.stg_sales ............... [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m22:26:53.499160 [debug] [Thread-2 (]: Finished running node model.bc_sales.stg_sales
[0m22:26:53.502184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:26:53.502729 [debug] [MainThread]: Connection 'model.bc_sales.stg_country_avg_sales' was properly closed.
[0m22:26:53.503086 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales' was properly closed.
[0m22:26:53.503565 [info ] [MainThread]: 
[0m22:26:53.504426 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.98 seconds (1.98s).
[0m22:26:53.505856 [debug] [MainThread]: Command end result
[0m22:26:53.516816 [info ] [MainThread]: 
[0m22:26:53.518034 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:26:53.518836 [info ] [MainThread]: 
[0m22:26:53.519651 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:26:53.520913 [debug] [MainThread]: Command `dbt run` succeeded at 22:26:53.520719 after 3.19 seconds
[0m22:26:53.521450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa33ad3e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3278d36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa33a86d4b0>]}
[0m22:26:53.522052 [debug] [MainThread]: Flushing usage events
[0m05:00:14.536279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb744a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb63d3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb63d35e0>]}


============================== 05:00:14.541361 | cdf5e609-756e-4c70-8066-5019f265e255 ==============================
[0m05:00:14.541361 [info ] [MainThread]: Running with dbt=1.5.0
[0m05:00:14.542536 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/j/.dbt', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m05:00:14.543248 [info ] [MainThread]: dbt version: 1.5.0
[0m05:00:14.543912 [info ] [MainThread]: python version: 3.10.6
[0m05:00:14.544534 [info ] [MainThread]: python path: /usr/bin/python3
[0m05:00:14.545144 [info ] [MainThread]: os info: Linux-5.19.0-1022-gcp-x86_64-with-glibc2.35
[0m05:00:14.545792 [info ] [MainThread]: Using profiles.yml file at /home/j/.dbt/profiles.yml
[0m05:00:14.546355 [info ] [MainThread]: Using dbt_project.yml file at /home/j/bcsales/dbt/bc_sales/dbt_project.yml
[0m05:00:14.546922 [info ] [MainThread]: Configuration:
[0m05:00:15.935620 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:00:15.960210 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:00:15.961103 [info ] [MainThread]: Required dependencies:
[0m05:00:15.961994 [debug] [MainThread]: Executing "git --help"
[0m05:00:15.968178 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:00:15.968865 [debug] [MainThread]: STDERR: "b''"
[0m05:00:15.969269 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:00:15.970233 [info ] [MainThread]: Connection:
[0m05:00:15.970967 [info ] [MainThread]:   method: service-account
[0m05:00:15.971656 [info ] [MainThread]:   database: datatalksclub-375802
[0m05:00:15.972429 [info ] [MainThread]:   schema: bandcamp_sales_schema
[0m05:00:15.973072 [info ] [MainThread]:   location: None
[0m05:00:15.973803 [info ] [MainThread]:   priority: None
[0m05:00:15.974460 [info ] [MainThread]:   timeout_seconds: None
[0m05:00:15.975095 [info ] [MainThread]:   maximum_bytes_billed: None
[0m05:00:15.975749 [info ] [MainThread]:   execution_project: datatalksclub-375802
[0m05:00:15.976485 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m05:00:15.977137 [info ] [MainThread]:   job_retries: 1
[0m05:00:15.977784 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m05:00:15.978436 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m05:00:15.979073 [info ] [MainThread]:   gcs_bucket: None
[0m05:00:15.980294 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m05:00:15.980841 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:00:16.034810 [debug] [MainThread]: On debug: select 1 as id
[0m05:00:17.018028 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:US:2335c9bd-b805-4a92-b5b3-4ddbd3f67ac3&page=queryresults
[0m05:00:17.018983 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m05:00:17.020400 [info ] [MainThread]: [32mAll checks passed![0m
[0m05:00:17.021643 [debug] [MainThread]: Command `dbt debug` succeeded at 05:00:17.021428 after 2.50 seconds
[0m05:00:17.022206 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:00:17.022704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb744a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb73fff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb6fcd5a0>]}
[0m05:00:17.023286 [debug] [MainThread]: Flushing usage events
[0m05:00:24.640203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0741a4a4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07409d3700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07409d36d0>]}


============================== 05:00:24.643676 | 2e6d1335-7e6d-4ec5-b27d-19678d546a96 ==============================
[0m05:00:24.643676 [info ] [MainThread]: Running with dbt=1.5.0
[0m05:00:24.645663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m05:00:25.635472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e6d1335-7e6d-4ec5-b27d-19678d546a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07409d3820>]}
[0m05:00:25.647851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e6d1335-7e6d-4ec5-b27d-19678d546a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f072e8beb60>]}
[0m05:00:25.660852 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m05:00:25.697519 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 5 files added, 0 files changed.
[0m05:00:25.698370 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/core/schema.yml
[0m05:00:25.698883 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/staging/stg_country_code_ref.sql
[0m05:00:25.699301 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/staging/stg_higher_activity_countries.sql
[0m05:00:25.699722 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/core/country_highest_average.sql
[0m05:00:25.700280 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/staging/stg_sales_by_country.sql
[0m05:00:25.700660 [debug] [MainThread]: Partial parsing: deleted file: bc_sales://models/staging/stg_country_avg_sales.sql
[0m05:00:25.701003 [debug] [MainThread]: Partial parsing: deleted file: bc_sales://models/staging/stg_sales.sql
[0m05:00:25.721974 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_country_code_ref.sql
[0m05:00:25.740223 [debug] [MainThread]: 1603: static parser failed on staging/stg_higher_activity_countries.sql
[0m05:00:25.744028 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_higher_activity_countries (models/staging/stg_higher_activity_countries.sql)
  unexpected '}', expected ')'
    line 7
      from {{ source('staging', 'country_code_ref' }}
[0m05:00:25.745365 [debug] [MainThread]: Command `dbt build` failed at 05:00:25.745137 after 1.11 seconds
[0m05:00:25.745889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0741a4a4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f072e6acd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f072e6acc10>]}
[0m05:00:25.746388 [debug] [MainThread]: Flushing usage events
[0m05:01:20.399340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff1424a560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff131cf820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff131cf790>]}


============================== 05:01:20.403226 | 877e2593-7ff0-4a40-af7d-901b8461f4a8 ==============================
[0m05:01:20.403226 [info ] [MainThread]: Running with dbt=1.5.0
[0m05:01:20.404314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m05:01:21.433920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '877e2593-7ff0-4a40-af7d-901b8461f4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff131cf8e0>]}
[0m05:01:21.447166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '877e2593-7ff0-4a40-af7d-901b8461f4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff010cace0>]}
[0m05:01:21.461228 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m05:01:21.492703 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 5 files added, 0 files changed.
[0m05:01:21.493563 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/staging/stg_sales_by_country.sql
[0m05:01:21.494110 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/core/schema.yml
[0m05:01:21.494556 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/staging/stg_higher_activity_countries.sql
[0m05:01:21.494955 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/staging/stg_country_code_ref.sql
[0m05:01:21.495360 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/core/country_highest_average.sql
[0m05:01:21.495973 [debug] [MainThread]: Partial parsing: deleted file: bc_sales://models/staging/stg_country_avg_sales.sql
[0m05:01:21.496354 [debug] [MainThread]: Partial parsing: deleted file: bc_sales://models/staging/stg_sales.sql
[0m05:01:21.516810 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_by_country.sql
[0m05:01:21.534540 [debug] [MainThread]: 1603: static parser failed on staging/stg_higher_activity_countries.sql
[0m05:01:21.542454 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_higher_activity_countries.sql
[0m05:01:21.544960 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_country_code_ref.sql
[0m05:01:21.550010 [debug] [MainThread]: 1699: static parser successfully parsed core/country_highest_average.sql
[0m05:01:21.566084 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'country_top_spending' in the 'models' section of file 'models/core/schema.yml'
[0m05:01:21.568203 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'top_selling_artist_by_transactions_total_by_country' in the 'models' section of file 'models/core/schema.yml'
[0m05:01:21.570006 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'top_seller_by_usd_by_country' in the 'models' section of file 'models/core/schema.yml'
[0m05:01:21.571141 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bc_sales.stg_higher_activity_countries' (models/staging/stg_higher_activity_countries.sql) depends on a source named 'staging.country_code_ref' which was not found
[0m05:01:21.572316 [debug] [MainThread]: Command `dbt build` failed at 05:01:21.572117 after 1.18 seconds
[0m05:01:21.572880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff1424a560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff00e75060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff00e77a60>]}
[0m05:01:21.573427 [debug] [MainThread]: Flushing usage events
[0m05:03:31.132544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40ce75a560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40cd3df820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40cd3df790>]}


============================== 05:03:31.136265 | c17c82e2-768c-4a60-9257-d05aa34810ee ==============================
[0m05:03:31.136265 [info ] [MainThread]: Running with dbt=1.5.0
[0m05:03:31.138181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/j/.dbt', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m05:03:32.159305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c17c82e2-768c-4a60-9257-d05aa34810ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40cd3df8e0>]}
[0m05:03:32.171614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c17c82e2-768c-4a60-9257-d05aa34810ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40bb5e6bc0>]}
[0m05:03:32.184533 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m05:03:32.215314 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 5 files added, 0 files changed.
[0m05:03:32.216228 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/core/schema.yml
[0m05:03:32.216796 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/core/country_facts.sql
[0m05:03:32.217246 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/staging/stg_sales_by_country.sql
[0m05:03:32.217647 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/staging/stg_country_code_ref.sql
[0m05:03:32.218038 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/staging/stg_higher_activity_countries.sql
[0m05:03:32.218414 [debug] [MainThread]: Partial parsing: deleted file: bc_sales://models/staging/stg_sales.sql
[0m05:03:32.218765 [debug] [MainThread]: Partial parsing: deleted file: bc_sales://models/staging/stg_country_avg_sales.sql
[0m05:03:32.240320 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m05:03:32.259010 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_by_country.sql
[0m05:03:32.263594 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_country_code_ref.sql
[0m05:03:32.268004 [debug] [MainThread]: 1603: static parser failed on staging/stg_higher_activity_countries.sql
[0m05:03:32.275437 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_higher_activity_countries.sql
[0m05:03:32.289101 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bc_sales.stg_country_code_ref' (models/staging/stg_country_code_ref.sql) depends on a source named 'staging.country_code_ref' which was not found
[0m05:03:32.291040 [debug] [MainThread]: Command `dbt build` failed at 05:03:32.290838 after 1.17 seconds
[0m05:03:32.291554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40ce75a560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40bb399060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40bb39ba00>]}
[0m05:03:32.292141 [debug] [MainThread]: Flushing usage events
[0m05:04:35.190072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a1f52560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a0bd77c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a0bd7790>]}


============================== 05:04:35.194176 | c9bcc570-ad24-40b1-85a2-4908e19f66f2 ==============================
[0m05:04:35.194176 [info ] [MainThread]: Running with dbt=1.5.0
[0m05:04:35.196769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'fail_fast': 'False', 'profiles_dir': '/home/j/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m05:04:36.191916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9bcc570-ad24-40b1-85a2-4908e19f66f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a0bd78e0>]}
[0m05:04:36.204747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9bcc570-ad24-40b1-85a2-4908e19f66f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78ee0ec50>]}
[0m05:04:36.217887 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m05:04:36.251697 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 5 files added, 1 files changed.
[0m05:04:36.252594 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/staging/stg_country_code_ref.sql
[0m05:04:36.253101 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/core/country_facts.sql
[0m05:04:36.253506 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/staging/stg_sales_by_country.sql
[0m05:04:36.253955 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/core/schema.yml
[0m05:04:36.254365 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/staging/stg_higher_activity_countries.sql
[0m05:04:36.254932 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/staging/schema.yml
[0m05:04:36.255297 [debug] [MainThread]: Partial parsing: deleted file: bc_sales://models/staging/stg_country_avg_sales.sql
[0m05:04:36.255625 [debug] [MainThread]: Partial parsing: deleted file: bc_sales://models/staging/stg_sales.sql
[0m05:04:36.276197 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_country_code_ref.sql
[0m05:04:36.294007 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m05:04:36.298609 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_by_country.sql
[0m05:04:36.303729 [debug] [MainThread]: 1603: static parser failed on staging/stg_higher_activity_countries.sql
[0m05:04:36.311856 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_higher_activity_countries.sql
[0m05:04:36.345690 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m05:04:36.353161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9bcc570-ad24-40b1-85a2-4908e19f66f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78e6700d0>]}
[0m05:04:36.367136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9bcc570-ad24-40b1-85a2-4908e19f66f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78ebbafe0>]}
[0m05:04:36.368009 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 353 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m05:04:36.370433 [info ] [MainThread]: 
[0m05:04:36.371693 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m05:04:36.373591 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m05:04:36.374208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:04:36.754171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m05:04:36.754942 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:04:37.075181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9bcc570-ad24-40b1-85a2-4908e19f66f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78eb929e0>]}
[0m05:04:37.076606 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:04:37.077450 [info ] [MainThread]: 
[0m05:04:37.084156 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_country_code_ref
[0m05:04:37.085005 [info ] [Thread-1 (]: 1 of 4 START sql view model bandcamp_sales_schema.stg_country_code_ref ......... [RUN]
[0m05:04:37.086231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.stg_country_code_ref)
[0m05:04:37.086941 [debug] [Thread-2 (]: Began running node model.bc_sales.stg_higher_activity_countries
[0m05:04:37.088975 [info ] [Thread-2 (]: 2 of 4 START sql view model bandcamp_sales_schema.stg_higher_activity_countries  [RUN]
[0m05:04:37.088214 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_country_code_ref
[0m05:04:37.087543 [debug] [Thread-3 (]: Began running node model.bc_sales.stg_sales_by_country
[0m05:04:37.095238 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_country_code_ref"
[0m05:04:37.090634 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bc_sales.stg_higher_activity_countries'
[0m05:04:37.096042 [info ] [Thread-3 (]: 3 of 4 START sql view model bandcamp_sales_schema.stg_sales_by_country ......... [RUN]
[0m05:04:37.097077 [debug] [Thread-2 (]: Began compiling node model.bc_sales.stg_higher_activity_countries
[0m05:04:37.098646 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales_by_country'
[0m05:04:37.104887 [debug] [Thread-3 (]: Began compiling node model.bc_sales.stg_sales_by_country
[0m05:04:37.109815 [debug] [Thread-3 (]: Writing injected SQL for node "model.bc_sales.stg_sales_by_country"
[0m05:04:37.111126 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (compile): 05:04:37.091246 => 05:04:37.110767
[0m05:04:37.111703 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_country_code_ref
[0m05:04:37.127032 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (compile): 05:04:37.099045 => 05:04:37.126590
[0m05:04:37.144660 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (compile): 05:04:37.105318 => 05:04:37.144188
[0m05:04:37.150856 [debug] [Thread-3 (]: Began executing node model.bc_sales.stg_sales_by_country
[0m05:04:37.161230 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_country_code_ref"
[0m05:04:37.165288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:04:37.174527 [debug] [Thread-2 (]: Compilation Error in model stg_higher_activity_countries (models/staging/stg_higher_activity_countries.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:04:37.175570 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9bcc570-ad24-40b1-85a2-4908e19f66f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78e6f01f0>]}
[0m05:04:37.187166 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model bandcamp_sales_schema.stg_higher_activity_countries  [[31mERROR[0m in 0.09s]
[0m05:04:37.188412 [debug] [Thread-2 (]: Finished running node model.bc_sales.stg_higher_activity_countries
[0m05:04:37.185734 [debug] [Thread-3 (]: Writing runtime sql for node "model.bc_sales.stg_sales_by_country"
[0m05:04:37.189947 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:04:37.262007 [debug] [Thread-1 (]: On model.bc_sales.stg_country_code_ref: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_country_code_ref"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`;


[0m05:04:37.282488 [debug] [Thread-3 (]: On model.bc_sales.stg_sales_by_country: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales_by_country"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
  OPTIONS()
  as 

-- Q1

select
  cast(cc_ref as integer) as cc_ref,
  cast(amount_paid_usd as numeric) as amount_paid_usd,

  cast(country_code as string) as country_code,
  cast(country as string) as country

from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_partitioned`

-- limit 10000;


[0m05:04:38.276567 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:c1f3fc79-253f-4ccc-bd35-bfd00b586cbe&page=queryresults
[0m05:04:38.297827 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (execute): 05:04:37.112102 => 05:04:38.297509
[0m05:04:38.298966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9bcc570-ad24-40b1-85a2-4908e19f66f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78eb79180>]}
[0m05:04:38.299917 [info ] [Thread-1 (]: 1 of 4 OK created sql view model bandcamp_sales_schema.stg_country_code_ref .... [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m05:04:38.301249 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_country_code_ref
[0m05:04:38.349624 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:36c60483-9c36-4724-9091-f8c896f91af5&page=queryresults
[0m05:04:38.353270 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (execute): 05:04:37.161780 => 05:04:38.352961
[0m05:04:38.354819 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9bcc570-ad24-40b1-85a2-4908e19f66f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78e6db580>]}
[0m05:04:38.355736 [info ] [Thread-3 (]: 3 of 4 OK created sql view model bandcamp_sales_schema.stg_sales_by_country .... [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m05:04:38.356882 [debug] [Thread-3 (]: Finished running node model.bc_sales.stg_sales_by_country
[0m05:04:38.358009 [debug] [Thread-4 (]: Began running node model.bc_sales.country_facts
[0m05:04:38.358729 [info ] [Thread-4 (]: 4 of 4 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m05:04:38.360550 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bc_sales.country_facts'
[0m05:04:38.361280 [debug] [Thread-4 (]: Began compiling node model.bc_sales.country_facts
[0m05:04:38.366633 [debug] [Thread-4 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m05:04:38.367918 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (compile): 05:04:38.361826 => 05:04:38.367491
[0m05:04:38.368460 [debug] [Thread-4 (]: Began executing node model.bc_sales.country_facts
[0m05:04:38.410202 [debug] [Thread-4 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m05:04:38.411455 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:04:38.461307 [debug] [Thread-4 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select *
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
)

select
    cc_ref,
    avg(amount_paid_usd) as average_sale,
    sum(amount_paid_usd) as total_sales,
    country_code,
    country
    from countries
    group by 1
    order by 2 desc
    );
  
[0m05:04:39.000586 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column country_code which is neither grouped nor aggregated at [25:5]')
[0m05:04:40.044154 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:0122433a-0766-42f0-9dc6-4450c0402952&page=queryresults
[0m05:04:40.045607 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (execute): 05:04:38.368803 => 05:04:40.045214
[0m05:04:40.051272 [debug] [Thread-4 (]: Database Error in model country_facts (models/core/country_facts.sql)
  SELECT list expression references column country_code which is neither grouped nor aggregated at [25:5]
  compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m05:04:40.052218 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9bcc570-ad24-40b1-85a2-4908e19f66f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78eb91c30>]}
[0m05:04:40.053149 [error] [Thread-4 (]: 4 of 4 ERROR creating sql table model bandcamp_sales_schema.country_facts ...... [[31mERROR[0m in 1.69s]
[0m05:04:40.054076 [debug] [Thread-4 (]: Finished running node model.bc_sales.country_facts
[0m05:04:40.056644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:04:40.057152 [debug] [MainThread]: Connection 'model.bc_sales.stg_country_code_ref' was properly closed.
[0m05:04:40.057509 [debug] [MainThread]: Connection 'model.bc_sales.stg_higher_activity_countries' was properly closed.
[0m05:04:40.057824 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales_by_country' was properly closed.
[0m05:04:40.058141 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m05:04:40.058583 [info ] [MainThread]: 
[0m05:04:40.059279 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 3.69 seconds (3.69s).
[0m05:04:40.060716 [debug] [MainThread]: Command end result
[0m05:04:40.072196 [info ] [MainThread]: 
[0m05:04:40.074239 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m05:04:40.075843 [info ] [MainThread]: 
[0m05:04:40.076689 [error] [MainThread]: [33mCompilation Error in model stg_higher_activity_countries (models/staging/stg_higher_activity_countries.sql)[0m
[0m05:04:40.077434 [error] [MainThread]:   'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:04:40.078182 [info ] [MainThread]: 
[0m05:04:40.078906 [error] [MainThread]: [33mDatabase Error in model country_facts (models/core/country_facts.sql)[0m
[0m05:04:40.079615 [error] [MainThread]:   SELECT list expression references column country_code which is neither grouped nor aggregated at [25:5]
[0m05:04:40.080429 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m05:04:40.081184 [info ] [MainThread]: 
[0m05:04:40.081944 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m05:04:40.083061 [debug] [MainThread]: Command `dbt build` failed at 05:04:40.082898 after 4.90 seconds
[0m05:04:40.083566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a1f52560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78ee176a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78ee14100>]}
[0m05:04:40.084171 [debug] [MainThread]: Flushing usage events
[0m05:18:55.508474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c2704e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c25fd3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c25fd3820>]}


============================== 05:18:55.512245 | 84ea4605-c28f-48a4-8766-a246ac068a68 ==============================
[0m05:18:55.512245 [info ] [MainThread]: Running with dbt=1.5.0
[0m05:18:55.514176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m05:18:56.516442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84ea4605-c28f-48a4-8766-a246ac068a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c25fd3910>]}
[0m05:18:56.528981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84ea4605-c28f-48a4-8766-a246ac068a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c13e811b0>]}
[0m05:18:56.530265 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m05:18:56.532072 [debug] [MainThread]: Command `dbt build` failed at 05:18:56.531895 after 1.03 seconds
[0m05:18:56.532563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c2704e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c13e72230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c13e71900>]}
[0m05:18:56.533058 [debug] [MainThread]: Flushing usage events
[0m05:19:10.198331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f6c756560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f6b3df6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f6b3df6d0>]}


============================== 05:19:10.201891 | b8cbc906-ae1e-40f1-820c-1c3d624ea3d2 ==============================
[0m05:19:10.201891 [info ] [MainThread]: Running with dbt=1.5.0
[0m05:19:10.202907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m05:19:10.228620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8cbc906-ae1e-40f1-820c-1c3d624ea3d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f6b3df7f0>]}
[0m05:19:10.229960 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qe3w1ter'
[0m05:19:10.230791 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m05:19:10.354381 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m05:19:10.355205 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m05:19:10.441467 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m05:19:10.451740 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m05:19:10.721898 [info ] [MainThread]: Installed from version 0.8.0
[0m05:19:10.723063 [info ] [MainThread]: Updated version available: 1.1.0
[0m05:19:10.724002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b8cbc906-ae1e-40f1-820c-1c3d624ea3d2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f6b22e1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f6b22dc00>]}
[0m05:19:10.724535 [info ] [MainThread]: 
[0m05:19:10.725269 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m05:19:10.726723 [debug] [MainThread]: Command `dbt deps` succeeded at 05:19:10.726540 after 0.54 seconds
[0m05:19:10.727176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f6c756560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f6b3df7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f6b3df910>]}
[0m05:19:10.727658 [debug] [MainThread]: Flushing usage events
[0m05:19:16.582836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f250a04a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2508fd3760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2508fd3790>]}


============================== 05:19:16.586675 | ac6d605e-b8f0-466e-8c7a-2b6c70b6fe73 ==============================
[0m05:19:16.586675 [info ] [MainThread]: Running with dbt=1.5.0
[0m05:19:16.588704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/j/.dbt', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m05:19:17.588334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac6d605e-b8f0-466e-8c7a-2b6c70b6fe73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2508fd3880>]}
[0m05:19:17.601045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac6d605e-b8f0-466e-8c7a-2b6c70b6fe73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24f6e411b0>]}
[0m05:19:17.623259 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m05:19:17.634210 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m05:19:17.635458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ac6d605e-b8f0-466e-8c7a-2b6c70b6fe73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24f6e42cb0>]}
[0m05:19:18.890976 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_country_code_ref.sql
[0m05:19:18.909533 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_by_country.sql
[0m05:19:18.914091 [debug] [MainThread]: 1603: static parser failed on staging/stg_higher_activity_countries.sql
[0m05:19:18.922670 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_higher_activity_countries.sql
[0m05:19:18.926454 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m05:19:19.031933 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m05:19:19.134058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac6d605e-b8f0-466e-8c7a-2b6c70b6fe73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24f6e30910>]}
[0m05:19:19.147869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac6d605e-b8f0-466e-8c7a-2b6c70b6fe73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24f6e31f00>]}
[0m05:19:19.148755 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 540 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m05:19:19.151696 [info ] [MainThread]: 
[0m05:19:19.153458 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m05:19:19.155367 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m05:19:19.156079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:19:19.496437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m05:19:19.497285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:19:19.801792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac6d605e-b8f0-466e-8c7a-2b6c70b6fe73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24f6e31390>]}
[0m05:19:19.803106 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:19:19.804272 [info ] [MainThread]: 
[0m05:19:19.809414 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_country_code_ref
[0m05:19:19.810165 [info ] [Thread-1 (]: 1 of 4 START sql view model bandcamp_sales_schema.stg_country_code_ref ......... [RUN]
[0m05:19:19.811302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.stg_country_code_ref)
[0m05:19:19.811974 [debug] [Thread-2 (]: Began running node model.bc_sales.stg_higher_activity_countries
[0m05:19:19.812584 [debug] [Thread-3 (]: Began running node model.bc_sales.stg_sales_by_country
[0m05:19:19.814779 [info ] [Thread-3 (]: 3 of 4 START sql view model bandcamp_sales_schema.stg_sales_by_country ......... [RUN]
[0m05:19:19.813845 [info ] [Thread-2 (]: 2 of 4 START sql view model bandcamp_sales_schema.stg_higher_activity_countries  [RUN]
[0m05:19:19.817543 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bc_sales.stg_higher_activity_countries'
[0m05:19:19.816357 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales_by_country'
[0m05:19:19.818614 [debug] [Thread-3 (]: Began compiling node model.bc_sales.stg_sales_by_country
[0m05:19:19.818069 [debug] [Thread-2 (]: Began compiling node model.bc_sales.stg_higher_activity_countries
[0m05:19:19.813121 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_country_code_ref
[0m05:19:19.824056 [debug] [Thread-3 (]: Writing injected SQL for node "model.bc_sales.stg_sales_by_country"
[0m05:19:19.833962 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_country_code_ref"
[0m05:19:19.843857 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (compile): 05:19:19.818952 => 05:19:19.843331
[0m05:19:19.844913 [debug] [Thread-3 (]: Began executing node model.bc_sales.stg_sales_by_country
[0m05:19:19.851051 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (compile): 05:19:19.828636 => 05:19:19.850620
[0m05:19:19.857020 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_country_code_ref
[0m05:19:19.889108 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (compile): 05:19:19.824678 => 05:19:19.888661
[0m05:19:19.920830 [debug] [Thread-3 (]: Writing runtime sql for node "model.bc_sales.stg_sales_by_country"
[0m05:19:19.923675 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_country_code_ref"
[0m05:19:19.925778 [debug] [Thread-2 (]: Compilation Error in model stg_higher_activity_countries (models/staging/stg_higher_activity_countries.sql)
  'dict object' has no attribute 'get_single_value'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:19:19.927287 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac6d605e-b8f0-466e-8c7a-2b6c70b6fe73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24f6ba5b70>]}
[0m05:19:19.928367 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model bandcamp_sales_schema.stg_higher_activity_countries  [[31mERROR[0m in 0.11s]
[0m05:19:19.929384 [debug] [Thread-2 (]: Finished running node model.bc_sales.stg_higher_activity_countries
[0m05:19:19.930583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:19:19.930081 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:19:20.024544 [debug] [Thread-1 (]: On model.bc_sales.stg_country_code_ref: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_country_code_ref"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`;


[0m05:19:20.026465 [debug] [Thread-3 (]: On model.bc_sales.stg_sales_by_country: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales_by_country"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
  OPTIONS()
  as 

-- Q1

select
  cast(cc_ref as integer) as cc_ref,
  cast(amount_paid_usd as numeric) as amount_paid_usd,

  cast(country_code as string) as country_code,
  cast(country as string) as country

from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_partitioned`

-- limit 10000;


[0m05:19:21.001042 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:5d93ab51-0a0d-4504-b1b7-7fa631ec729b&page=queryresults
[0m05:19:21.022477 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:e7d26eee-18fe-4bf4-b07f-24fa47a6f793&page=queryresults
[0m05:19:21.027076 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (execute): 05:19:19.845429 => 05:19:21.026778
[0m05:19:21.030089 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (execute): 05:19:19.857649 => 05:19:21.029786
[0m05:19:21.031355 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac6d605e-b8f0-466e-8c7a-2b6c70b6fe73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24f66efcd0>]}
[0m05:19:21.032579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac6d605e-b8f0-466e-8c7a-2b6c70b6fe73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24f66cd450>]}
[0m05:19:21.033633 [info ] [Thread-3 (]: 3 of 4 OK created sql view model bandcamp_sales_schema.stg_sales_by_country .... [[32mCREATE VIEW (0 processed)[0m in 1.22s]
[0m05:19:21.035655 [debug] [Thread-3 (]: Finished running node model.bc_sales.stg_sales_by_country
[0m05:19:21.036940 [debug] [Thread-4 (]: Began running node model.bc_sales.country_facts
[0m05:19:21.037888 [info ] [Thread-4 (]: 4 of 4 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m05:19:21.039468 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bc_sales.country_facts'
[0m05:19:21.034734 [info ] [Thread-1 (]: 1 of 4 OK created sql view model bandcamp_sales_schema.stg_country_code_ref .... [[32mCREATE VIEW (0 processed)[0m in 1.22s]
[0m05:19:21.040022 [debug] [Thread-4 (]: Began compiling node model.bc_sales.country_facts
[0m05:19:21.040910 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_country_code_ref
[0m05:19:21.046599 [debug] [Thread-4 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m05:19:21.048149 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (compile): 05:19:21.041303 => 05:19:21.047709
[0m05:19:21.048742 [debug] [Thread-4 (]: Began executing node model.bc_sales.country_facts
[0m05:19:21.088761 [debug] [Thread-4 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m05:19:21.089837 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:19:21.139071 [debug] [Thread-4 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select *
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
)

select
    cc_ref,
    avg(amount_paid_usd) as average_sale,
    sum(amount_paid_usd) as total_sales,
    country_code,
    country
    from countries
    group by 1
    order by 2 desc
    );
  
[0m05:19:21.641799 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column country_code which is neither grouped nor aggregated at [25:5]')
[0m05:19:22.173600 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:316a92ec-f665-488f-943a-e36b6df6b5fb&page=queryresults
[0m05:19:22.175063 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (execute): 05:19:21.049140 => 05:19:22.174668
[0m05:19:22.178746 [debug] [Thread-4 (]: Database Error in model country_facts (models/core/country_facts.sql)
  SELECT list expression references column country_code which is neither grouped nor aggregated at [25:5]
  compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m05:19:22.179489 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac6d605e-b8f0-466e-8c7a-2b6c70b6fe73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24f660a350>]}
[0m05:19:22.180429 [error] [Thread-4 (]: 4 of 4 ERROR creating sql table model bandcamp_sales_schema.country_facts ...... [[31mERROR[0m in 1.14s]
[0m05:19:22.181334 [debug] [Thread-4 (]: Finished running node model.bc_sales.country_facts
[0m05:19:22.184207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:19:22.184647 [debug] [MainThread]: Connection 'model.bc_sales.stg_country_code_ref' was properly closed.
[0m05:19:22.184987 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales_by_country' was properly closed.
[0m05:19:22.185304 [debug] [MainThread]: Connection 'model.bc_sales.stg_higher_activity_countries' was properly closed.
[0m05:19:22.185731 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m05:19:22.186155 [info ] [MainThread]: 
[0m05:19:22.186805 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m05:19:22.188263 [debug] [MainThread]: Command end result
[0m05:19:22.201743 [info ] [MainThread]: 
[0m05:19:22.203015 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m05:19:22.203913 [info ] [MainThread]: 
[0m05:19:22.204834 [error] [MainThread]: [33mCompilation Error in model stg_higher_activity_countries (models/staging/stg_higher_activity_countries.sql)[0m
[0m05:19:22.205605 [error] [MainThread]:   'dict object' has no attribute 'get_single_value'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:19:22.206358 [info ] [MainThread]: 
[0m05:19:22.207060 [error] [MainThread]: [33mDatabase Error in model country_facts (models/core/country_facts.sql)[0m
[0m05:19:22.207762 [error] [MainThread]:   SELECT list expression references column country_code which is neither grouped nor aggregated at [25:5]
[0m05:19:22.208517 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m05:19:22.209291 [info ] [MainThread]: 
[0m05:19:22.209945 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m05:19:22.210964 [debug] [MainThread]: Command `dbt build` failed at 05:19:22.210787 after 5.64 seconds
[0m05:19:22.211461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f250a04a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24f7230cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2509fffd30>]}
[0m05:19:22.212051 [debug] [MainThread]: Flushing usage events
[0m05:21:56.688261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2027d5a560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20269e3820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20269e37f0>]}


============================== 05:21:56.693619 | 201a9065-1414-4bb2-8272-836e77ee9fbd ==============================
[0m05:21:56.693619 [info ] [MainThread]: Running with dbt=1.5.0
[0m05:21:56.694652 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m05:21:57.676153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '201a9065-1414-4bb2-8272-836e77ee9fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20269e38e0>]}
[0m05:21:57.689085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '201a9065-1414-4bb2-8272-836e77ee9fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2014bcdf90>]}
[0m05:21:57.711681 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m05:21:57.755515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:21:57.756517 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/staging/stg_higher_activity_countries.sql
[0m05:21:57.778688 [debug] [MainThread]: 1603: static parser failed on staging/stg_higher_activity_countries.sql
[0m05:21:57.799652 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_higher_activity_countries.sql
[0m05:21:57.810397 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m05:21:57.818135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '201a9065-1414-4bb2-8272-836e77ee9fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20148500d0>]}
[0m05:21:57.831218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '201a9065-1414-4bb2-8272-836e77ee9fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20149fcbb0>]}
[0m05:21:57.832087 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 540 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m05:21:57.834500 [info ] [MainThread]: 
[0m05:21:57.835756 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m05:21:57.837597 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m05:21:57.838233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:21:58.188200 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m05:21:58.189061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:21:58.493704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '201a9065-1414-4bb2-8272-836e77ee9fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20149fc2e0>]}
[0m05:21:58.494944 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:21:58.495705 [info ] [MainThread]: 
[0m05:21:58.501123 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_country_code_ref
[0m05:21:58.501895 [info ] [Thread-1 (]: 1 of 4 START sql view model bandcamp_sales_schema.stg_country_code_ref ......... [RUN]
[0m05:21:58.503283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.stg_country_code_ref)
[0m05:21:58.503900 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_country_code_ref
[0m05:21:58.504407 [debug] [Thread-2 (]: Began running node model.bc_sales.stg_higher_activity_countries
[0m05:21:58.509004 [info ] [Thread-2 (]: 2 of 4 START sql view model bandcamp_sales_schema.stg_higher_activity_countries  [RUN]
[0m05:21:58.504965 [debug] [Thread-3 (]: Began running node model.bc_sales.stg_sales_by_country
[0m05:21:58.510221 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now model.bc_sales.stg_higher_activity_countries)
[0m05:21:58.511962 [info ] [Thread-3 (]: 3 of 4 START sql view model bandcamp_sales_schema.stg_sales_by_country ......... [RUN]
[0m05:21:58.513487 [debug] [Thread-2 (]: Began compiling node model.bc_sales.stg_higher_activity_countries
[0m05:21:58.514830 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales_by_country'
[0m05:21:58.524525 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_country_code_ref"
[0m05:21:58.525184 [debug] [Thread-3 (]: Began compiling node model.bc_sales.stg_sales_by_country
[0m05:21:58.526495 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (compile): 05:21:58.515214 => 05:21:58.526164
[0m05:21:58.531124 [debug] [Thread-3 (]: Writing injected SQL for node "model.bc_sales.stg_sales_by_country"
[0m05:21:58.534305 [debug] [Thread-2 (]: Compilation Error in model stg_higher_activity_countries (models/staging/stg_higher_activity_countries.sql)
  'dict object' has no attribute 'get_single_value'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:21:58.535066 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (compile): 05:21:58.505364 => 05:21:58.534732
[0m05:21:58.535933 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '201a9065-1414-4bb2-8272-836e77ee9fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20148504c0>]}
[0m05:21:58.536651 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_country_code_ref
[0m05:21:58.537322 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (compile): 05:21:58.527052 => 05:21:58.536977
[0m05:21:58.538163 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model bandcamp_sales_schema.stg_higher_activity_countries  [[31mERROR[0m in 0.03s]
[0m05:21:58.555703 [debug] [Thread-3 (]: Began executing node model.bc_sales.stg_sales_by_country
[0m05:21:58.561824 [debug] [Thread-2 (]: Finished running node model.bc_sales.stg_higher_activity_countries
[0m05:21:58.594762 [debug] [Thread-3 (]: Writing runtime sql for node "model.bc_sales.stg_sales_by_country"
[0m05:21:58.595699 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_country_code_ref"
[0m05:21:58.596944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:21:58.597675 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:21:58.691329 [debug] [Thread-3 (]: On model.bc_sales.stg_sales_by_country: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales_by_country"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
  OPTIONS()
  as 

-- Q1

select
  cast(cc_ref as integer) as cc_ref,
  cast(amount_paid_usd as numeric) as amount_paid_usd,

  cast(country_code as string) as country_code,
  cast(country as string) as country

from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_partitioned`

-- limit 10000;


[0m05:21:58.692505 [debug] [Thread-1 (]: On model.bc_sales.stg_country_code_ref: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_country_code_ref"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`;


[0m05:21:59.633160 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:7c0e579d-f2c6-432d-900a-adc66e1dccd4&page=queryresults
[0m05:21:59.658844 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (execute): 05:21:58.571881 => 05:21:59.658546
[0m05:21:59.660022 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '201a9065-1414-4bb2-8272-836e77ee9fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2014853df0>]}
[0m05:21:59.660989 [info ] [Thread-3 (]: 3 of 4 OK created sql view model bandcamp_sales_schema.stg_sales_by_country .... [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m05:21:59.662387 [debug] [Thread-3 (]: Finished running node model.bc_sales.stg_sales_by_country
[0m05:21:59.663440 [debug] [Thread-4 (]: Began running node model.bc_sales.country_facts
[0m05:21:59.664257 [info ] [Thread-4 (]: 4 of 4 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m05:21:59.666292 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bc_sales.country_facts'
[0m05:21:59.666809 [debug] [Thread-4 (]: Began compiling node model.bc_sales.country_facts
[0m05:21:59.678527 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:84410fa6-cba5-4d7b-ac4a-4f4ba039b73d&page=queryresults
[0m05:21:59.683858 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (execute): 05:21:58.539127 => 05:21:59.683311
[0m05:21:59.687177 [debug] [Thread-4 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m05:21:59.690678 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (compile): 05:21:59.667109 => 05:21:59.690191
[0m05:21:59.691515 [debug] [Thread-4 (]: Began executing node model.bc_sales.country_facts
[0m05:21:59.689198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '201a9065-1414-4bb2-8272-836e77ee9fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20147bcaf0>]}
[0m05:21:59.701676 [info ] [Thread-1 (]: 1 of 4 OK created sql view model bandcamp_sales_schema.stg_country_code_ref .... [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m05:21:59.702950 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_country_code_ref
[0m05:21:59.737888 [debug] [Thread-4 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m05:21:59.738929 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:21:59.788097 [debug] [Thread-4 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select *
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
)

select
    cc_ref,
    avg(amount_paid_usd) as average_sale,
    sum(amount_paid_usd) as total_sales,
    country_code,
    country
    from countries
    group by 1
    order by 2 desc
    );
  
[0m05:22:00.447669 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column country_code which is neither grouped nor aggregated at [25:5]')
[0m05:22:00.891527 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:088264ef-9d1e-4f13-b820-d3e4a13ff67e&page=queryresults
[0m05:22:00.893042 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (execute): 05:21:59.692098 => 05:22:00.892620
[0m05:22:00.897996 [debug] [Thread-4 (]: Database Error in model country_facts (models/core/country_facts.sql)
  SELECT list expression references column country_code which is neither grouped nor aggregated at [25:5]
  compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m05:22:00.899000 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '201a9065-1414-4bb2-8272-836e77ee9fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2014853df0>]}
[0m05:22:00.900101 [error] [Thread-4 (]: 4 of 4 ERROR creating sql table model bandcamp_sales_schema.country_facts ...... [[31mERROR[0m in 1.23s]
[0m05:22:00.901104 [debug] [Thread-4 (]: Finished running node model.bc_sales.country_facts
[0m05:22:00.904478 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:22:00.905031 [debug] [MainThread]: Connection 'model.bc_sales.stg_higher_activity_countries' was properly closed.
[0m05:22:00.905527 [debug] [MainThread]: Connection 'model.bc_sales.stg_country_code_ref' was properly closed.
[0m05:22:00.905872 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales_by_country' was properly closed.
[0m05:22:00.906189 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m05:22:00.906640 [info ] [MainThread]: 
[0m05:22:00.907357 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 3.07 seconds (3.07s).
[0m05:22:00.908820 [debug] [MainThread]: Command end result
[0m05:22:00.921531 [info ] [MainThread]: 
[0m05:22:00.922487 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m05:22:00.923173 [info ] [MainThread]: 
[0m05:22:00.923871 [error] [MainThread]: [33mCompilation Error in model stg_higher_activity_countries (models/staging/stg_higher_activity_countries.sql)[0m
[0m05:22:00.924568 [error] [MainThread]:   'dict object' has no attribute 'get_single_value'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:22:00.925177 [info ] [MainThread]: 
[0m05:22:00.925771 [error] [MainThread]: [33mDatabase Error in model country_facts (models/core/country_facts.sql)[0m
[0m05:22:00.926348 [error] [MainThread]:   SELECT list expression references column country_code which is neither grouped nor aggregated at [25:5]
[0m05:22:00.926921 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m05:22:00.927599 [info ] [MainThread]: 
[0m05:22:00.928382 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m05:22:00.929393 [debug] [MainThread]: Command `dbt build` failed at 05:22:00.929220 after 4.25 seconds
[0m05:22:00.929886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2027d5a560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2014859c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201470a2c0>]}
[0m05:22:00.930392 [debug] [MainThread]: Flushing usage events
[0m05:23:10.745978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c5e24e500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c5d1d7760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c5d1d7790>]}


============================== 05:23:10.749828 | ba659dad-a14b-47a6-854f-57e58d487c33 ==============================
[0m05:23:10.749828 [info ] [MainThread]: Running with dbt=1.5.0
[0m05:23:10.751820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m05:23:11.749104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba659dad-a14b-47a6-854f-57e58d487c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c5d1d7880>]}
[0m05:23:11.761765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba659dad-a14b-47a6-854f-57e58d487c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4b0711b0>]}
[0m05:23:11.784341 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m05:23:11.829254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:23:11.829862 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:23:11.830671 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m05:23:11.839661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba659dad-a14b-47a6-854f-57e58d487c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4acd40d0>]}
[0m05:23:11.854713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba659dad-a14b-47a6-854f-57e58d487c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4aca2ec0>]}
[0m05:23:11.855553 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 540 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m05:23:11.858247 [info ] [MainThread]: 
[0m05:23:11.859719 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m05:23:11.861560 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m05:23:11.862079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:23:12.233508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m05:23:12.234318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:23:12.534527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba659dad-a14b-47a6-854f-57e58d487c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4aca0310>]}
[0m05:23:12.535731 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:23:12.536849 [info ] [MainThread]: 
[0m05:23:12.542064 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_country_code_ref
[0m05:23:12.543648 [debug] [Thread-2 (]: Began running node model.bc_sales.stg_higher_activity_countries
[0m05:23:12.544452 [debug] [Thread-3 (]: Began running node model.bc_sales.stg_sales_by_country
[0m05:23:12.543058 [info ] [Thread-1 (]: 1 of 4 START sql view model bandcamp_sales_schema.stg_country_code_ref ......... [RUN]
[0m05:23:12.547357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.stg_country_code_ref)
[0m05:23:12.545230 [info ] [Thread-2 (]: 2 of 4 START sql view model bandcamp_sales_schema.stg_higher_activity_countries  [RUN]
[0m05:23:12.545945 [info ] [Thread-3 (]: 3 of 4 START sql view model bandcamp_sales_schema.stg_sales_by_country ......... [RUN]
[0m05:23:12.548196 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_country_code_ref
[0m05:23:12.549651 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bc_sales.stg_higher_activity_countries'
[0m05:23:12.557317 [debug] [Thread-2 (]: Began compiling node model.bc_sales.stg_higher_activity_countries
[0m05:23:12.556529 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_country_code_ref"
[0m05:23:12.550922 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales_by_country'
[0m05:23:12.564606 [debug] [Thread-3 (]: Began compiling node model.bc_sales.stg_sales_by_country
[0m05:23:12.566179 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (compile): 05:23:12.557714 => 05:23:12.565756
[0m05:23:12.574217 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (compile): 05:23:12.551401 => 05:23:12.573794
[0m05:23:12.575132 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_country_code_ref
[0m05:23:12.586344 [debug] [Thread-3 (]: Writing injected SQL for node "model.bc_sales.stg_sales_by_country"
[0m05:23:12.605544 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (compile): 05:23:12.566622 => 05:23:12.605007
[0m05:23:12.606502 [debug] [Thread-3 (]: Began executing node model.bc_sales.stg_sales_by_country
[0m05:23:12.649005 [debug] [Thread-3 (]: Writing runtime sql for node "model.bc_sales.stg_sales_by_country"
[0m05:23:12.653936 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:23:12.652966 [debug] [Thread-2 (]: Compilation Error in model stg_higher_activity_countries (models/staging/stg_higher_activity_countries.sql)
  'dict object' has no attribute 'get_single_value'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:23:12.651599 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_country_code_ref"
[0m05:23:12.654776 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba659dad-a14b-47a6-854f-57e58d487c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4acd42b0>]}
[0m05:23:12.656795 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model bandcamp_sales_schema.stg_higher_activity_countries  [[31mERROR[0m in 0.11s]
[0m05:23:12.657912 [debug] [Thread-2 (]: Finished running node model.bc_sales.stg_higher_activity_countries
[0m05:23:12.659196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:12.750991 [debug] [Thread-1 (]: On model.bc_sales.stg_country_code_ref: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_country_code_ref"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`;


[0m05:23:12.762221 [debug] [Thread-3 (]: On model.bc_sales.stg_sales_by_country: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales_by_country"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
  OPTIONS()
  as 

-- Q1

select
  cast(cc_ref as integer) as cc_ref,
  cast(amount_paid_usd as numeric) as amount_paid_usd,

  cast(country_code as string) as country_code,
  cast(country as string) as country

from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_partitioned`

-- limit 10000;


[0m05:23:13.621511 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:7571b6f8-6c8a-4abd-bd29-526807344574&page=queryresults
[0m05:23:13.643554 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:22626c71-f475-48c1-a0bc-4aa50c1e26e8&page=queryresults
[0m05:23:13.651944 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (execute): 05:23:12.575665 => 05:23:13.651576
[0m05:23:13.652576 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (execute): 05:23:12.607078 => 05:23:13.649057
[0m05:23:13.653742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba659dad-a14b-47a6-854f-57e58d487c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4b079e70>]}
[0m05:23:13.654921 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba659dad-a14b-47a6-854f-57e58d487c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4acd4520>]}
[0m05:23:13.655991 [info ] [Thread-1 (]: 1 of 4 OK created sql view model bandcamp_sales_schema.stg_country_code_ref .... [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m05:23:13.657234 [info ] [Thread-3 (]: 3 of 4 OK created sql view model bandcamp_sales_schema.stg_sales_by_country .... [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m05:23:13.658353 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_country_code_ref
[0m05:23:13.659202 [debug] [Thread-3 (]: Finished running node model.bc_sales.stg_sales_by_country
[0m05:23:13.660632 [debug] [Thread-4 (]: Began running node model.bc_sales.country_facts
[0m05:23:13.661564 [info ] [Thread-4 (]: 4 of 4 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m05:23:13.663305 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bc_sales.country_facts'
[0m05:23:13.663862 [debug] [Thread-4 (]: Began compiling node model.bc_sales.country_facts
[0m05:23:13.669162 [debug] [Thread-4 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m05:23:13.670274 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (compile): 05:23:13.664185 => 05:23:13.669905
[0m05:23:13.670903 [debug] [Thread-4 (]: Began executing node model.bc_sales.country_facts
[0m05:23:13.709794 [debug] [Thread-4 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m05:23:13.711191 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:23:13.761392 [debug] [Thread-4 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select *
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
)

select
    cc_ref,
    avg(amount_paid_usd) as average_sale,
    sum(amount_paid_usd) as total_sales,
    country_code,
    country
    from countries
    group by 1
    order by 2 desc
    );
  
[0m05:23:14.274192 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column country_code which is neither grouped nor aggregated at [25:5]')
[0m05:23:14.644535 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:fbe5ce2e-64e8-4eaf-844b-6bfec726b141&page=queryresults
[0m05:23:14.645956 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (execute): 05:23:13.671247 => 05:23:14.645571
[0m05:23:14.649620 [debug] [Thread-4 (]: Database Error in model country_facts (models/core/country_facts.sql)
  SELECT list expression references column country_code which is neither grouped nor aggregated at [25:5]
  compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m05:23:14.650381 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba659dad-a14b-47a6-854f-57e58d487c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4ae852a0>]}
[0m05:23:14.651261 [error] [Thread-4 (]: 4 of 4 ERROR creating sql table model bandcamp_sales_schema.country_facts ...... [[31mERROR[0m in 0.99s]
[0m05:23:14.652197 [debug] [Thread-4 (]: Finished running node model.bc_sales.country_facts
[0m05:23:14.654817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:23:14.655227 [debug] [MainThread]: Connection 'model.bc_sales.stg_country_code_ref' was properly closed.
[0m05:23:14.655550 [debug] [MainThread]: Connection 'model.bc_sales.stg_higher_activity_countries' was properly closed.
[0m05:23:14.655971 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales_by_country' was properly closed.
[0m05:23:14.656474 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m05:23:14.656919 [info ] [MainThread]: 
[0m05:23:14.657628 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 2.80 seconds (2.80s).
[0m05:23:14.658992 [debug] [MainThread]: Command end result
[0m05:23:14.681798 [info ] [MainThread]: 
[0m05:23:14.682768 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m05:23:14.683449 [info ] [MainThread]: 
[0m05:23:14.684348 [error] [MainThread]: [33mCompilation Error in model stg_higher_activity_countries (models/staging/stg_higher_activity_countries.sql)[0m
[0m05:23:14.685323 [error] [MainThread]:   'dict object' has no attribute 'get_single_value'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:23:14.686165 [info ] [MainThread]: 
[0m05:23:14.686962 [error] [MainThread]: [33mDatabase Error in model country_facts (models/core/country_facts.sql)[0m
[0m05:23:14.687806 [error] [MainThread]:   SELECT list expression references column country_code which is neither grouped nor aggregated at [25:5]
[0m05:23:14.690212 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m05:23:14.691604 [info ] [MainThread]: 
[0m05:23:14.692928 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m05:23:14.694545 [debug] [MainThread]: Command `dbt build` failed at 05:23:14.694303 after 3.96 seconds
[0m05:23:14.695340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c5e24e500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4b060df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4b070580>]}
[0m05:23:14.696171 [debug] [MainThread]: Flushing usage events
[0m05:25:48.643222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f618143e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61800c3730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61800c3760>]}


============================== 05:25:48.646982 | 804dc2f5-7472-4ed9-8fcf-b6474e6ab4f0 ==============================
[0m05:25:48.646982 [info ] [MainThread]: Running with dbt=1.5.0
[0m05:25:48.648732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'debug': 'False', 'profiles_dir': '/home/j/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m05:25:49.647867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '804dc2f5-7472-4ed9-8fcf-b6474e6ab4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61800c3850>]}
[0m05:25:49.660713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '804dc2f5-7472-4ed9-8fcf-b6474e6ab4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f616e211240>]}
[0m05:25:49.683078 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m05:25:49.741088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:25:49.742677 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts.sql
[0m05:25:49.766930 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m05:25:49.810323 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m05:25:49.818383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '804dc2f5-7472-4ed9-8fcf-b6474e6ab4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f616dec4550>]}
[0m05:25:49.832444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '804dc2f5-7472-4ed9-8fcf-b6474e6ab4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f616de40b20>]}
[0m05:25:49.833275 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 540 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m05:25:49.835717 [info ] [MainThread]: 
[0m05:25:49.837090 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m05:25:49.838949 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m05:25:49.839530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:25:50.221715 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m05:25:50.222566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:25:50.558076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '804dc2f5-7472-4ed9-8fcf-b6474e6ab4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f616de40250>]}
[0m05:25:50.559325 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:25:50.560148 [info ] [MainThread]: 
[0m05:25:50.565679 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_country_code_ref
[0m05:25:50.566514 [info ] [Thread-1 (]: 1 of 4 START sql view model bandcamp_sales_schema.stg_country_code_ref ......... [RUN]
[0m05:25:50.567970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.stg_country_code_ref)
[0m05:25:50.568557 [debug] [Thread-2 (]: Began running node model.bc_sales.stg_higher_activity_countries
[0m05:25:50.570198 [info ] [Thread-2 (]: 2 of 4 START sql view model bandcamp_sales_schema.stg_higher_activity_countries  [RUN]
[0m05:25:50.569554 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_country_code_ref
[0m05:25:50.569058 [debug] [Thread-3 (]: Began running node model.bc_sales.stg_sales_by_country
[0m05:25:50.571513 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bc_sales.stg_higher_activity_countries'
[0m05:25:50.578122 [debug] [Thread-2 (]: Began compiling node model.bc_sales.stg_higher_activity_countries
[0m05:25:50.577240 [info ] [Thread-3 (]: 3 of 4 START sql view model bandcamp_sales_schema.stg_sales_by_country ......... [RUN]
[0m05:25:50.576417 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_country_code_ref"
[0m05:25:50.584666 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales_by_country'
[0m05:25:50.586571 [debug] [Thread-3 (]: Began compiling node model.bc_sales.stg_sales_by_country
[0m05:25:50.591634 [debug] [Thread-3 (]: Writing injected SQL for node "model.bc_sales.stg_sales_by_country"
[0m05:25:50.593204 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (compile): 05:25:50.578477 => 05:25:50.592840
[0m05:25:50.594806 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (compile): 05:25:50.571932 => 05:25:50.594408
[0m05:25:50.595421 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_country_code_ref
[0m05:25:50.601861 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (compile): 05:25:50.587112 => 05:25:50.601427
[0m05:25:50.607950 [debug] [Thread-3 (]: Began executing node model.bc_sales.stg_sales_by_country
[0m05:25:50.657772 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_country_code_ref"
[0m05:25:50.659999 [debug] [Thread-2 (]: Compilation Error in model stg_higher_activity_countries (models/staging/stg_higher_activity_countries.sql)
  'dict object' has no attribute 'get_single_value'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:25:50.663557 [debug] [Thread-3 (]: Writing runtime sql for node "model.bc_sales.stg_sales_by_country"
[0m05:25:50.664515 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '804dc2f5-7472-4ed9-8fcf-b6474e6ab4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f616d9c2ec0>]}
[0m05:25:50.665459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:25:50.666301 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:25:50.667241 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model bandcamp_sales_schema.stg_higher_activity_countries  [[31mERROR[0m in 0.09s]
[0m05:25:50.672618 [debug] [Thread-2 (]: Finished running node model.bc_sales.stg_higher_activity_countries
[0m05:25:50.760106 [debug] [Thread-1 (]: On model.bc_sales.stg_country_code_ref: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_country_code_ref"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`;


[0m05:25:50.766063 [debug] [Thread-3 (]: On model.bc_sales.stg_sales_by_country: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales_by_country"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
  OPTIONS()
  as 

-- Q1

select
  cast(cc_ref as integer) as cc_ref,
  cast(amount_paid_usd as numeric) as amount_paid_usd,

  cast(country_code as string) as country_code,
  cast(country as string) as country

from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_partitioned`

-- limit 10000;


[0m05:25:51.651391 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:f6555bfb-ee57-490e-9c85-7e11e62b0491&page=queryresults
[0m05:25:51.673823 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (execute): 05:25:50.608837 => 05:25:51.673532
[0m05:25:51.674877 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '804dc2f5-7472-4ed9-8fcf-b6474e6ab4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f616d9c2d10>]}
[0m05:25:51.675733 [info ] [Thread-3 (]: 3 of 4 OK created sql view model bandcamp_sales_schema.stg_sales_by_country .... [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m05:25:51.677107 [debug] [Thread-3 (]: Finished running node model.bc_sales.stg_sales_by_country
[0m05:25:51.678033 [debug] [Thread-4 (]: Began running node model.bc_sales.country_facts
[0m05:25:51.678663 [info ] [Thread-4 (]: 4 of 4 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m05:25:51.680240 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bc_sales.country_facts'
[0m05:25:51.680708 [debug] [Thread-4 (]: Began compiling node model.bc_sales.country_facts
[0m05:25:51.685561 [debug] [Thread-4 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m05:25:51.688765 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:b38e53db-09fb-4024-b2ee-f087b6789953&page=queryresults
[0m05:25:51.689625 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (compile): 05:25:51.681018 => 05:25:51.689260
[0m05:25:51.692561 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (execute): 05:25:50.595960 => 05:25:51.692280
[0m05:25:51.693383 [debug] [Thread-4 (]: Began executing node model.bc_sales.country_facts
[0m05:25:51.694875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '804dc2f5-7472-4ed9-8fcf-b6474e6ab4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f616d99fac0>]}
[0m05:25:51.711559 [info ] [Thread-1 (]: 1 of 4 OK created sql view model bandcamp_sales_schema.stg_country_code_ref .... [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m05:25:51.713032 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_country_code_ref
[0m05:25:51.736547 [debug] [Thread-4 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m05:25:51.737598 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:25:51.786974 [debug] [Thread-4 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select *
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
)

select
    cc_ref,
    avg(amount_paid_usd) as average_sale,
    sum(amount_paid_usd) as total_sales,
    country_code,
    country
    from countries
    group by 1
    order by average_sale
    );
  
[0m05:25:52.274444 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column country_code which is neither grouped nor aggregated at [25:5]')
[0m05:25:53.130017 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:fbaaf238-b7f5-41e7-b7a0-ed71cd6bfde5&page=queryresults
[0m05:25:53.131836 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (execute): 05:25:51.695337 => 05:25:53.131300
[0m05:25:53.136206 [debug] [Thread-4 (]: Database Error in model country_facts (models/core/country_facts.sql)
  SELECT list expression references column country_code which is neither grouped nor aggregated at [25:5]
  compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m05:25:53.137121 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '804dc2f5-7472-4ed9-8fcf-b6474e6ab4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f616d9a8fa0>]}
[0m05:25:53.138137 [error] [Thread-4 (]: 4 of 4 ERROR creating sql table model bandcamp_sales_schema.country_facts ...... [[31mERROR[0m in 1.46s]
[0m05:25:53.139197 [debug] [Thread-4 (]: Finished running node model.bc_sales.country_facts
[0m05:25:53.142689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:25:53.143223 [debug] [MainThread]: Connection 'model.bc_sales.stg_country_code_ref' was properly closed.
[0m05:25:53.143574 [debug] [MainThread]: Connection 'model.bc_sales.stg_higher_activity_countries' was properly closed.
[0m05:25:53.144005 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales_by_country' was properly closed.
[0m05:25:53.144338 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m05:25:53.144796 [info ] [MainThread]: 
[0m05:25:53.145522 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 3.31 seconds (3.31s).
[0m05:25:53.147061 [debug] [MainThread]: Command end result
[0m05:25:53.177097 [info ] [MainThread]: 
[0m05:25:53.178602 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m05:25:53.179478 [info ] [MainThread]: 
[0m05:25:53.180556 [error] [MainThread]: [33mCompilation Error in model stg_higher_activity_countries (models/staging/stg_higher_activity_countries.sql)[0m
[0m05:25:53.181400 [error] [MainThread]:   'dict object' has no attribute 'get_single_value'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:25:53.182163 [info ] [MainThread]: 
[0m05:25:53.182885 [error] [MainThread]: [33mDatabase Error in model country_facts (models/core/country_facts.sql)[0m
[0m05:25:53.183596 [error] [MainThread]:   SELECT list expression references column country_code which is neither grouped nor aggregated at [25:5]
[0m05:25:53.184400 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m05:25:53.185148 [info ] [MainThread]: 
[0m05:25:53.186178 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m05:25:53.187492 [debug] [MainThread]: Command `dbt build` failed at 05:25:53.187306 after 4.55 seconds
[0m05:25:53.188178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f618143e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f616d99f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f616d981990>]}
[0m05:25:53.189074 [debug] [MainThread]: Flushing usage events
[0m06:10:06.003879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44824a560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4471cf7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4471cf7f0>]}


============================== 06:10:06.007648 | 5bcbf002-ae0f-4c9d-afc7-c0893264946a ==============================
[0m06:10:06.007648 [info ] [MainThread]: Running with dbt=1.5.0
[0m06:10:06.009290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:10:07.148697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bcbf002-ae0f-4c9d-afc7-c0893264946a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4471cf8e0>]}
[0m06:10:07.161406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bcbf002-ae0f-4c9d-afc7-c0893264946a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe435081240>]}
[0m06:10:07.183898 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m06:10:07.239339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:10:07.240537 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts.sql
[0m06:10:07.265094 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m06:10:07.312792 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m06:10:07.321148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bcbf002-ae0f-4c9d-afc7-c0893264946a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe434ce45e0>]}
[0m06:10:07.340204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bcbf002-ae0f-4c9d-afc7-c0893264946a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe434cb0bb0>]}
[0m06:10:07.341040 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 540 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m06:10:07.343488 [info ] [MainThread]: 
[0m06:10:07.344906 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:10:07.346858 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m06:10:07.347541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:10:07.728652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m06:10:07.729493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:10:08.060087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bcbf002-ae0f-4c9d-afc7-c0893264946a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe434cb02e0>]}
[0m06:10:08.061246 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:10:08.062302 [info ] [MainThread]: 
[0m06:10:08.067703 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_country_code_ref
[0m06:10:08.068617 [info ] [Thread-1 (]: 1 of 4 START sql view model bandcamp_sales_schema.stg_country_code_ref ......... [RUN]
[0m06:10:08.069980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.stg_country_code_ref)
[0m06:10:08.070668 [debug] [Thread-2 (]: Began running node model.bc_sales.stg_higher_activity_countries
[0m06:10:08.071274 [debug] [Thread-3 (]: Began running node model.bc_sales.stg_sales_by_country
[0m06:10:08.071932 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_country_code_ref
[0m06:10:08.072615 [info ] [Thread-2 (]: 2 of 4 START sql view model bandcamp_sales_schema.stg_higher_activity_countries  [RUN]
[0m06:10:08.073611 [info ] [Thread-3 (]: 3 of 4 START sql view model bandcamp_sales_schema.stg_sales_by_country ......... [RUN]
[0m06:10:08.082323 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales_by_country'
[0m06:10:08.080888 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bc_sales.stg_higher_activity_countries'
[0m06:10:08.083532 [debug] [Thread-2 (]: Began compiling node model.bc_sales.stg_higher_activity_countries
[0m06:10:08.082964 [debug] [Thread-3 (]: Began compiling node model.bc_sales.stg_sales_by_country
[0m06:10:08.079259 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_country_code_ref"
[0m06:10:08.096279 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (compile): 06:10:08.083917 => 06:10:08.095757
[0m06:10:08.094841 [debug] [Thread-3 (]: Writing injected SQL for node "model.bc_sales.stg_sales_by_country"
[0m06:10:08.099044 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (compile): 06:10:08.074242 => 06:10:08.098654
[0m06:10:08.099951 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_country_code_ref
[0m06:10:08.100813 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (compile): 06:10:08.090189 => 06:10:08.100457
[0m06:10:08.112222 [debug] [Thread-3 (]: Began executing node model.bc_sales.stg_sales_by_country
[0m06:10:08.175871 [debug] [Thread-3 (]: Writing runtime sql for node "model.bc_sales.stg_sales_by_country"
[0m06:10:08.178118 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_country_code_ref"
[0m06:10:08.179224 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:10:08.181621 [debug] [Thread-2 (]: Compilation Error in model stg_higher_activity_countries (models/staging/stg_higher_activity_countries.sql)
  'dict object' has no attribute 'get_single_value'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m06:10:08.182921 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bcbf002-ae0f-4c9d-afc7-c0893264946a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe434cd9cf0>]}
[0m06:10:08.183928 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model bandcamp_sales_schema.stg_higher_activity_countries  [[31mERROR[0m in 0.10s]
[0m06:10:08.185472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:10:08.186684 [debug] [Thread-2 (]: Finished running node model.bc_sales.stg_higher_activity_countries
[0m06:10:08.278346 [debug] [Thread-3 (]: On model.bc_sales.stg_sales_by_country: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales_by_country"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
  OPTIONS()
  as 

-- Q1

select
  cast(cc_ref as integer) as cc_ref,
  cast(amount_paid_usd as numeric) as amount_paid_usd,

  cast(country_code as string) as country_code,
  cast(country as string) as country

from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_partitioned`

-- limit 10000;


[0m06:10:08.282028 [debug] [Thread-1 (]: On model.bc_sales.stg_country_code_ref: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_country_code_ref"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`;


[0m06:10:09.295638 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:5e9b4096-9265-40e4-a97f-fb1bca736649&page=queryresults
[0m06:10:09.327713 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (execute): 06:10:08.101239 => 06:10:09.327379
[0m06:10:09.330069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bcbf002-ae0f-4c9d-afc7-c0893264946a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe434813d90>]}
[0m06:10:09.331456 [info ] [Thread-1 (]: 1 of 4 OK created sql view model bandcamp_sales_schema.stg_country_code_ref .... [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m06:10:09.332879 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_country_code_ref
[0m06:10:09.388597 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:7dafff9b-e6aa-4e29-92ca-0113365021c9&page=queryresults
[0m06:10:09.392531 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (execute): 06:10:08.112752 => 06:10:09.392226
[0m06:10:09.393968 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bcbf002-ae0f-4c9d-afc7-c0893264946a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe43481d180>]}
[0m06:10:09.394990 [info ] [Thread-3 (]: 3 of 4 OK created sql view model bandcamp_sales_schema.stg_sales_by_country .... [[32mCREATE VIEW (0 processed)[0m in 1.31s]
[0m06:10:09.396287 [debug] [Thread-3 (]: Finished running node model.bc_sales.stg_sales_by_country
[0m06:10:09.397566 [debug] [Thread-4 (]: Began running node model.bc_sales.country_facts
[0m06:10:09.398561 [info ] [Thread-4 (]: 4 of 4 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m06:10:09.400709 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bc_sales.country_facts'
[0m06:10:09.401233 [debug] [Thread-4 (]: Began compiling node model.bc_sales.country_facts
[0m06:10:09.407334 [debug] [Thread-4 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m06:10:09.408738 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (compile): 06:10:09.401553 => 06:10:09.408307
[0m06:10:09.409318 [debug] [Thread-4 (]: Began executing node model.bc_sales.country_facts
[0m06:10:09.457839 [debug] [Thread-4 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m06:10:09.459706 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:10:09.511497 [debug] [Thread-4 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select *
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
)

select
    cc_ref,
    avg(amount_paid_usd) as average_sale,
    sum(amount_paid_usd) as total_sales,
    from countries
    group by 1
    order by average_sale
    );
  
[0m06:10:11.773235 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:fb03c7d0-e0b4-46af-b87f-aaabf6e087be&page=queryresults
[0m06:10:11.776813 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (execute): 06:10:09.409742 => 06:10:11.776493
[0m06:10:11.778263 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bcbf002-ae0f-4c9d-afc7-c0893264946a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4346e7850>]}
[0m06:10:11.779285 [info ] [Thread-4 (]: 4 of 4 OK created sql table model bandcamp_sales_schema.country_facts .......... [[32mCREATE TABLE (186.0 rows, 15.3 MiB processed)[0m in 2.38s]
[0m06:10:11.780650 [debug] [Thread-4 (]: Finished running node model.bc_sales.country_facts
[0m06:10:11.783387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:10:11.783938 [debug] [MainThread]: Connection 'model.bc_sales.stg_country_code_ref' was properly closed.
[0m06:10:11.784309 [debug] [MainThread]: Connection 'model.bc_sales.stg_higher_activity_countries' was properly closed.
[0m06:10:11.784641 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales_by_country' was properly closed.
[0m06:10:11.784974 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m06:10:11.785414 [info ] [MainThread]: 
[0m06:10:11.786413 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 4.44 seconds (4.44s).
[0m06:10:11.788613 [debug] [MainThread]: Command end result
[0m06:10:11.820366 [info ] [MainThread]: 
[0m06:10:11.822033 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:10:11.823449 [info ] [MainThread]: 
[0m06:10:11.824422 [error] [MainThread]: [33mCompilation Error in model stg_higher_activity_countries (models/staging/stg_higher_activity_countries.sql)[0m
[0m06:10:11.825249 [error] [MainThread]:   'dict object' has no attribute 'get_single_value'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m06:10:11.826158 [info ] [MainThread]: 
[0m06:10:11.827016 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m06:10:11.828405 [debug] [MainThread]: Command `dbt build` failed at 06:10:11.828218 after 5.84 seconds
[0m06:10:11.829035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44824a560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe434ccc520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe434813820>]}
[0m06:10:11.829647 [debug] [MainThread]: Flushing usage events
[0m06:13:11.668866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52fa55e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f91e7760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f91e7730>]}


============================== 06:13:11.672559 | 56ea9285-5c08-4690-bfba-6ddedb67b15b ==============================
[0m06:13:11.672559 [info ] [MainThread]: Running with dbt=1.5.0
[0m06:13:11.673588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:13:12.875987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56ea9285-5c08-4690-bfba-6ddedb67b15b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f91e7820>]}
[0m06:13:12.889272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56ea9285-5c08-4690-bfba-6ddedb67b15b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52e734e770>]}
[0m06:13:12.912208 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m06:13:12.963615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:13:12.964327 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:13:12.965168 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m06:13:12.975189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56ea9285-5c08-4690-bfba-6ddedb67b15b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52e6fa80d0>]}
[0m06:13:12.991082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56ea9285-5c08-4690-bfba-6ddedb67b15b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52e6f7aec0>]}
[0m06:13:12.992694 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 540 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m06:13:12.994214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56ea9285-5c08-4690-bfba-6ddedb67b15b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52e6f7af50>]}
[0m06:13:12.997016 [info ] [MainThread]: 
[0m06:13:12.997872 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:13:12.999960 [debug] [MainThread]: Command end result
[0m06:13:13.013086 [debug] [MainThread]: Command `dbt test` succeeded at 06:13:13.012794 after 1.35 seconds
[0m06:13:13.013862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52fa55e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52e6f78850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52e6f7ab60>]}
[0m06:13:13.014449 [debug] [MainThread]: Flushing usage events
[0m06:13:56.277133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff49e946530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff49d5cf670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff49d5cf6a0>]}


============================== 06:13:56.280978 | cd9face1-c0c0-4d05-bbdb-e0323ac35281 ==============================
[0m06:13:56.280978 [info ] [MainThread]: Running with dbt=1.5.0
[0m06:13:56.283312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/j/.dbt', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:13:56.313914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd9face1-c0c0-4d05-bbdb-e0323ac35281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff49d5cf7c0>]}
[0m06:13:56.315257 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-teyu2k4u'
[0m06:13:56.316098 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:13:56.449454 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:13:56.450450 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:13:56.538516 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:13:56.548775 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:13:56.815866 [info ] [MainThread]: Installed from version 0.8.0
[0m06:13:56.817126 [info ] [MainThread]: Updated version available: 1.1.0
[0m06:13:56.818116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cd9face1-c0c0-4d05-bbdb-e0323ac35281', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff49d41f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff49d41e980>]}
[0m06:13:56.818663 [info ] [MainThread]: 
[0m06:13:56.819493 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:13:56.820915 [debug] [MainThread]: Command `dbt deps` succeeded at 06:13:56.820743 after 0.55 seconds
[0m06:13:56.821612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff49e946530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff49d5cf7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff49d5cf8e0>]}
[0m06:13:56.822193 [debug] [MainThread]: Flushing usage events
[0m06:14:29.972067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280bf6a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280abef640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280abef670>]}


============================== 06:14:29.975902 | 255fec09-5908-4dab-a8a8-9119225b99e1 ==============================
[0m06:14:29.975902 [info ] [MainThread]: Running with dbt=1.5.0
[0m06:14:29.978022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:14:30.006416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '255fec09-5908-4dab-a8a8-9119225b99e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280abef790>]}
[0m06:14:30.007899 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zm56hene'
[0m06:14:30.008727 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:14:30.156913 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:14:30.157794 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:14:30.244381 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:14:30.254886 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:14:30.557197 [info ] [MainThread]: Installed from version 0.9.0
[0m06:14:30.558460 [info ] [MainThread]: Updated version available: 1.1.0
[0m06:14:30.559380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '255fec09-5908-4dab-a8a8-9119225b99e1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280aa40670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280aa42a70>]}
[0m06:14:30.560055 [info ] [MainThread]: 
[0m06:14:30.561109 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:14:30.563346 [debug] [MainThread]: Command `dbt deps` succeeded at 06:14:30.563163 after 0.60 seconds
[0m06:14:30.563976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280bf6a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280abef790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280abef8b0>]}
[0m06:14:30.564503 [debug] [MainThread]: Flushing usage events
[0m06:15:47.819109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ac44a530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ab3cf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ab3cf6a0>]}


============================== 06:15:47.822764 | 30533d7c-c257-4ac7-9c5d-6b8994f18072 ==============================
[0m06:15:47.822764 [info ] [MainThread]: Running with dbt=1.5.0
[0m06:15:47.824549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:15:47.850220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30533d7c-c257-4ac7-9c5d-6b8994f18072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ab3cf7c0>]}
[0m06:15:47.851527 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-11mzm5pz'
[0m06:15:47.852340 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:15:47.969089 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:15:47.969926 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:15:48.054595 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:15:48.064841 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:15:48.359500 [info ] [MainThread]: Installed from version 1.0.0
[0m06:15:48.360923 [info ] [MainThread]: Updated version available: 1.1.0
[0m06:15:48.362029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '30533d7c-c257-4ac7-9c5d-6b8994f18072', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9aaf22980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9aaf23370>]}
[0m06:15:48.362772 [info ] [MainThread]: 
[0m06:15:48.363675 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:15:48.365383 [debug] [MainThread]: Command `dbt deps` succeeded at 06:15:48.365203 after 0.56 seconds
[0m06:15:48.365890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ac44a530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ab3cf7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ab3cf8e0>]}
[0m06:15:48.366395 [debug] [MainThread]: Flushing usage events
[0m06:15:58.299970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ef9f4a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ef8bcf790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ef8bcf760>]}


============================== 06:15:58.303999 | 42cdff3f-78ed-43ff-bf27-aefa83609086 ==============================
[0m06:15:58.303999 [info ] [MainThread]: Running with dbt=1.5.0
[0m06:15:58.305151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'fail_fast': 'False', 'profiles_dir': '/home/j/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:15:59.325491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42cdff3f-78ed-43ff-bf27-aefa83609086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ef8bcf850>]}
[0m06:15:59.338363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42cdff3f-78ed-43ff-bf27-aefa83609086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee6d21240>]}
[0m06:15:59.360736 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m06:15:59.375845 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m06:15:59.376791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '42cdff3f-78ed-43ff-bf27-aefa83609086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee6d11ff0>]}
[0m06:16:00.572482 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_country_code_ref.sql
[0m06:16:00.590803 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_by_country.sql
[0m06:16:00.596734 [debug] [MainThread]: 1603: static parser failed on staging/stg_higher_activity_countries.sql
[0m06:16:00.621067 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_higher_activity_countries.sql
[0m06:16:00.623695 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m06:16:00.808685 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m06:16:00.817227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42cdff3f-78ed-43ff-bf27-aefa83609086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee655dff0>]}
[0m06:16:00.829874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42cdff3f-78ed-43ff-bf27-aefa83609086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee6d2a8f0>]}
[0m06:16:00.830627 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m06:16:00.833432 [info ] [MainThread]: 
[0m06:16:00.834991 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:16:00.836876 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m06:16:00.837535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:16:01.209917 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m06:16:01.210795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:16:01.514902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42cdff3f-78ed-43ff-bf27-aefa83609086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee655fac0>]}
[0m06:16:01.516174 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:16:01.517248 [info ] [MainThread]: 
[0m06:16:01.523219 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_country_code_ref
[0m06:16:01.524867 [debug] [Thread-2 (]: Began running node model.bc_sales.stg_higher_activity_countries
[0m06:16:01.525962 [debug] [Thread-3 (]: Began running node model.bc_sales.stg_sales_by_country
[0m06:16:01.524068 [info ] [Thread-1 (]: 1 of 4 START sql view model bandcamp_sales_schema.stg_country_code_ref ......... [RUN]
[0m06:16:01.528166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.stg_country_code_ref)
[0m06:16:01.528737 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_country_code_ref
[0m06:16:01.525499 [info ] [Thread-2 (]: 2 of 4 START sql view model bandcamp_sales_schema.stg_higher_activity_countries  [RUN]
[0m06:16:01.533818 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_country_code_ref"
[0m06:16:01.526754 [info ] [Thread-3 (]: 3 of 4 START sql view model bandcamp_sales_schema.stg_sales_by_country ......... [RUN]
[0m06:16:01.534963 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now model.bc_sales.stg_higher_activity_countries)
[0m06:16:01.536810 [debug] [Thread-2 (]: Began compiling node model.bc_sales.stg_higher_activity_countries
[0m06:16:01.536283 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales_by_country'
[0m06:16:01.543430 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:16:01.544252 [debug] [Thread-3 (]: Began compiling node model.bc_sales.stg_sales_by_country
[0m06:16:01.550625 [debug] [Thread-3 (]: Writing injected SQL for node "model.bc_sales.stg_sales_by_country"
[0m06:16:01.544966 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (compile): 06:16:01.529347 => 06:16:01.544663
[0m06:16:01.556305 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_country_code_ref
[0m06:16:01.552195 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (compile): 06:16:01.545409 => 06:16:01.551652
[0m06:16:01.570456 [debug] [Thread-3 (]: Began executing node model.bc_sales.stg_sales_by_country
[0m06:16:01.657811 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_country_code_ref"
[0m06:16:01.656829 [debug] [Thread-3 (]: Writing runtime sql for node "model.bc_sales.stg_sales_by_country"
[0m06:16:01.658825 [debug] [Thread-2 (]: On model.bc_sales.stg_higher_activity_countries: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_higher_activity_countries"} */

    select 'cc_ref'
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`
    where 'count' > 20
    order by
	'cc_ref' desc
    limit 1

[0m06:16:01.661426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:16:01.662183 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:16:01.765233 [debug] [Thread-1 (]: On model.bc_sales.stg_country_code_ref: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_country_code_ref"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`;


[0m06:16:01.813861 [debug] [Thread-3 (]: On model.bc_sales.stg_sales_by_country: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales_by_country"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
  OPTIONS()
  as 

-- Q1

select
  cast(cc_ref as integer) as cc_ref,
  cast(amount_paid_usd as numeric) as amount_paid_usd,

  cast(country_code as string) as country_code,
  cast(country as string) as country

from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_partitioned`

-- limit 10000;


[0m06:16:02.566552 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator > for argument types: STRING, INT64. Supported signature: ANY > ANY at [5:11]')
[0m06:16:02.923394 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:691356f4-9eff-4deb-95ec-9a4ea4462683&page=queryresults
[0m06:16:02.946072 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:b77d450b-c496-4023-a6ad-af3f5a15c536&page=queryresults
[0m06:16:02.951449 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (execute): 06:16:01.571119 => 06:16:02.951155
[0m06:16:02.955405 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (execute): 06:16:01.556933 => 06:16:02.955095
[0m06:16:02.956765 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42cdff3f-78ed-43ff-bf27-aefa83609086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee6c43640>]}
[0m06:16:02.958139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42cdff3f-78ed-43ff-bf27-aefa83609086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee6bd1660>]}
[0m06:16:02.959231 [info ] [Thread-3 (]: 3 of 4 OK created sql view model bandcamp_sales_schema.stg_sales_by_country .... [[32mCREATE VIEW (0 processed)[0m in 1.42s]
[0m06:16:02.960520 [info ] [Thread-1 (]: 1 of 4 OK created sql view model bandcamp_sales_schema.stg_country_code_ref .... [[32mCREATE VIEW (0 processed)[0m in 1.43s]
[0m06:16:02.961666 [debug] [Thread-3 (]: Finished running node model.bc_sales.stg_sales_by_country
[0m06:16:02.962929 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_country_code_ref
[0m06:16:02.964241 [debug] [Thread-1 (]: Began running node model.bc_sales.country_facts
[0m06:16:02.965126 [info ] [Thread-1 (]: 4 of 4 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m06:16:02.966788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bc_sales.stg_country_code_ref, now model.bc_sales.country_facts)
[0m06:16:02.967293 [debug] [Thread-1 (]: Began compiling node model.bc_sales.country_facts
[0m06:16:02.972275 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m06:16:02.973246 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (compile): 06:16:02.967603 => 06:16:02.972912
[0m06:16:02.973785 [debug] [Thread-1 (]: Began executing node model.bc_sales.country_facts
[0m06:16:02.989275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:16:03.326842 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m06:16:03.327940 [debug] [Thread-1 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select *
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
)

select
    cc_ref,
    avg(amount_paid_usd) as average_sale,
    sum(amount_paid_usd) as total_sales,
--    country_code,
--    country
    from countries
    group by 1
    order by average_sale
    );
  
[0m06:16:03.811706 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:0893d4f0-0c34-441d-bde7-0d0339630fb2&page=queryresults
[0m06:16:03.814788 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (compile): 06:16:01.537124 => 06:16:03.814370
[0m06:16:03.821171 [debug] [Thread-2 (]: Database Error in model stg_higher_activity_countries (models/staging/stg_higher_activity_countries.sql)
  No matching signature for operator > for argument types: STRING, INT64. Supported signature: ANY > ANY at [5:11]
[0m06:16:03.822008 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42cdff3f-78ed-43ff-bf27-aefa83609086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee6bab220>]}
[0m06:16:03.823118 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model bandcamp_sales_schema.stg_higher_activity_countries  [[31mERROR[0m in 2.29s]
[0m06:16:03.824435 [debug] [Thread-2 (]: Finished running node model.bc_sales.stg_higher_activity_countries
[0m06:16:05.167482 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:2067914d-0204-4f6b-b983-ac390f8fcf9e&page=queryresults
[0m06:16:05.170995 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (execute): 06:16:02.974119 => 06:16:05.170659
[0m06:16:05.172332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42cdff3f-78ed-43ff-bf27-aefa83609086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee6baa9b0>]}
[0m06:16:05.173387 [info ] [Thread-1 (]: 4 of 4 OK created sql table model bandcamp_sales_schema.country_facts .......... [[32mCREATE TABLE (186.0 rows, 15.3 MiB processed)[0m in 2.21s]
[0m06:16:05.175096 [debug] [Thread-1 (]: Finished running node model.bc_sales.country_facts
[0m06:16:05.178322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:16:05.178807 [debug] [MainThread]: Connection 'model.bc_sales.stg_higher_activity_countries' was properly closed.
[0m06:16:05.179150 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m06:16:05.179477 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales_by_country' was properly closed.
[0m06:16:05.180162 [info ] [MainThread]: 
[0m06:16:05.181083 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 4.35 seconds (4.35s).
[0m06:16:05.182772 [debug] [MainThread]: Command end result
[0m06:16:05.214419 [info ] [MainThread]: 
[0m06:16:05.215618 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:16:05.216882 [info ] [MainThread]: 
[0m06:16:05.217958 [error] [MainThread]: [33mDatabase Error in model stg_higher_activity_countries (models/staging/stg_higher_activity_countries.sql)[0m
[0m06:16:05.218687 [error] [MainThread]:   No matching signature for operator > for argument types: STRING, INT64. Supported signature: ANY > ANY at [5:11]
[0m06:16:05.219536 [info ] [MainThread]: 
[0m06:16:05.220299 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m06:16:05.221501 [debug] [MainThread]: Command `dbt build` failed at 06:16:05.221310 after 6.93 seconds
[0m06:16:05.222117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ef9f4a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ef99d4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee6d109d0>]}
[0m06:16:05.222723 [debug] [MainThread]: Flushing usage events
[0m06:19:26.297776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e80572560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e7f1f7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e7f1f77f0>]}


============================== 06:19:26.301619 | 1ee9b2b1-d18b-4f69-8991-94fb022e61e0 ==============================
[0m06:19:26.301619 [info ] [MainThread]: Running with dbt=1.5.0
[0m06:19:26.302677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:19:27.290983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ee9b2b1-d18b-4f69-8991-94fb022e61e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e7f1f78e0>]}
[0m06:19:27.303665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ee9b2b1-d18b-4f69-8991-94fb022e61e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e6d0d9f90>]}
[0m06:19:27.325652 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m06:19:27.367172 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:19:27.368314 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/staging/stg_higher_activity_countries.sql
[0m06:19:27.390643 [debug] [MainThread]: 1603: static parser failed on staging/stg_higher_activity_countries.sql
[0m06:19:27.425443 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_higher_activity_countries.sql
[0m06:19:27.434937 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m06:19:27.443240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ee9b2b1-d18b-4f69-8991-94fb022e61e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e6cfa40d0>]}
[0m06:19:27.457155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ee9b2b1-d18b-4f69-8991-94fb022e61e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e6cf5c100>]}
[0m06:19:27.457962 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m06:19:27.460487 [info ] [MainThread]: 
[0m06:19:27.461888 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:19:27.463861 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m06:19:27.464574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:19:27.818621 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m06:19:27.819487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:19:28.129972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ee9b2b1-d18b-4f69-8991-94fb022e61e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e6cf5c130>]}
[0m06:19:28.131148 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:19:28.131916 [info ] [MainThread]: 
[0m06:19:28.137107 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_country_code_ref
[0m06:19:28.137944 [info ] [Thread-1 (]: 1 of 4 START sql view model bandcamp_sales_schema.stg_country_code_ref ......... [RUN]
[0m06:19:28.139357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.stg_country_code_ref)
[0m06:19:28.140050 [debug] [Thread-2 (]: Began running node model.bc_sales.stg_higher_activity_countries
[0m06:19:28.141949 [info ] [Thread-2 (]: 2 of 4 START sql view model bandcamp_sales_schema.stg_higher_activity_countries  [RUN]
[0m06:19:28.141277 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_country_code_ref
[0m06:19:28.140791 [debug] [Thread-3 (]: Began running node model.bc_sales.stg_sales_by_country
[0m06:19:28.143104 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now model.bc_sales.stg_higher_activity_countries)
[0m06:19:28.148047 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_country_code_ref"
[0m06:19:28.149883 [debug] [Thread-2 (]: Began compiling node model.bc_sales.stg_higher_activity_countries
[0m06:19:28.149018 [info ] [Thread-3 (]: 3 of 4 START sql view model bandcamp_sales_schema.stg_sales_by_country ......... [RUN]
[0m06:19:28.156638 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:19:28.157970 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales_by_country'
[0m06:19:28.160239 [debug] [Thread-3 (]: Began compiling node model.bc_sales.stg_sales_by_country
[0m06:19:28.159595 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (compile): 06:19:28.143526 => 06:19:28.159112
[0m06:19:28.168336 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_country_code_ref
[0m06:19:28.165014 [debug] [Thread-3 (]: Writing injected SQL for node "model.bc_sales.stg_sales_by_country"
[0m06:19:28.175359 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (compile): 06:19:28.160645 => 06:19:28.174762
[0m06:19:28.176245 [debug] [Thread-3 (]: Began executing node model.bc_sales.stg_sales_by_country
[0m06:19:28.264340 [debug] [Thread-3 (]: Writing runtime sql for node "model.bc_sales.stg_sales_by_country"
[0m06:19:28.265154 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_country_code_ref"
[0m06:19:28.266195 [debug] [Thread-2 (]: On model.bc_sales.stg_higher_activity_countries: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_higher_activity_countries"} */

    select 'cc_ref'
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`
    where 'count' < 20
    order by
	'cc_ref' desc
    limit 1

[0m06:19:28.268417 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:19:28.275575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:19:28.361901 [debug] [Thread-3 (]: On model.bc_sales.stg_sales_by_country: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales_by_country"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
  OPTIONS()
  as 

-- Q1

select
  cast(cc_ref as integer) as cc_ref,
  cast(amount_paid_usd as numeric) as amount_paid_usd,

  cast(country_code as string) as country_code,
  cast(country as string) as country

from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_partitioned`

-- limit 10000;


[0m06:19:28.414994 [debug] [Thread-1 (]: On model.bc_sales.stg_country_code_ref: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_country_code_ref"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`;


[0m06:19:28.969559 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator < for argument types: STRING, INT64. Supported signature: ANY < ANY at [5:11]')
[0m06:19:29.393853 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:2d3de1a3-19eb-4c51-8924-e4cdf7fd120e&page=queryresults
[0m06:19:29.396329 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (compile): 06:19:28.150662 => 06:19:29.395902
[0m06:19:29.401413 [debug] [Thread-2 (]: Database Error in model stg_higher_activity_countries (models/staging/stg_higher_activity_countries.sql)
  No matching signature for operator < for argument types: STRING, INT64. Supported signature: ANY < ANY at [5:11]
[0m06:19:29.402227 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ee9b2b1-d18b-4f69-8991-94fb022e61e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e6ce12f20>]}
[0m06:19:29.403130 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model bandcamp_sales_schema.stg_higher_activity_countries  [[31mERROR[0m in 1.26s]
[0m06:19:29.404368 [debug] [Thread-2 (]: Finished running node model.bc_sales.stg_higher_activity_countries
[0m06:19:29.449489 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:9db033ca-2ee0-4407-b53b-9ff7eb31ed30&page=queryresults
[0m06:19:29.472839 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (execute): 06:19:28.168907 => 06:19:29.472549
[0m06:19:29.474944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ee9b2b1-d18b-4f69-8991-94fb022e61e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e6ce3d240>]}
[0m06:19:29.476028 [info ] [Thread-1 (]: 1 of 4 OK created sql view model bandcamp_sales_schema.stg_country_code_ref .... [[32mCREATE VIEW (0 processed)[0m in 1.34s]
[0m06:19:29.477208 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_country_code_ref
[0m06:19:29.479121 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:06ee7910-3478-4875-8a48-b94a3e3972d9&page=queryresults
[0m06:19:29.482086 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (execute): 06:19:28.176681 => 06:19:29.481823
[0m06:19:29.483082 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ee9b2b1-d18b-4f69-8991-94fb022e61e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e6d0affd0>]}
[0m06:19:29.483916 [info ] [Thread-3 (]: 3 of 4 OK created sql view model bandcamp_sales_schema.stg_sales_by_country .... [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m06:19:29.485455 [debug] [Thread-3 (]: Finished running node model.bc_sales.stg_sales_by_country
[0m06:19:29.486857 [debug] [Thread-4 (]: Began running node model.bc_sales.country_facts
[0m06:19:29.487727 [info ] [Thread-4 (]: 4 of 4 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m06:19:29.489422 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bc_sales.country_facts'
[0m06:19:29.489925 [debug] [Thread-4 (]: Began compiling node model.bc_sales.country_facts
[0m06:19:29.494992 [debug] [Thread-4 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m06:19:29.496037 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (compile): 06:19:29.490225 => 06:19:29.495659
[0m06:19:29.496639 [debug] [Thread-4 (]: Began executing node model.bc_sales.country_facts
[0m06:19:29.512019 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:19:29.850537 [debug] [Thread-4 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m06:19:29.851503 [debug] [Thread-4 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select *
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
)

select
    cc_ref,
    avg(amount_paid_usd) as average_sale,
    sum(amount_paid_usd) as total_sales,
--    country_code,
--    country
    from countries
    group by 1
    order by average_sale
    );
  
[0m06:19:31.725143 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:5b8cb7c9-e469-4bc2-a01c-e560292c5ee2&page=queryresults
[0m06:19:31.728722 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (execute): 06:19:29.496988 => 06:19:31.728355
[0m06:19:31.730118 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ee9b2b1-d18b-4f69-8991-94fb022e61e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e6c5abe20>]}
[0m06:19:31.731199 [info ] [Thread-4 (]: 4 of 4 OK created sql table model bandcamp_sales_schema.country_facts .......... [[32mCREATE TABLE (186.0 rows, 15.3 MiB processed)[0m in 2.24s]
[0m06:19:31.732579 [debug] [Thread-4 (]: Finished running node model.bc_sales.country_facts
[0m06:19:31.736130 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:19:31.736746 [debug] [MainThread]: Connection 'model.bc_sales.stg_higher_activity_countries' was properly closed.
[0m06:19:31.737159 [debug] [MainThread]: Connection 'model.bc_sales.stg_country_code_ref' was properly closed.
[0m06:19:31.737494 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales_by_country' was properly closed.
[0m06:19:31.737830 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m06:19:31.738489 [info ] [MainThread]: 
[0m06:19:31.739541 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 4.28 seconds (4.28s).
[0m06:19:31.741405 [debug] [MainThread]: Command end result
[0m06:19:31.768219 [info ] [MainThread]: 
[0m06:19:31.769824 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:19:31.770900 [info ] [MainThread]: 
[0m06:19:31.771695 [error] [MainThread]: [33mDatabase Error in model stg_higher_activity_countries (models/staging/stg_higher_activity_countries.sql)[0m
[0m06:19:31.772632 [error] [MainThread]:   No matching signature for operator < for argument types: STRING, INT64. Supported signature: ANY < ANY at [5:11]
[0m06:19:31.773409 [info ] [MainThread]: 
[0m06:19:31.774168 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m06:19:31.775405 [debug] [MainThread]: Command `dbt build` failed at 06:19:31.775228 after 5.49 seconds
[0m06:19:31.776024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e80572560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e6cf0f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e6cf5c160>]}
[0m06:19:31.776830 [debug] [MainThread]: Flushing usage events
[0m06:22:26.824680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb105b76530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1047ff7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1047ff7c0>]}


============================== 06:22:26.828492 | 3d642146-1f8e-4da8-9b22-1b3fb4fd6376 ==============================
[0m06:22:26.828492 [info ] [MainThread]: Running with dbt=1.5.0
[0m06:22:26.829563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:22:27.848764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d642146-1f8e-4da8-9b22-1b3fb4fd6376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1047ff8b0>]}
[0m06:22:27.861871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d642146-1f8e-4da8-9b22-1b3fb4fd6376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f28d1240>]}
[0m06:22:27.884355 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m06:22:27.926544 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:22:27.927526 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/staging/stg_higher_activity_countries.sql
[0m06:22:27.953421 [debug] [MainThread]: 1603: static parser failed on staging/stg_higher_activity_countries.sql
[0m06:22:27.992249 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_higher_activity_countries.sql
[0m06:22:28.002123 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m06:22:28.010969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d642146-1f8e-4da8-9b22-1b3fb4fd6376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f25ac0d0>]}
[0m06:22:28.024984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d642146-1f8e-4da8-9b22-1b3fb4fd6376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f2507700>]}
[0m06:22:28.025851 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m06:22:28.028339 [info ] [MainThread]: 
[0m06:22:28.029662 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:22:28.031450 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m06:22:28.032288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:22:28.400900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m06:22:28.401780 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:22:28.701623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d642146-1f8e-4da8-9b22-1b3fb4fd6376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f2554160>]}
[0m06:22:28.702896 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:22:28.703739 [info ] [MainThread]: 
[0m06:22:28.709449 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_country_code_ref
[0m06:22:28.710359 [info ] [Thread-1 (]: 1 of 4 START sql view model bandcamp_sales_schema.stg_country_code_ref ......... [RUN]
[0m06:22:28.712041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.stg_country_code_ref)
[0m06:22:28.712801 [debug] [Thread-2 (]: Began running node model.bc_sales.stg_higher_activity_countries
[0m06:22:28.714822 [info ] [Thread-2 (]: 2 of 4 START sql view model bandcamp_sales_schema.stg_higher_activity_countries  [RUN]
[0m06:22:28.714056 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_country_code_ref
[0m06:22:28.713416 [debug] [Thread-3 (]: Began running node model.bc_sales.stg_sales_by_country
[0m06:22:28.716413 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bc_sales.stg_higher_activity_countries'
[0m06:22:28.721406 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_country_code_ref"
[0m06:22:28.723201 [debug] [Thread-2 (]: Began compiling node model.bc_sales.stg_higher_activity_countries
[0m06:22:28.722342 [info ] [Thread-3 (]: 3 of 4 START sql view model bandcamp_sales_schema.stg_sales_by_country ......... [RUN]
[0m06:22:28.730564 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m06:22:28.732168 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales_by_country'
[0m06:22:28.733057 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (compile): 06:22:28.716931 => 06:22:28.732693
[0m06:22:28.734236 [debug] [Thread-3 (]: Began compiling node model.bc_sales.stg_sales_by_country
[0m06:22:28.736467 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_country_code_ref
[0m06:22:28.743411 [debug] [Thread-3 (]: Writing injected SQL for node "model.bc_sales.stg_sales_by_country"
[0m06:22:28.758099 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (compile): 06:22:28.737054 => 06:22:28.757420
[0m06:22:28.759389 [debug] [Thread-3 (]: Began executing node model.bc_sales.stg_sales_by_country
[0m06:22:28.841458 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_country_code_ref"
[0m06:22:28.842484 [debug] [Thread-3 (]: Writing runtime sql for node "model.bc_sales.stg_sales_by_country"
[0m06:22:28.843168 [debug] [Thread-2 (]: On model.bc_sales.stg_higher_activity_countries: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_higher_activity_countries"} */

    select cc_ref
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`
    where count > 20
    order by
	cc_ref desc
    limit 1

[0m06:22:28.845596 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:22:28.846849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:22:28.987241 [debug] [Thread-3 (]: On model.bc_sales.stg_sales_by_country: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales_by_country"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
  OPTIONS()
  as 

-- Q1

select
  cast(cc_ref as integer) as cc_ref,
  cast(amount_paid_usd as numeric) as amount_paid_usd,

  cast(country_code as string) as country_code,
  cast(country as string) as country

from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_partitioned`

-- limit 10000;


[0m06:22:29.022531 [debug] [Thread-1 (]: On model.bc_sales.stg_country_code_ref: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_country_code_ref"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`;


[0m06:22:29.965916 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:88eff57f-e4e7-4eec-8a57-3d871d1a76a1&page=queryresults
[0m06:22:29.989804 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (execute): 06:22:28.744178 => 06:22:29.989489
[0m06:22:29.991177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d642146-1f8e-4da8-9b22-1b3fb4fd6376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f2420f70>]}
[0m06:22:29.993084 [info ] [Thread-1 (]: 1 of 4 OK created sql view model bandcamp_sales_schema.stg_country_code_ref .... [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m06:22:29.994428 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_country_code_ref
[0m06:22:29.996509 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:dbcd2241-2104-4b5e-9eac-7da05aa50937&page=queryresults
[0m06:22:29.999501 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (execute): 06:22:28.760195 => 06:22:29.999227
[0m06:22:30.000637 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d642146-1f8e-4da8-9b22-1b3fb4fd6376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f245f6d0>]}
[0m06:22:30.001522 [info ] [Thread-3 (]: 3 of 4 OK created sql view model bandcamp_sales_schema.stg_sales_by_country .... [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m06:22:30.003179 [debug] [Thread-3 (]: Finished running node model.bc_sales.stg_sales_by_country
[0m06:22:30.004392 [debug] [Thread-4 (]: Began running node model.bc_sales.country_facts
[0m06:22:30.005224 [info ] [Thread-4 (]: 4 of 4 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m06:22:30.006734 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bc_sales.country_facts'
[0m06:22:30.007255 [debug] [Thread-4 (]: Began compiling node model.bc_sales.country_facts
[0m06:22:30.013005 [debug] [Thread-4 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m06:22:30.014106 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (compile): 06:22:30.007559 => 06:22:30.013748
[0m06:22:30.014631 [debug] [Thread-4 (]: Began executing node model.bc_sales.country_facts
[0m06:22:30.030737 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:22:30.144199 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:ddc03b81-16af-43fe-b686-b1e8016c9047&page=queryresults
[0m06:22:30.145900 [debug] [Thread-2 (]: Writing injected SQL for node "model.bc_sales.stg_higher_activity_countries"
[0m06:22:30.147286 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (compile): 06:22:28.724050 => 06:22:30.146782
[0m06:22:30.148104 [debug] [Thread-2 (]: Began executing node model.bc_sales.stg_higher_activity_countries
[0m06:22:30.158421 [debug] [Thread-2 (]: Writing runtime sql for node "model.bc_sales.stg_higher_activity_countries"
[0m06:22:30.159841 [debug] [Thread-2 (]: On model.bc_sales.stg_higher_activity_countries: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_higher_activity_countries"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_higher_activity_countries`
  OPTIONS()
  as 

-- Q2, Q3

select
    cast(cc_ref as integer) as cc_ref,
    cast(artist_name as string) as artist_name,
    cast(amount_paid_usd as numeric) as amount_paid_usd,
    cast(country_code as string) as country_code,
    cast(country as string) as country
from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_clustered`
where cc_ref <= '115'
order by
    cc_ref asc,
    artist_name asc;


[0m06:22:30.398225 [debug] [Thread-4 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m06:22:30.399232 [debug] [Thread-4 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select *
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
)

select
    cc_ref,
    avg(amount_paid_usd) as average_sale,
    sum(amount_paid_usd) as total_sales,
--    country_code,
--    country
    from countries
    group by 1
    order by average_sale
    );
  
[0m06:22:30.446884 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator <= for argument types: INT64, STRING. Supported signature: ANY <= ANY at [17:7]')
[0m06:22:31.422167 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:aca3f1b2-15cf-4aff-8677-8a417f99223c&page=queryresults
[0m06:22:31.423953 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (execute): 06:22:30.148617 => 06:22:31.423404
[0m06:22:31.428906 [debug] [Thread-2 (]: Database Error in model stg_higher_activity_countries (models/staging/stg_higher_activity_countries.sql)
  No matching signature for operator <= for argument types: INT64, STRING. Supported signature: ANY <= ANY at [17:7]
  compiled Code at target/run/bc_sales/models/staging/stg_higher_activity_countries.sql
[0m06:22:31.429899 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d642146-1f8e-4da8-9b22-1b3fb4fd6376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f2615ab0>]}
[0m06:22:31.430954 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model bandcamp_sales_schema.stg_higher_activity_countries  [[31mERROR[0m in 2.71s]
[0m06:22:31.432038 [debug] [Thread-2 (]: Finished running node model.bc_sales.stg_higher_activity_countries
[0m06:22:32.125764 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:56cb95f9-adf4-4263-a53d-a57c87e2b816&page=queryresults
[0m06:22:32.129246 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (execute): 06:22:30.015066 => 06:22:32.128918
[0m06:22:32.130452 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d642146-1f8e-4da8-9b22-1b3fb4fd6376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f24af580>]}
[0m06:22:32.131411 [info ] [Thread-4 (]: 4 of 4 OK created sql table model bandcamp_sales_schema.country_facts .......... [[32mCREATE TABLE (186.0 rows, 15.3 MiB processed)[0m in 2.12s]
[0m06:22:32.132729 [debug] [Thread-4 (]: Finished running node model.bc_sales.country_facts
[0m06:22:32.135525 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:22:32.136058 [debug] [MainThread]: Connection 'model.bc_sales.stg_country_code_ref' was properly closed.
[0m06:22:32.136408 [debug] [MainThread]: Connection 'model.bc_sales.stg_higher_activity_countries' was properly closed.
[0m06:22:32.136720 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales_by_country' was properly closed.
[0m06:22:32.137032 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m06:22:32.137466 [info ] [MainThread]: 
[0m06:22:32.138420 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 4.11 seconds (4.11s).
[0m06:22:32.140222 [debug] [MainThread]: Command end result
[0m06:22:32.154229 [info ] [MainThread]: 
[0m06:22:32.155386 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:22:32.156199 [info ] [MainThread]: 
[0m06:22:32.156941 [error] [MainThread]: [33mDatabase Error in model stg_higher_activity_countries (models/staging/stg_higher_activity_countries.sql)[0m
[0m06:22:32.157564 [error] [MainThread]:   No matching signature for operator <= for argument types: INT64, STRING. Supported signature: ANY <= ANY at [17:7]
[0m06:22:32.158176 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/staging/stg_higher_activity_countries.sql
[0m06:22:32.158800 [info ] [MainThread]: 
[0m06:22:32.159431 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m06:22:32.160540 [debug] [MainThread]: Command `dbt build` failed at 06:22:32.160358 after 5.35 seconds
[0m06:22:32.161076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb105b76530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f28d1240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f26c8580>]}
[0m06:22:32.161619 [debug] [MainThread]: Flushing usage events
[0m06:23:28.060135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ffb5a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55fe7e3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55fe7e3820>]}


============================== 06:23:28.063850 | 57712c45-bf4c-4eeb-843c-1f11950f375e ==============================
[0m06:23:28.063850 [info ] [MainThread]: Running with dbt=1.5.0
[0m06:23:28.065880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'debug': 'False', 'profiles_dir': '/home/j/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:23:29.074822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57712c45-bf4c-4eeb-843c-1f11950f375e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55fe7e3910>]}
[0m06:23:29.087518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57712c45-bf4c-4eeb-843c-1f11950f375e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ec9edf30>]}
[0m06:23:29.109349 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m06:23:29.150303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:23:29.151232 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/staging/stg_higher_activity_countries.sql
[0m06:23:29.172674 [debug] [MainThread]: 1603: static parser failed on staging/stg_higher_activity_countries.sql
[0m06:23:29.208445 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_higher_activity_countries.sql
[0m06:23:29.218352 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m06:23:29.226328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57712c45-bf4c-4eeb-843c-1f11950f375e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ec6c80d0>]}
[0m06:23:29.241033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57712c45-bf4c-4eeb-843c-1f11950f375e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ec67c100>]}
[0m06:23:29.241862 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m06:23:29.244405 [info ] [MainThread]: 
[0m06:23:29.245729 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:23:29.247545 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m06:23:29.248240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:23:29.605669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m06:23:29.606491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:23:29.907551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57712c45-bf4c-4eeb-843c-1f11950f375e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ec67c130>]}
[0m06:23:29.908909 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:23:29.909657 [info ] [MainThread]: 
[0m06:23:29.914803 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_country_code_ref
[0m06:23:29.915591 [info ] [Thread-1 (]: 1 of 4 START sql view model bandcamp_sales_schema.stg_country_code_ref ......... [RUN]
[0m06:23:29.917102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.stg_country_code_ref)
[0m06:23:29.917691 [debug] [Thread-2 (]: Began running node model.bc_sales.stg_higher_activity_countries
[0m06:23:29.918163 [debug] [Thread-3 (]: Began running node model.bc_sales.stg_sales_by_country
[0m06:23:29.918717 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_country_code_ref
[0m06:23:29.919487 [info ] [Thread-2 (]: 2 of 4 START sql view model bandcamp_sales_schema.stg_higher_activity_countries  [RUN]
[0m06:23:29.920489 [info ] [Thread-3 (]: 3 of 4 START sql view model bandcamp_sales_schema.stg_sales_by_country ......... [RUN]
[0m06:23:29.928759 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales_by_country'
[0m06:23:29.927339 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bc_sales.stg_higher_activity_countries'
[0m06:23:29.929915 [debug] [Thread-2 (]: Began compiling node model.bc_sales.stg_higher_activity_countries
[0m06:23:29.929351 [debug] [Thread-3 (]: Began compiling node model.bc_sales.stg_sales_by_country
[0m06:23:29.925942 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_country_code_ref"
[0m06:23:29.942630 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (compile): 06:23:29.921364 => 06:23:29.942266
[0m06:23:29.941449 [debug] [Thread-3 (]: Writing injected SQL for node "model.bc_sales.stg_sales_by_country"
[0m06:23:29.936642 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m06:23:29.943311 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_country_code_ref
[0m06:23:29.945002 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (compile): 06:23:29.937197 => 06:23:29.944555
[0m06:23:29.952700 [debug] [Thread-3 (]: Began executing node model.bc_sales.stg_sales_by_country
[0m06:23:30.047114 [debug] [Thread-3 (]: Writing runtime sql for node "model.bc_sales.stg_sales_by_country"
[0m06:23:30.048163 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_country_code_ref"
[0m06:23:30.048812 [debug] [Thread-2 (]: On model.bc_sales.stg_higher_activity_countries: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_higher_activity_countries"} */

    select cc_ref
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`
    where count > 20
    order by
	cc_ref desc
    limit 1

[0m06:23:30.050154 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:23:30.052515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:23:30.148740 [debug] [Thread-1 (]: On model.bc_sales.stg_country_code_ref: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_country_code_ref"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`;


[0m06:23:30.194684 [debug] [Thread-3 (]: On model.bc_sales.stg_sales_by_country: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales_by_country"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
  OPTIONS()
  as 

-- Q1

select
  cast(cc_ref as integer) as cc_ref,
  cast(amount_paid_usd as numeric) as amount_paid_usd,

  cast(country_code as string) as country_code,
  cast(country as string) as country

from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_partitioned`

-- limit 10000;


[0m06:23:31.197664 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:e9cf9eee-c083-4505-859b-306a8b59524e&page=queryresults
[0m06:23:31.223254 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (execute): 06:23:29.953314 => 06:23:31.222673
[0m06:23:31.224590 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57712c45-bf4c-4eeb-843c-1f11950f375e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ff7d92d0>]}
[0m06:23:31.226450 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:584652c5-d82e-4f32-aac5-7ce7c2aa8ede&page=queryresults
[0m06:23:31.230702 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (execute): 06:23:29.945504 => 06:23:31.230417
[0m06:23:31.227438 [info ] [Thread-3 (]: 3 of 4 OK created sql view model bandcamp_sales_schema.stg_sales_by_country .... [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m06:23:31.232152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57712c45-bf4c-4eeb-843c-1f11950f375e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ec55cf40>]}
[0m06:23:31.233116 [debug] [Thread-3 (]: Finished running node model.bc_sales.stg_sales_by_country
[0m06:23:31.234089 [info ] [Thread-1 (]: 1 of 4 OK created sql view model bandcamp_sales_schema.stg_country_code_ref .... [[32mCREATE VIEW (0 processed)[0m in 1.32s]
[0m06:23:31.235680 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_country_code_ref
[0m06:23:31.236584 [debug] [Thread-4 (]: Began running node model.bc_sales.country_facts
[0m06:23:31.237476 [info ] [Thread-4 (]: 4 of 4 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m06:23:31.239915 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bc_sales.country_facts'
[0m06:23:31.240505 [debug] [Thread-4 (]: Began compiling node model.bc_sales.country_facts
[0m06:23:31.241331 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:84d14540-0d01-4fe7-819d-a052f69db12a&page=queryresults
[0m06:23:31.246304 [debug] [Thread-4 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m06:23:31.247481 [debug] [Thread-2 (]: Writing injected SQL for node "model.bc_sales.stg_higher_activity_countries"
[0m06:23:31.248804 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (compile): 06:23:31.241719 => 06:23:31.248418
[0m06:23:31.249568 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (compile): 06:23:29.930260 => 06:23:31.249223
[0m06:23:31.250204 [debug] [Thread-4 (]: Began executing node model.bc_sales.country_facts
[0m06:23:31.250811 [debug] [Thread-2 (]: Began executing node model.bc_sales.stg_higher_activity_countries
[0m06:23:31.272847 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:23:31.271739 [debug] [Thread-2 (]: Writing runtime sql for node "model.bc_sales.stg_higher_activity_countries"
[0m06:23:31.274916 [debug] [Thread-2 (]: On model.bc_sales.stg_higher_activity_countries: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_higher_activity_countries"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_higher_activity_countries`
  OPTIONS()
  as 

-- Q2, Q3

select
    cast(cc_ref as integer) as cc_ref,
    cast(artist_name as string) as artist_name,
    cast(amount_paid_usd as numeric) as amount_paid_usd,
    cast(country_code as string) as country_code,
    cast(country as string) as country
from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_clustered`
where cc_ref <= 115
order by
    cc_ref asc,
    artist_name asc;


[0m06:23:31.628640 [debug] [Thread-4 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m06:23:31.629619 [debug] [Thread-4 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select *
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
)

select
    cc_ref,
    avg(amount_paid_usd) as average_sale,
    sum(amount_paid_usd) as total_sales,
--    country_code,
--    country
    from countries
    group by 1
    order by average_sale
    );
  
[0m06:23:31.818482 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:a7aacce9-be11-4dea-aded-f72e74b34893&page=queryresults
[0m06:23:31.821366 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (execute): 06:23:31.266965 => 06:23:31.821063
[0m06:23:31.822510 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57712c45-bf4c-4eeb-843c-1f11950f375e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ec72f370>]}
[0m06:23:31.823426 [info ] [Thread-2 (]: 2 of 4 OK created sql view model bandcamp_sales_schema.stg_higher_activity_countries  [[32mCREATE VIEW (0 processed)[0m in 1.90s]
[0m06:23:31.824613 [debug] [Thread-2 (]: Finished running node model.bc_sales.stg_higher_activity_countries
[0m06:23:33.715751 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:c805c42f-e489-4ecf-ac78-f478a2208315&page=queryresults
[0m06:23:33.719240 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (execute): 06:23:31.251201 => 06:23:33.718900
[0m06:23:33.720487 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57712c45-bf4c-4eeb-843c-1f11950f375e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ec55cf40>]}
[0m06:23:33.721510 [info ] [Thread-4 (]: 4 of 4 OK created sql table model bandcamp_sales_schema.country_facts .......... [[32mCREATE TABLE (186.0 rows, 15.3 MiB processed)[0m in 2.48s]
[0m06:23:33.723197 [debug] [Thread-4 (]: Finished running node model.bc_sales.country_facts
[0m06:23:33.726250 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:23:33.726750 [debug] [MainThread]: Connection 'model.bc_sales.stg_country_code_ref' was properly closed.
[0m06:23:33.727079 [debug] [MainThread]: Connection 'model.bc_sales.stg_higher_activity_countries' was properly closed.
[0m06:23:33.727396 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales_by_country' was properly closed.
[0m06:23:33.727711 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m06:23:33.728237 [info ] [MainThread]: 
[0m06:23:33.728948 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m06:23:33.730780 [debug] [MainThread]: Command end result
[0m06:23:33.760850 [info ] [MainThread]: 
[0m06:23:33.762017 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:23:33.762774 [info ] [MainThread]: 
[0m06:23:33.763537 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m06:23:33.764671 [debug] [MainThread]: Command `dbt build` succeeded at 06:23:33.764495 after 5.71 seconds
[0m06:23:33.765184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ffb5a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ec654040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ec62f760>]}
[0m06:23:33.765760 [debug] [MainThread]: Flushing usage events
[0m06:51:04.497237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb58aa3e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5896c37f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5896c3820>]}


============================== 06:51:04.500850 | b7b37669-3044-48a6-b785-ffe87fbaca59 ==============================
[0m06:51:04.500850 [info ] [MainThread]: Running with dbt=1.5.0
[0m06:51:04.501849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:51:05.514789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7b37669-3044-48a6-b785-ffe87fbaca59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5896c3910>]}
[0m06:51:05.527589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7b37669-3044-48a6-b785-ffe87fbaca59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb57781ebf0>]}
[0m06:51:05.550898 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m06:51:05.592009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:51:05.593031 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts.sql
[0m06:51:05.615600 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m06:51:05.645081 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bc_sales.country_facts' (models/core/country_facts.sql) depends on a node named 'stg_country_code' which was not found
[0m06:51:05.646529 [debug] [MainThread]: Command `dbt build` failed at 06:51:05.646303 after 1.16 seconds
[0m06:51:05.647210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb58aa3e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5776305e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb577826e90>]}
[0m06:51:05.647759 [debug] [MainThread]: Flushing usage events
[0m06:51:55.409629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1efa4a530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ee9d37f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ee9d37c0>]}


============================== 06:51:55.413346 | 1d74584f-d68b-443a-979b-c6ce273efc1d ==============================
[0m06:51:55.413346 [info ] [MainThread]: Running with dbt=1.5.0
[0m06:51:55.414632 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'fail_fast': 'False', 'profiles_dir': '/home/j/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:51:56.432259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d74584f-d68b-443a-979b-c6ce273efc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ee9d38b0>]}
[0m06:51:56.445066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d74584f-d68b-443a-979b-c6ce273efc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1dc819240>]}
[0m06:51:56.467347 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m06:51:56.508926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:51:56.509870 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts.sql
[0m06:51:56.532500 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m06:51:56.570902 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m06:51:56.578773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d74584f-d68b-443a-979b-c6ce273efc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1dc4a7df0>]}
[0m06:51:56.591186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d74584f-d68b-443a-979b-c6ce273efc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1dc610c10>]}
[0m06:51:56.592081 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m06:51:56.594499 [info ] [MainThread]: 
[0m06:51:56.595939 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:51:56.597776 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m06:51:56.598433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:51:56.965719 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m06:51:56.966528 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:51:57.258799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d74584f-d68b-443a-979b-c6ce273efc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1dc5ce620>]}
[0m06:51:57.260141 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:51:57.260906 [info ] [MainThread]: 
[0m06:51:57.266236 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_country_code_ref
[0m06:51:57.267073 [info ] [Thread-1 (]: 1 of 4 START sql view model bandcamp_sales_schema.stg_country_code_ref ......... [RUN]
[0m06:51:57.268495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.stg_country_code_ref)
[0m06:51:57.269103 [debug] [Thread-2 (]: Began running node model.bc_sales.stg_higher_activity_countries
[0m06:51:57.270726 [info ] [Thread-2 (]: 2 of 4 START sql view model bandcamp_sales_schema.stg_higher_activity_countries  [RUN]
[0m06:51:57.270099 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_country_code_ref
[0m06:51:57.269595 [debug] [Thread-3 (]: Began running node model.bc_sales.stg_sales_by_country
[0m06:51:57.272149 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bc_sales.stg_higher_activity_countries'
[0m06:51:57.277829 [debug] [Thread-2 (]: Began compiling node model.bc_sales.stg_higher_activity_countries
[0m06:51:57.276934 [info ] [Thread-3 (]: 3 of 4 START sql view model bandcamp_sales_schema.stg_sales_by_country ......... [RUN]
[0m06:51:57.298137 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales_by_country'
[0m06:51:57.298975 [debug] [Thread-3 (]: Began compiling node model.bc_sales.stg_sales_by_country
[0m06:51:57.305169 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m06:51:57.310207 [debug] [Thread-3 (]: Writing injected SQL for node "model.bc_sales.stg_sales_by_country"
[0m06:51:57.315158 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_country_code_ref"
[0m06:51:57.316991 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (compile): 06:51:57.305667 => 06:51:57.316531
[0m06:51:57.319206 [debug] [Thread-3 (]: Began executing node model.bc_sales.stg_sales_by_country
[0m06:51:57.318326 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (compile): 06:51:57.272582 => 06:51:57.317849
[0m06:51:57.329506 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_country_code_ref
[0m06:51:57.414628 [debug] [Thread-3 (]: Writing runtime sql for node "model.bc_sales.stg_sales_by_country"
[0m06:51:57.417999 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_country_code_ref"
[0m06:51:57.418790 [debug] [Thread-2 (]: On model.bc_sales.stg_higher_activity_countries: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_higher_activity_countries"} */

    select cc_ref
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`
    where count > 20
    order by
	cc_ref desc
    limit 1

[0m06:51:57.421341 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:51:57.422680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:51:57.517587 [debug] [Thread-1 (]: On model.bc_sales.stg_country_code_ref: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_country_code_ref"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`;


[0m06:51:57.567875 [debug] [Thread-3 (]: On model.bc_sales.stg_sales_by_country: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales_by_country"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
  OPTIONS()
  as 

-- Q1

select
  cast(cc_ref as integer) as cc_ref,
  cast(amount_paid_usd as numeric) as amount_paid_usd,

  cast(country_code as string) as country_code,
  cast(country as string) as country

from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_partitioned`

-- limit 10000;


[0m06:51:58.629200 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:d4f96f75-90fb-428b-b6ef-5ca5b4a9dcc9&page=queryresults
[0m06:51:58.653637 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (execute): 06:51:57.330163 => 06:51:58.653338
[0m06:51:58.655214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d74584f-d68b-443a-979b-c6ce273efc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d7f5f2e0>]}
[0m06:51:58.656446 [info ] [Thread-1 (]: 1 of 4 OK created sql view model bandcamp_sales_schema.stg_country_code_ref .... [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m06:51:58.657685 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_country_code_ref
[0m06:51:58.659607 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:dfddf3de-179c-4f30-8106-73a9d6765d9e&page=queryresults
[0m06:51:58.662568 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (execute): 06:51:57.319665 => 06:51:58.662295
[0m06:51:58.663655 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d74584f-d68b-443a-979b-c6ce273efc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d7f5fc10>]}
[0m06:51:58.664574 [info ] [Thread-3 (]: 3 of 4 OK created sql view model bandcamp_sales_schema.stg_sales_by_country .... [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m06:51:58.665920 [debug] [Thread-3 (]: Finished running node model.bc_sales.stg_sales_by_country
[0m06:51:58.666883 [debug] [Thread-4 (]: Began running node model.bc_sales.country_facts
[0m06:51:58.667616 [info ] [Thread-4 (]: 4 of 4 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m06:51:58.669290 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bc_sales.country_facts'
[0m06:51:58.669795 [debug] [Thread-4 (]: Began compiling node model.bc_sales.country_facts
[0m06:51:58.675145 [debug] [Thread-4 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m06:51:58.677120 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:3dba29f9-a090-4479-9690-55e8e0d225b0&page=queryresults
[0m06:51:58.678225 [debug] [Thread-2 (]: Writing injected SQL for node "model.bc_sales.stg_higher_activity_countries"
[0m06:51:58.679301 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (compile): 06:51:58.670094 => 06:51:58.678951
[0m06:51:58.680044 [debug] [Thread-4 (]: Began executing node model.bc_sales.country_facts
[0m06:51:58.680780 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (compile): 06:51:57.278479 => 06:51:58.680380
[0m06:51:58.686551 [debug] [Thread-2 (]: Began executing node model.bc_sales.stg_higher_activity_countries
[0m06:51:58.691456 [debug] [Thread-2 (]: Writing runtime sql for node "model.bc_sales.stg_higher_activity_countries"
[0m06:51:58.704487 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:51:58.705745 [debug] [Thread-2 (]: On model.bc_sales.stg_higher_activity_countries: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_higher_activity_countries"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_higher_activity_countries`
  OPTIONS()
  as 

-- Q2, Q3

select
    cast(cc_ref as integer) as cc_ref,
    cast(artist_name as string) as artist_name,
    cast(amount_paid_usd as numeric) as amount_paid_usd,
    cast(country_code as string) as country_code,
    cast(country as string) as country
from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_clustered`
where cc_ref <= 115
order by
    cc_ref asc,
    artist_name asc;


[0m06:51:59.065510 [debug] [Thread-4 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m06:51:59.066573 [debug] [Thread-4 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select *
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
)

with country_ref as (
    select *
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
)

select
    cc_ref,
    count(cc_ref) as 
    avg(amount_paid_usd) as average_sale,
    sum(amount_paid_usd) as total_sales,
--    country_code,
--    country
    country_ref.country_code
from countries
group by 1
order by average_sale desc
left join
    country_ref
on countries.cc_ref = country_ref.cc_ref
    );
  
[0m06:51:59.208667 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [21:1]')
[0m06:51:59.290614 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:3042d1f8-2031-450d-bce2-50ebe7ff2a93&page=queryresults
[0m06:51:59.294525 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (execute): 06:51:58.686988 => 06:51:59.294212
[0m06:51:59.295866 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d74584f-d68b-443a-979b-c6ce273efc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1dc4bebf0>]}
[0m06:51:59.296836 [info ] [Thread-2 (]: 2 of 4 OK created sql view model bandcamp_sales_schema.stg_higher_activity_countries  [[32mCREATE VIEW (0 processed)[0m in 2.02s]
[0m06:51:59.298029 [debug] [Thread-2 (]: Finished running node model.bc_sales.stg_higher_activity_countries
[0m06:51:59.807181 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:US:200e55d8-fdc8-40a1-8a4f-093c1422685e&page=queryresults
[0m06:51:59.808668 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (execute): 06:51:58.681095 => 06:51:59.808274
[0m06:51:59.813710 [debug] [Thread-4 (]: Database Error in model country_facts (models/core/country_facts.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [21:1]
  compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m06:51:59.814749 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d74584f-d68b-443a-979b-c6ce273efc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1dc4be710>]}
[0m06:51:59.815627 [error] [Thread-4 (]: 4 of 4 ERROR creating sql table model bandcamp_sales_schema.country_facts ...... [[31mERROR[0m in 1.15s]
[0m06:51:59.816601 [debug] [Thread-4 (]: Finished running node model.bc_sales.country_facts
[0m06:51:59.819172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:51:59.819577 [debug] [MainThread]: Connection 'model.bc_sales.stg_country_code_ref' was properly closed.
[0m06:51:59.820000 [debug] [MainThread]: Connection 'model.bc_sales.stg_higher_activity_countries' was properly closed.
[0m06:51:59.820336 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales_by_country' was properly closed.
[0m06:51:59.820670 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m06:51:59.821428 [info ] [MainThread]: 
[0m06:51:59.822109 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 3.23 seconds (3.23s).
[0m06:51:59.823600 [debug] [MainThread]: Command end result
[0m06:51:59.837693 [info ] [MainThread]: 
[0m06:51:59.838632 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:51:59.839319 [info ] [MainThread]: 
[0m06:51:59.839993 [error] [MainThread]: [33mDatabase Error in model country_facts (models/core/country_facts.sql)[0m
[0m06:51:59.840659 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [21:1]
[0m06:51:59.841265 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m06:51:59.841912 [info ] [MainThread]: 
[0m06:51:59.842566 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m06:51:59.843658 [debug] [MainThread]: Command `dbt build` failed at 06:51:59.843492 after 4.44 seconds
[0m06:51:59.844256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1efa4a530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ef5794b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1d7f9bcd0>]}
[0m06:51:59.844752 [debug] [MainThread]: Flushing usage events
[0m06:55:17.923983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a5246530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a3ecf7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a3ecf7c0>]}


============================== 06:55:17.927544 | 95e778fb-ca84-4156-9ddb-1e69c2c25fab ==============================
[0m06:55:17.927544 [info ] [MainThread]: Running with dbt=1.5.0
[0m06:55:17.929570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:55:18.926507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95e778fb-ca84-4156-9ddb-1e69c2c25fab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a3ecf8b0>]}
[0m06:55:18.939067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95e778fb-ca84-4156-9ddb-1e69c2c25fab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9992025f60>]}
[0m06:55:18.961493 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m06:55:19.003337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:55:19.004460 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts.sql
[0m06:55:19.026919 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m06:55:19.065634 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m06:55:19.073714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95e778fb-ca84-4156-9ddb-1e69c2c25fab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9991cbfdf0>]}
[0m06:55:19.086194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95e778fb-ca84-4156-9ddb-1e69c2c25fab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9991e28c70>]}
[0m06:55:19.086966 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m06:55:19.089457 [info ] [MainThread]: 
[0m06:55:19.090883 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:55:19.092780 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m06:55:19.093490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:55:19.448217 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m06:55:19.449041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:55:19.744622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95e778fb-ca84-4156-9ddb-1e69c2c25fab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9991e28070>]}
[0m06:55:19.745865 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:55:19.746641 [info ] [MainThread]: 
[0m06:55:19.752032 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_country_code_ref
[0m06:55:19.752845 [info ] [Thread-1 (]: 1 of 4 START sql view model bandcamp_sales_schema.stg_country_code_ref ......... [RUN]
[0m06:55:19.754257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.stg_country_code_ref)
[0m06:55:19.754806 [debug] [Thread-2 (]: Began running node model.bc_sales.stg_higher_activity_countries
[0m06:55:19.756583 [info ] [Thread-2 (]: 2 of 4 START sql view model bandcamp_sales_schema.stg_higher_activity_countries  [RUN]
[0m06:55:19.755873 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_country_code_ref
[0m06:55:19.755287 [debug] [Thread-3 (]: Began running node model.bc_sales.stg_sales_by_country
[0m06:55:19.757713 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now model.bc_sales.stg_higher_activity_countries)
[0m06:55:19.763212 [debug] [Thread-2 (]: Began compiling node model.bc_sales.stg_higher_activity_countries
[0m06:55:19.762338 [info ] [Thread-3 (]: 3 of 4 START sql view model bandcamp_sales_schema.stg_sales_by_country ......... [RUN]
[0m06:55:19.781654 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales_by_country'
[0m06:55:19.784009 [debug] [Thread-3 (]: Began compiling node model.bc_sales.stg_sales_by_country
[0m06:55:19.789167 [debug] [Thread-3 (]: Writing injected SQL for node "model.bc_sales.stg_sales_by_country"
[0m06:55:19.795183 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:55:19.800012 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_country_code_ref"
[0m06:55:19.801933 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (compile): 06:55:19.758132 => 06:55:19.801487
[0m06:55:19.802611 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_country_code_ref
[0m06:55:19.803467 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (compile): 06:55:19.784614 => 06:55:19.803125
[0m06:55:19.813465 [debug] [Thread-3 (]: Began executing node model.bc_sales.stg_sales_by_country
[0m06:55:19.886477 [debug] [Thread-3 (]: Writing runtime sql for node "model.bc_sales.stg_sales_by_country"
[0m06:55:19.890603 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_country_code_ref"
[0m06:55:19.892044 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:55:19.893402 [debug] [Thread-2 (]: On model.bc_sales.stg_higher_activity_countries: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_higher_activity_countries"} */

    select cc_ref
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`
    where count > 20
    order by
	cc_ref desc
    limit 1

[0m06:55:19.895290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:55:19.990698 [debug] [Thread-1 (]: On model.bc_sales.stg_country_code_ref: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_country_code_ref"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`;


[0m06:55:20.044216 [debug] [Thread-3 (]: On model.bc_sales.stg_sales_by_country: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales_by_country"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
  OPTIONS()
  as 

-- Q1

select
  cast(cc_ref as integer) as cc_ref,
  cast(amount_paid_usd as numeric) as amount_paid_usd,

  cast(country_code as string) as country_code,
  cast(country as string) as country

from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_partitioned`

-- limit 10000;


[0m06:55:21.039641 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:2642130d-d631-4aa7-81e8-1ba87e156ad1&page=queryresults
[0m06:55:21.066817 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (execute): 06:55:19.803876 => 06:55:21.066510
[0m06:55:21.068184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95e778fb-ca84-4156-9ddb-1e69c2c25fab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99917a0190>]}
[0m06:55:21.069167 [info ] [Thread-1 (]: 1 of 4 OK created sql view model bandcamp_sales_schema.stg_country_code_ref .... [[32mCREATE VIEW (0 processed)[0m in 1.31s]
[0m06:55:21.070357 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_country_code_ref
[0m06:55:21.088948 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:6d041e97-7a50-4598-975e-9877d489a1a7&page=queryresults
[0m06:55:21.090107 [debug] [Thread-2 (]: Writing injected SQL for node "model.bc_sales.stg_higher_activity_countries"
[0m06:55:21.091084 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (compile): 06:55:19.763895 => 06:55:21.090753
[0m06:55:21.091668 [debug] [Thread-2 (]: Began executing node model.bc_sales.stg_higher_activity_countries
[0m06:55:21.097119 [debug] [Thread-2 (]: Writing runtime sql for node "model.bc_sales.stg_higher_activity_countries"
[0m06:55:21.098035 [debug] [Thread-2 (]: On model.bc_sales.stg_higher_activity_countries: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_higher_activity_countries"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_higher_activity_countries`
  OPTIONS()
  as 

-- Q2, Q3

select
    cast(cc_ref as integer) as cc_ref,
    cast(artist_name as string) as artist_name,
    cast(amount_paid_usd as numeric) as amount_paid_usd,
    cast(country_code as string) as country_code,
    cast(country as string) as country
from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_clustered`
where cc_ref <= 115
order by
    cc_ref asc,
    artist_name asc;


[0m06:55:21.103389 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:6c70382c-2f01-4e67-bd5f-844312873c15&page=queryresults
[0m06:55:21.106945 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (execute): 06:55:19.814067 => 06:55:21.106472
[0m06:55:21.108173 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95e778fb-ca84-4156-9ddb-1e69c2c25fab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99917a0a00>]}
[0m06:55:21.109129 [info ] [Thread-3 (]: 3 of 4 OK created sql view model bandcamp_sales_schema.stg_sales_by_country .... [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m06:55:21.110463 [debug] [Thread-3 (]: Finished running node model.bc_sales.stg_sales_by_country
[0m06:55:21.111424 [debug] [Thread-4 (]: Began running node model.bc_sales.country_facts
[0m06:55:21.112133 [info ] [Thread-4 (]: 4 of 4 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m06:55:21.113452 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bc_sales.country_facts'
[0m06:55:21.113975 [debug] [Thread-4 (]: Began compiling node model.bc_sales.country_facts
[0m06:55:21.121301 [debug] [Thread-4 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m06:55:21.122370 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (compile): 06:55:21.114295 => 06:55:21.122013
[0m06:55:21.122909 [debug] [Thread-4 (]: Began executing node model.bc_sales.country_facts
[0m06:55:21.137838 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:55:21.463538 [debug] [Thread-4 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m06:55:21.464572 [debug] [Thread-4 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select *
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
)

with country_ref as (
    select *
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
)

select
    countries.cc_ref,
    count(countries.cc_ref) as total_transactions,
    avg(countries.amount_paid_usd) as average_sale_usd,
    sum(countries.amount_paid_usd) as total_sales_usd,
    country_ref.country_code
from countries
group by 1
order by average_sale desc
left join
    country_ref
on countries.cc_ref = country_ref.cc_ref
    );
  
[0m06:55:21.627115 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [21:1]')
[0m06:55:21.671702 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:94fbc9db-06e4-4348-ae31-c65cd3d0b140&page=queryresults
[0m06:55:21.674746 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (execute): 06:55:21.092061 => 06:55:21.674453
[0m06:55:21.675919 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95e778fb-ca84-4156-9ddb-1e69c2c25fab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9991cbe320>]}
[0m06:55:21.676858 [info ] [Thread-2 (]: 2 of 4 OK created sql view model bandcamp_sales_schema.stg_higher_activity_countries  [[32mCREATE VIEW (0 processed)[0m in 1.92s]
[0m06:55:21.677973 [debug] [Thread-2 (]: Finished running node model.bc_sales.stg_higher_activity_countries
[0m06:55:22.757946 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:US:b87d132a-0657-4de2-9505-62dbeeba2a01&page=queryresults
[0m06:55:22.759587 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (execute): 06:55:21.123257 => 06:55:22.759139
[0m06:55:22.764330 [debug] [Thread-4 (]: Database Error in model country_facts (models/core/country_facts.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [21:1]
  compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m06:55:22.765169 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95e778fb-ca84-4156-9ddb-1e69c2c25fab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9991cbde40>]}
[0m06:55:22.766140 [error] [Thread-4 (]: 4 of 4 ERROR creating sql table model bandcamp_sales_schema.country_facts ...... [[31mERROR[0m in 1.65s]
[0m06:55:22.767148 [debug] [Thread-4 (]: Finished running node model.bc_sales.country_facts
[0m06:55:22.770655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:55:22.771202 [debug] [MainThread]: Connection 'model.bc_sales.stg_higher_activity_countries' was properly closed.
[0m06:55:22.771554 [debug] [MainThread]: Connection 'model.bc_sales.stg_country_code_ref' was properly closed.
[0m06:55:22.771954 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales_by_country' was properly closed.
[0m06:55:22.772309 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m06:55:22.772762 [info ] [MainThread]: 
[0m06:55:22.773459 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 3.68 seconds (3.68s).
[0m06:55:22.775032 [debug] [MainThread]: Command end result
[0m06:55:22.788332 [info ] [MainThread]: 
[0m06:55:22.789495 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:55:22.790240 [info ] [MainThread]: 
[0m06:55:22.790904 [error] [MainThread]: [33mDatabase Error in model country_facts (models/core/country_facts.sql)[0m
[0m06:55:22.791527 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [21:1]
[0m06:55:22.792172 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m06:55:22.792779 [info ] [MainThread]: 
[0m06:55:22.793432 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m06:55:22.794533 [debug] [MainThread]: Command `dbt build` failed at 06:55:22.794359 after 4.88 seconds
[0m06:55:22.795084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a5246530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a4d754b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9991d7e3e0>]}
[0m06:55:22.795628 [debug] [MainThread]: Flushing usage events
[0m06:55:57.185108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb168c4a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb167bd3790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb167bd37c0>]}


============================== 06:55:57.188755 | 060e1f2e-8275-4481-a09f-49386e5071f8 ==============================
[0m06:55:57.188755 [info ] [MainThread]: Running with dbt=1.5.0
[0m06:55:57.189759 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:55:58.178287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '060e1f2e-8275-4481-a09f-49386e5071f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb167bd38b0>]}
[0m06:55:58.191282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '060e1f2e-8275-4481-a09f-49386e5071f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb155b01240>]}
[0m06:55:58.218308 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m06:55:58.259204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:55:58.259902 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:55:58.260719 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m06:55:58.269182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '060e1f2e-8275-4481-a09f-49386e5071f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb15592c0d0>]}
[0m06:55:58.282549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '060e1f2e-8275-4481-a09f-49386e5071f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1558f0b50>]}
[0m06:55:58.283304 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m06:55:58.285416 [warn ] [MainThread]: The selection criterion 'core/country_facts' does not match any nodes
[0m06:55:58.286801 [info ] [MainThread]: 
[0m06:55:58.287741 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:55:58.288850 [debug] [MainThread]: Command end result
[0m06:55:58.298950 [debug] [MainThread]: Command `dbt build` succeeded at 06:55:58.298611 after 1.12 seconds
[0m06:55:58.299629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb168c4a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1558f0940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1558f08e0>]}
[0m06:55:58.300253 [debug] [MainThread]: Flushing usage events
[0m06:56:23.900508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eeda4a560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eec9cf820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eec9cf850>]}


============================== 06:56:23.904158 | e78e0c88-39fd-4614-b45a-4ff7baabe55d ==============================
[0m06:56:23.904158 [info ] [MainThread]: Running with dbt=1.5.0
[0m06:56:23.905155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'version_check': 'True', 'profiles_dir': '/home/j/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:56:24.884612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e78e0c88-39fd-4614-b45a-4ff7baabe55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eec9cf940>]}
[0m06:56:24.897332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e78e0c88-39fd-4614-b45a-4ff7baabe55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eda805fc0>]}
[0m06:56:24.919479 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m06:56:24.959632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:56:24.960277 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:56:24.961050 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m06:56:24.968973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e78e0c88-39fd-4614-b45a-4ff7baabe55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eda4440d0>]}
[0m06:56:24.981777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e78e0c88-39fd-4614-b45a-4ff7baabe55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eda608be0>]}
[0m06:56:24.982532 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m06:56:24.984586 [info ] [MainThread]: 
[0m06:56:24.985819 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:56:24.987406 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m06:56:24.988077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:56:25.349183 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m06:56:25.350000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:56:25.639106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e78e0c88-39fd-4614-b45a-4ff7baabe55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eda608a90>]}
[0m06:56:25.640379 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:56:25.641102 [info ] [MainThread]: 
[0m06:56:25.646061 [debug] [Thread-1 (]: Began running node model.bc_sales.country_facts
[0m06:56:25.646832 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m06:56:25.648231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.country_facts)
[0m06:56:25.648822 [debug] [Thread-1 (]: Began compiling node model.bc_sales.country_facts
[0m06:56:25.653701 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m06:56:25.654675 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (compile): 06:56:25.649143 => 06:56:25.654347
[0m06:56:25.655188 [debug] [Thread-1 (]: Began executing node model.bc_sales.country_facts
[0m06:56:25.675100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:56:26.031979 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m06:56:26.032969 [debug] [Thread-1 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select *
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
)

with country_ref as (
    select *
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
)

select
    countries.cc_ref,
    count(countries.cc_ref) as total_transactions,
    avg(countries.amount_paid_usd) as average_sale_usd,
    sum(countries.amount_paid_usd) as total_sales_usd,
    country_ref.country_code
from countries
group by 1
order by average_sale desc
left join
    country_ref
on countries.cc_ref = country_ref.cc_ref
    );
  
[0m06:56:26.202704 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [21:1]')
[0m06:56:26.606413 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:US:2e14af67-8cb9-409d-bd68-c4e2e18a9025&page=queryresults
[0m06:56:26.608550 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (execute): 06:56:25.655577 => 06:56:26.608057
[0m06:56:26.612929 [debug] [Thread-1 (]: Database Error in model country_facts (models/core/country_facts.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [21:1]
  compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m06:56:26.613751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e78e0c88-39fd-4614-b45a-4ff7baabe55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eda447b50>]}
[0m06:56:26.614652 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bandcamp_sales_schema.country_facts ...... [[31mERROR[0m in 0.97s]
[0m06:56:26.615995 [debug] [Thread-1 (]: Finished running node model.bc_sales.country_facts
[0m06:56:26.618517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:56:26.619017 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m06:56:26.619416 [info ] [MainThread]: 
[0m06:56:26.620106 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.63 seconds (1.63s).
[0m06:56:26.621041 [debug] [MainThread]: Command end result
[0m06:56:26.642861 [info ] [MainThread]: 
[0m06:56:26.644169 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:56:26.644833 [info ] [MainThread]: 
[0m06:56:26.645484 [error] [MainThread]: [33mDatabase Error in model country_facts (models/core/country_facts.sql)[0m
[0m06:56:26.646149 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [21:1]
[0m06:56:26.646739 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m06:56:26.647330 [info ] [MainThread]: 
[0m06:56:26.647984 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:56:26.648980 [debug] [MainThread]: Command `dbt build` failed at 06:56:26.648821 after 2.76 seconds
[0m06:56:26.649483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eeda4a560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eda62a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eda62beb0>]}
[0m06:56:26.650066 [debug] [MainThread]: Flushing usage events
[0m06:58:13.726785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e4e94e5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e4d5d7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e4d5d78e0>]}


============================== 06:58:13.730489 | 4b2a05e1-e9b1-4578-b64c-a7ca353b471b ==============================
[0m06:58:13.730489 [info ] [MainThread]: Running with dbt=1.5.0
[0m06:58:13.732426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:58:14.732909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b2a05e1-e9b1-4578-b64c-a7ca353b471b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e4d5d79d0>]}
[0m06:58:14.745455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b2a05e1-e9b1-4578-b64c-a7ca353b471b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e3b7f91b0>]}
[0m06:58:14.767494 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m06:58:14.807556 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:58:14.808240 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:58:14.809092 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m06:58:14.817032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b2a05e1-e9b1-4578-b64c-a7ca353b471b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e3b4300d0>]}
[0m06:58:14.830146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b2a05e1-e9b1-4578-b64c-a7ca353b471b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e3b5f0d30>]}
[0m06:58:14.830974 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m06:58:14.832930 [info ] [MainThread]: 
[0m06:58:14.834128 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:58:14.835673 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m06:58:14.836323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:58:15.196658 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m06:58:15.197476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:58:15.504374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b2a05e1-e9b1-4578-b64c-a7ca353b471b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e3b5f0ac0>]}
[0m06:58:15.505652 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:58:15.506405 [info ] [MainThread]: 
[0m06:58:15.511666 [debug] [Thread-1 (]: Began running node model.bc_sales.country_facts
[0m06:58:15.512553 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m06:58:15.514171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.country_facts)
[0m06:58:15.514675 [debug] [Thread-1 (]: Began compiling node model.bc_sales.country_facts
[0m06:58:15.519977 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m06:58:15.520988 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (compile): 06:58:15.514982 => 06:58:15.520662
[0m06:58:15.521538 [debug] [Thread-1 (]: Began executing node model.bc_sales.country_facts
[0m06:58:15.541605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:58:15.913871 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m06:58:15.915021 [debug] [Thread-1 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select *
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
)

with country_ref as (
    select *
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
)

select
    countries.cc_ref,
    count(countries.cc_ref) as total_transactions,
    avg(countries.amount_paid_usd) as average_sale_usd,
    sum(countries.amount_paid_usd) as total_sales_usd,
    country_ref.country_code
from countries
group by 1
order by average_sale desc
left join
    country_ref
on countries.cc_ref = country_ref.cc_ref
    );
  
[0m06:58:16.070202 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [21:1]')
[0m06:58:16.457281 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:US:86aca123-c378-41dc-84e9-7b18e49c3fd2&page=queryresults
[0m06:58:16.458701 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (execute): 06:58:15.521889 => 06:58:16.458335
[0m06:58:16.462983 [debug] [Thread-1 (]: Database Error in model country_facts (models/core/country_facts.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [21:1]
  compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m06:58:16.463710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b2a05e1-e9b1-4578-b64c-a7ca353b471b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e3b433bb0>]}
[0m06:58:16.464669 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bandcamp_sales_schema.country_facts ...... [[31mERROR[0m in 0.95s]
[0m06:58:16.465610 [debug] [Thread-1 (]: Finished running node model.bc_sales.country_facts
[0m06:58:16.468009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:58:16.468423 [debug] [MainThread]: Connection 'list_datatalksclub-375802' was properly closed.
[0m06:58:16.468777 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m06:58:16.469148 [info ] [MainThread]: 
[0m06:58:16.469796 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.64 seconds (1.64s).
[0m06:58:16.470681 [debug] [MainThread]: Command end result
[0m06:58:16.489386 [info ] [MainThread]: 
[0m06:58:16.490330 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:58:16.491028 [info ] [MainThread]: 
[0m06:58:16.491653 [error] [MainThread]: [33mDatabase Error in model country_facts (models/core/country_facts.sql)[0m
[0m06:58:16.492346 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [21:1]
[0m06:58:16.492960 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m06:58:16.493557 [info ] [MainThread]: 
[0m06:58:16.494181 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:58:16.495168 [debug] [MainThread]: Command `dbt build` failed at 06:58:16.495009 after 2.78 seconds
[0m06:58:16.495712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e4e94e5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e4eb962c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e3b612800>]}
[0m06:58:16.496353 [debug] [MainThread]: Flushing usage events
[0m07:04:52.511876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdfb66a5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdfa5ef8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdfa5ef8b0>]}


============================== 07:04:52.515525 | 7c33a45c-01e0-407a-bb5f-e7017569170b ==============================
[0m07:04:52.515525 [info ] [MainThread]: Running with dbt=1.5.0
[0m07:04:52.517464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'debug': 'False', 'profiles_dir': '/home/j/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:04:53.506209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c33a45c-01e0-407a-bb5f-e7017569170b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdfa5ef9a0>]}
[0m07:04:53.519505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c33a45c-01e0-407a-bb5f-e7017569170b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde83b51b0>]}
[0m07:04:53.542935 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m07:04:53.584120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:04:53.585070 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts.sql
[0m07:04:53.607464 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m07:04:53.647420 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m07:04:53.655324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c33a45c-01e0-407a-bb5f-e7017569170b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde804fe20>]}
[0m07:04:53.667803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c33a45c-01e0-407a-bb5f-e7017569170b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde7fc0d00>]}
[0m07:04:53.668642 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m07:04:53.670681 [info ] [MainThread]: 
[0m07:04:53.672014 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:04:53.673843 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m07:04:53.674731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:04:54.056089 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m07:04:54.056968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:04:54.344640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c33a45c-01e0-407a-bb5f-e7017569170b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde7fc0a90>]}
[0m07:04:54.346375 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:04:54.347357 [info ] [MainThread]: 
[0m07:04:54.354952 [debug] [Thread-1 (]: Began running node model.bc_sales.country_facts
[0m07:04:54.356259 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m07:04:54.357979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.country_facts)
[0m07:04:54.358820 [debug] [Thread-1 (]: Began compiling node model.bc_sales.country_facts
[0m07:04:54.364168 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m07:04:54.365293 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (compile): 07:04:54.359316 => 07:04:54.364940
[0m07:04:54.365861 [debug] [Thread-1 (]: Began executing node model.bc_sales.country_facts
[0m07:04:54.389276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:04:54.758017 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m07:04:54.759017 [debug] [Thread-1 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select *
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
)

with country_ref as (
    select *
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
)

select
    countries.cc_ref as ccref,
    count(countries.cc_ref) as total_transactions,
    avg(countries.amount_paid_usd) as average_sale_usd,
    sum(countries.amount_paid_usd) as total_sales_usd,
    country_ref.country_code
from countries
left join country_ref
on countries.cc_ref = country_ref.cc_ref
group by 1
order by average_sale_usd desc
    );
  
[0m07:04:54.907822 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [21:1]')
[0m07:04:55.960001 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:US:a2145131-b11c-4b8e-bf3f-f88da00f2891&page=queryresults
[0m07:04:55.961478 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (execute): 07:04:54.366228 => 07:04:55.960967
[0m07:04:55.968193 [debug] [Thread-1 (]: Database Error in model country_facts (models/core/country_facts.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [21:1]
  compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:04:55.969365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c33a45c-01e0-407a-bb5f-e7017569170b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde7b1f3d0>]}
[0m07:04:55.970722 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bandcamp_sales_schema.country_facts ...... [[31mERROR[0m in 1.61s]
[0m07:04:55.972073 [debug] [Thread-1 (]: Finished running node model.bc_sales.country_facts
[0m07:04:55.975295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:04:55.975958 [debug] [MainThread]: Connection 'list_datatalksclub-375802' was properly closed.
[0m07:04:55.976506 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m07:04:55.977171 [info ] [MainThread]: 
[0m07:04:55.978148 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.31 seconds (2.31s).
[0m07:04:55.979518 [debug] [MainThread]: Command end result
[0m07:04:55.996812 [info ] [MainThread]: 
[0m07:04:55.997831 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:04:55.998568 [info ] [MainThread]: 
[0m07:04:55.999239 [error] [MainThread]: [33mDatabase Error in model country_facts (models/core/country_facts.sql)[0m
[0m07:04:56.000000 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [21:1]
[0m07:04:56.000618 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:04:56.001248 [info ] [MainThread]: 
[0m07:04:56.001916 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:04:56.002955 [debug] [MainThread]: Command `dbt build` failed at 07:04:56.002786 after 3.50 seconds
[0m07:04:56.003457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdfb66a5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde7fc0970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde7fc0790>]}
[0m07:04:56.004009 [debug] [MainThread]: Flushing usage events
[0m07:08:27.453837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb577a4a560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5769cf820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5769cf850>]}


============================== 07:08:27.458171 | fb8f8541-0cdd-47db-a623-cb900e553489 ==============================
[0m07:08:27.458171 [info ] [MainThread]: Running with dbt=1.5.0
[0m07:08:27.459214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:08:28.466076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb8f8541-0cdd-47db-a623-cb900e553489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5769cf940>]}
[0m07:08:28.478714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb8f8541-0cdd-47db-a623-cb900e553489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb56486dfc0>]}
[0m07:08:28.500266 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m07:08:28.541012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:08:28.541951 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts.sql
[0m07:08:28.564510 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m07:08:28.607994 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m07:08:28.616444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb8f8541-0cdd-47db-a623-cb900e553489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb564503dc0>]}
[0m07:08:28.629203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb8f8541-0cdd-47db-a623-cb900e553489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb564670ca0>]}
[0m07:08:28.630067 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m07:08:28.632027 [info ] [MainThread]: 
[0m07:08:28.633295 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:08:28.634886 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m07:08:28.635505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:08:29.021030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m07:08:29.021872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:08:29.319559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb8f8541-0cdd-47db-a623-cb900e553489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb564670a30>]}
[0m07:08:29.320942 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:08:29.321716 [info ] [MainThread]: 
[0m07:08:29.327152 [debug] [Thread-1 (]: Began running node model.bc_sales.country_facts
[0m07:08:29.328066 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m07:08:29.329379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.country_facts)
[0m07:08:29.330133 [debug] [Thread-1 (]: Began compiling node model.bc_sales.country_facts
[0m07:08:29.335280 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m07:08:29.336353 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (compile): 07:08:29.330491 => 07:08:29.336012
[0m07:08:29.336923 [debug] [Thread-1 (]: Began executing node model.bc_sales.country_facts
[0m07:08:29.363263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:08:29.709298 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m07:08:29.710356 [debug] [Thread-1 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
),

with country_ref as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
)

select
    countries.cc_ref as ref,
    count(countries.cc_ref) as total_transactions,
    avg(countries.amount_paid_usd) as average_sale_usd,
    sum(countries.amount_paid_usd) as total_sales_usd,
    country_ref.country_code
from countries
left join country_ref
on countries.cc_ref = country_ref.cc_ref
group by 1
order by average_sale_usd desc
    );
  
[0m07:08:29.848123 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword SELECT but got keyword WITH at [20:1]')
[0m07:08:30.336266 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:US:4ab9f90c-8a7f-439b-89a2-33bd0bbe819b&page=queryresults
[0m07:08:30.337623 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (execute): 07:08:29.337242 => 07:08:30.337251
[0m07:08:30.341591 [debug] [Thread-1 (]: Database Error in model country_facts (models/core/country_facts.sql)
  Syntax error: Expected keyword SELECT but got keyword WITH at [20:1]
  compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:08:30.342360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb8f8541-0cdd-47db-a623-cb900e553489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb55ff50520>]}
[0m07:08:30.343245 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bandcamp_sales_schema.country_facts ...... [[31mERROR[0m in 1.01s]
[0m07:08:30.344175 [debug] [Thread-1 (]: Finished running node model.bc_sales.country_facts
[0m07:08:30.346576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:08:30.346989 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m07:08:30.347392 [info ] [MainThread]: 
[0m07:08:30.348262 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m07:08:30.349216 [debug] [MainThread]: Command end result
[0m07:08:30.360346 [info ] [MainThread]: 
[0m07:08:30.361268 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:08:30.361930 [info ] [MainThread]: 
[0m07:08:30.362538 [error] [MainThread]: [33mDatabase Error in model country_facts (models/core/country_facts.sql)[0m
[0m07:08:30.363191 [error] [MainThread]:   Syntax error: Expected keyword SELECT but got keyword WITH at [20:1]
[0m07:08:30.363806 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:08:30.364401 [info ] [MainThread]: 
[0m07:08:30.365027 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:08:30.365999 [debug] [MainThread]: Command `dbt build` failed at 07:08:30.365842 after 2.92 seconds
[0m07:08:30.366498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb577a4a560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb564882350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb564880be0>]}
[0m07:08:30.366992 [debug] [MainThread]: Flushing usage events
[0m07:09:24.594459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93a752560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9393d7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9393d7850>]}


============================== 07:09:24.598204 | aa11ac33-8d59-4882-b9a8-503f589e0ab6 ==============================
[0m07:09:24.598204 [info ] [MainThread]: Running with dbt=1.5.0
[0m07:09:24.600379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:09:25.627298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa11ac33-8d59-4882-b9a8-503f589e0ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9393d7940>]}
[0m07:09:25.640227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa11ac33-8d59-4882-b9a8-503f589e0ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9275d9240>]}
[0m07:09:25.662738 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m07:09:25.707674 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:09:25.708788 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts.sql
[0m07:09:25.731018 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m07:09:25.769193 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m07:09:25.776840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa11ac33-8d59-4882-b9a8-503f589e0ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe92726fdc0>]}
[0m07:09:25.788560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa11ac33-8d59-4882-b9a8-503f589e0ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9273d4cd0>]}
[0m07:09:25.789339 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m07:09:25.791284 [info ] [MainThread]: 
[0m07:09:25.792559 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:09:25.794144 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m07:09:25.794781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:09:26.156909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m07:09:26.157745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:09:26.470904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa11ac33-8d59-4882-b9a8-503f589e0ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9273d4af0>]}
[0m07:09:26.472244 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:09:26.473306 [info ] [MainThread]: 
[0m07:09:26.478996 [debug] [Thread-1 (]: Began running node model.bc_sales.country_facts
[0m07:09:26.479944 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m07:09:26.481518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.country_facts)
[0m07:09:26.482073 [debug] [Thread-1 (]: Began compiling node model.bc_sales.country_facts
[0m07:09:26.487356 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m07:09:26.488442 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (compile): 07:09:26.482397 => 07:09:26.488086
[0m07:09:26.489007 [debug] [Thread-1 (]: Began executing node model.bc_sales.country_facts
[0m07:09:26.516015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:09:26.871623 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m07:09:26.872692 [debug] [Thread-1 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
),

country_ref as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
)

select
    countries.cc_ref as ref,
    count(countries.cc_ref) as total_transactions,
    avg(countries.amount_paid_usd) as average_sale_usd,
    sum(countries.amount_paid_usd) as total_sales_usd,
    country_ref.country_code
from countries
left join country_ref
on countries.cc_ref = country_ref.cc_ref
group by 1
order by average_sale_usd desc
    );
  
[0m07:09:27.403383 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references country_ref.country_code which is neither grouped nor aggregated at [29:5]')
[0m07:09:27.969709 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:5b23b05d-000a-4082-b6dd-6df8c5091ad3&page=queryresults
[0m07:09:27.971162 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (execute): 07:09:26.489330 => 07:09:27.970779
[0m07:09:27.974997 [debug] [Thread-1 (]: Database Error in model country_facts (models/core/country_facts.sql)
  SELECT list expression references country_ref.country_code which is neither grouped nor aggregated at [29:5]
  compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:09:27.975707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa11ac33-8d59-4882-b9a8-503f589e0ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe926d3ed40>]}
[0m07:09:27.976657 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bandcamp_sales_schema.country_facts ...... [[31mERROR[0m in 1.49s]
[0m07:09:27.977561 [debug] [Thread-1 (]: Finished running node model.bc_sales.country_facts
[0m07:09:27.980134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:09:27.980627 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m07:09:27.981039 [info ] [MainThread]: 
[0m07:09:27.981683 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m07:09:27.982616 [debug] [MainThread]: Command end result
[0m07:09:27.994296 [info ] [MainThread]: 
[0m07:09:27.995296 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:09:27.996078 [info ] [MainThread]: 
[0m07:09:27.997058 [error] [MainThread]: [33mDatabase Error in model country_facts (models/core/country_facts.sql)[0m
[0m07:09:27.997842 [error] [MainThread]:   SELECT list expression references country_ref.country_code which is neither grouped nor aggregated at [29:5]
[0m07:09:27.998463 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:09:27.999098 [info ] [MainThread]: 
[0m07:09:27.999736 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:09:28.000789 [debug] [MainThread]: Command `dbt build` failed at 07:09:28.000613 after 3.42 seconds
[0m07:09:28.001299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93a752560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93a3d12a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9275e2fe0>]}
[0m07:09:28.001845 [debug] [MainThread]: Flushing usage events
[0m07:10:01.541145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f745c44e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f745b3d3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f745b3d3820>]}


============================== 07:10:01.545023 | 9bdbd39a-bd92-46c3-8efb-8be01a3baedb ==============================
[0m07:10:01.545023 [info ] [MainThread]: Running with dbt=1.5.0
[0m07:10:01.546092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:10:02.548175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bdbd39a-bd92-46c3-8efb-8be01a3baedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f745b3d3910>]}
[0m07:10:02.560963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bdbd39a-bd92-46c3-8efb-8be01a3baedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7449235240>]}
[0m07:10:02.583018 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m07:10:02.623914 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:10:02.624872 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts.sql
[0m07:10:02.646803 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m07:10:02.684537 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m07:10:02.692210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bdbd39a-bd92-46c3-8efb-8be01a3baedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7448ec3d90>]}
[0m07:10:02.704586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bdbd39a-bd92-46c3-8efb-8be01a3baedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f744902cc70>]}
[0m07:10:02.705347 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m07:10:02.707273 [info ] [MainThread]: 
[0m07:10:02.708525 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:10:02.710075 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m07:10:02.710679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:10:03.074840 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m07:10:03.075679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:10:03.395233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bdbd39a-bd92-46c3-8efb-8be01a3baedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f744902ca00>]}
[0m07:10:03.396601 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:10:03.397363 [info ] [MainThread]: 
[0m07:10:03.402567 [debug] [Thread-1 (]: Began running node model.bc_sales.country_facts
[0m07:10:03.403404 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m07:10:03.404672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.country_facts)
[0m07:10:03.405233 [debug] [Thread-1 (]: Began compiling node model.bc_sales.country_facts
[0m07:10:03.410278 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m07:10:03.411264 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (compile): 07:10:03.405542 => 07:10:03.410926
[0m07:10:03.411843 [debug] [Thread-1 (]: Began executing node model.bc_sales.country_facts
[0m07:10:03.434455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:10:03.790692 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m07:10:03.791712 [debug] [Thread-1 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
),

country_ref as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
)

select
    countries.cc_ref as ref,
    count(countries.cc_ref) as total_transactions,
    avg(countries.amount_paid_usd) as average_sale_usd,
    sum(countries.amount_paid_usd) as total_sales_usd,
from countries
left join country_ref
on countries.cc_ref = country_ref.cc_ref
group by 1
order by average_sale_usd desc
    );
  
[0m07:10:05.868302 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:c9792c1d-9fd1-4683-aa29-ceec82d2ce2e&page=queryresults
[0m07:10:05.890836 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (execute): 07:10:03.412186 => 07:10:05.890548
[0m07:10:05.892010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bdbd39a-bd92-46c3-8efb-8be01a3baedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7448ee0f70>]}
[0m07:10:05.892952 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bandcamp_sales_schema.country_facts .......... [[32mCREATE TABLE (186.0 rows, 15.3 MiB processed)[0m in 2.49s]
[0m07:10:05.894428 [debug] [Thread-1 (]: Finished running node model.bc_sales.country_facts
[0m07:10:05.897097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:10:05.897570 [debug] [MainThread]: Connection 'list_datatalksclub-375802' was properly closed.
[0m07:10:05.897945 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m07:10:05.898382 [info ] [MainThread]: 
[0m07:10:05.899084 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.19 seconds (3.19s).
[0m07:10:05.900264 [debug] [MainThread]: Command end result
[0m07:10:05.911992 [info ] [MainThread]: 
[0m07:10:05.913003 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:10:05.913715 [info ] [MainThread]: 
[0m07:10:05.914392 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:10:05.915452 [debug] [MainThread]: Command `dbt build` succeeded at 07:10:05.915279 after 4.38 seconds
[0m07:10:05.916010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f745c44e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7448e7d9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7448ee0f70>]}
[0m07:10:05.916908 [debug] [MainThread]: Flushing usage events
[0m07:17:39.183251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e714a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e5dcf820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e5dcf7f0>]}


============================== 07:17:39.186989 | aed9182a-cdff-40e0-a4ab-4e32a2231cc7 ==============================
[0m07:17:39.186989 [info ] [MainThread]: Running with dbt=1.5.0
[0m07:17:39.188052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/j/.dbt', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:17:40.196458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aed9182a-cdff-40e0-a4ab-4e32a2231cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e5dcf8e0>]}
[0m07:17:40.209119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aed9182a-cdff-40e0-a4ab-4e32a2231cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7d40111b0>]}
[0m07:17:40.233986 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m07:17:40.276008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:17:40.276984 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts.sql
[0m07:17:40.299059 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m07:17:40.339935 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m07:17:40.347699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aed9182a-cdff-40e0-a4ab-4e32a2231cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7d3c9bdf0>]}
[0m07:17:40.360377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aed9182a-cdff-40e0-a4ab-4e32a2231cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7d3e08c70>]}
[0m07:17:40.361221 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m07:17:40.363123 [info ] [MainThread]: 
[0m07:17:40.364368 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:17:40.365917 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m07:17:40.366439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:17:40.713542 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m07:17:40.714374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:17:41.024511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aed9182a-cdff-40e0-a4ab-4e32a2231cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7d3e08a90>]}
[0m07:17:41.025789 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:17:41.026566 [info ] [MainThread]: 
[0m07:17:41.032210 [debug] [Thread-1 (]: Began running node model.bc_sales.country_facts
[0m07:17:41.033098 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m07:17:41.034461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.country_facts)
[0m07:17:41.035055 [debug] [Thread-1 (]: Began compiling node model.bc_sales.country_facts
[0m07:17:41.040285 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m07:17:41.041375 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (compile): 07:17:41.035367 => 07:17:41.041009
[0m07:17:41.041989 [debug] [Thread-1 (]: Began executing node model.bc_sales.country_facts
[0m07:17:41.065307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:41.411836 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m07:17:41.412852 [debug] [Thread-1 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
),

country_ref as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
)

select
    countries.cc_ref as ref,
    count(countries.cc_ref) as total_transactions,
    avg(countries.amount_paid_usd) as average_sale_usd,
    sum(countries.amount_paid_usd) as total_sales_usd,
    country_ref.country_code as cc
from countries
left join country_ref
on countries.cc_ref = country_ref.cc_ref
group by 1
order by average_sale_usd desc
    );
  
[0m07:17:41.892426 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references country_ref.country_code which is neither grouped nor aggregated at [29:5]')
[0m07:17:43.001602 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:1a937c15-de05-46f1-8e4c-27857ebac410&page=queryresults
[0m07:17:43.003764 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (execute): 07:17:41.042326 => 07:17:43.003319
[0m07:17:43.008151 [debug] [Thread-1 (]: Database Error in model country_facts (models/core/country_facts.sql)
  SELECT list expression references country_ref.country_code which is neither grouped nor aggregated at [29:5]
  compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:17:43.009113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aed9182a-cdff-40e0-a4ab-4e32a2231cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7d376bcd0>]}
[0m07:17:43.010154 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bandcamp_sales_schema.country_facts ...... [[31mERROR[0m in 1.98s]
[0m07:17:43.011413 [debug] [Thread-1 (]: Finished running node model.bc_sales.country_facts
[0m07:17:43.014231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:17:43.014675 [debug] [MainThread]: Connection 'list_datatalksclub-375802' was properly closed.
[0m07:17:43.014996 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m07:17:43.015393 [info ] [MainThread]: 
[0m07:17:43.016292 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.65 seconds (2.65s).
[0m07:17:43.017218 [debug] [MainThread]: Command end result
[0m07:17:43.030534 [info ] [MainThread]: 
[0m07:17:43.031639 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:17:43.032670 [info ] [MainThread]: 
[0m07:17:43.033600 [error] [MainThread]: [33mDatabase Error in model country_facts (models/core/country_facts.sql)[0m
[0m07:17:43.034393 [error] [MainThread]:   SELECT list expression references country_ref.country_code which is neither grouped nor aggregated at [29:5]
[0m07:17:43.035092 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:17:43.035844 [info ] [MainThread]: 
[0m07:17:43.036642 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:17:43.037831 [debug] [MainThread]: Command `dbt build` failed at 07:17:43.037661 after 3.86 seconds
[0m07:17:43.038381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e714a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e6c0a950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7d3c53280>]}
[0m07:17:43.038922 [debug] [MainThread]: Flushing usage events
[0m07:23:53.379515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe52fe56530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe52eddb7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe52eddb820>]}


============================== 07:23:53.383141 | a234e07b-5776-43ba-9fa1-05952aaaed06 ==============================
[0m07:23:53.383141 [info ] [MainThread]: Running with dbt=1.5.0
[0m07:23:53.384583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'debug': 'False', 'profiles_dir': '/home/j/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:23:54.375683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a234e07b-5776-43ba-9fa1-05952aaaed06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe52eddb910>]}
[0m07:23:54.388480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a234e07b-5776-43ba-9fa1-05952aaaed06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51ccda680>]}
[0m07:23:54.410051 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m07:23:54.450466 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:23:54.451429 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts.sql
[0m07:23:54.473987 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m07:23:54.512026 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m07:23:54.520424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a234e07b-5776-43ba-9fa1-05952aaaed06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51c963d90>]}
[0m07:23:54.532483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a234e07b-5776-43ba-9fa1-05952aaaed06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51cad4c70>]}
[0m07:23:54.533224 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m07:23:54.535281 [info ] [MainThread]: 
[0m07:23:54.536764 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:23:54.538254 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m07:23:54.538831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:23:54.892472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m07:23:54.893277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:23:55.189927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a234e07b-5776-43ba-9fa1-05952aaaed06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51cad4a00>]}
[0m07:23:55.191111 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:23:55.192190 [info ] [MainThread]: 
[0m07:23:55.197173 [debug] [Thread-1 (]: Began running node model.bc_sales.country_facts
[0m07:23:55.197979 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m07:23:55.199136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.country_facts)
[0m07:23:55.199696 [debug] [Thread-1 (]: Began compiling node model.bc_sales.country_facts
[0m07:23:55.204668 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m07:23:55.205666 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (compile): 07:23:55.200065 => 07:23:55.205338
[0m07:23:55.206160 [debug] [Thread-1 (]: Began executing node model.bc_sales.country_facts
[0m07:23:55.231916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:55.581499 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m07:23:55.582542 [debug] [Thread-1 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
),

country_ref as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
)

select
    countries.cc_ref as ref,
    count(countries.cc_ref) as total_transactions,
    avg(countries.amount_paid_usd) as average_sale_usd,
    sum(countries.amount_paid_usd) as total_sales_usd,
    country_ref.country_code as cc
from countries
right join country_ref
on countries.cc_ref = country_ref.cc_ref
group by 1
order by average_sale_usd desc
    );
  
[0m07:23:56.324783 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references country_ref.country_code which is neither grouped nor aggregated at [29:5]')
[0m07:23:57.473559 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:1fab912f-2432-46f0-aa41-72c4dffe5734&page=queryresults
[0m07:23:57.475239 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (execute): 07:23:55.206565 => 07:23:57.474802
[0m07:23:57.479422 [debug] [Thread-1 (]: Database Error in model country_facts (models/core/country_facts.sql)
  SELECT list expression references country_ref.country_code which is neither grouped nor aggregated at [29:5]
  compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:23:57.480312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a234e07b-5776-43ba-9fa1-05952aaaed06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51c436d40>]}
[0m07:23:57.481441 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bandcamp_sales_schema.country_facts ...... [[31mERROR[0m in 2.28s]
[0m07:23:57.482520 [debug] [Thread-1 (]: Finished running node model.bc_sales.country_facts
[0m07:23:57.485337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:23:57.485766 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m07:23:57.486173 [info ] [MainThread]: 
[0m07:23:57.486814 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.95 seconds (2.95s).
[0m07:23:57.487746 [debug] [MainThread]: Command end result
[0m07:23:57.500491 [info ] [MainThread]: 
[0m07:23:57.501605 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:23:57.502277 [info ] [MainThread]: 
[0m07:23:57.502991 [error] [MainThread]: [33mDatabase Error in model country_facts (models/core/country_facts.sql)[0m
[0m07:23:57.503703 [error] [MainThread]:   SELECT list expression references country_ref.country_code which is neither grouped nor aggregated at [29:5]
[0m07:23:57.504563 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:23:57.505294 [info ] [MainThread]: 
[0m07:23:57.506078 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:23:57.507237 [debug] [MainThread]: Command `dbt build` failed at 07:23:57.507066 after 4.14 seconds
[0m07:23:57.507806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe52fe56530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51c9219c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51c985570>]}
[0m07:23:57.508396 [debug] [MainThread]: Flushing usage events
[0m07:24:41.269026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a9075a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a8f3e38b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a8f3e3880>]}


============================== 07:24:41.272724 | 749daafd-c998-48b7-8607-ecbd3dc8d74f ==============================
[0m07:24:41.272724 [info ] [MainThread]: Running with dbt=1.5.0
[0m07:24:41.273726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:24:42.264244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '749daafd-c998-48b7-8607-ecbd3dc8d74f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a8f3e3970>]}
[0m07:24:42.277016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '749daafd-c998-48b7-8607-ecbd3dc8d74f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a7d5e51b0>]}
[0m07:24:42.298930 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m07:24:42.338786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:24:42.339821 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts.sql
[0m07:24:42.363342 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m07:24:42.404400 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m07:24:42.413224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '749daafd-c998-48b7-8607-ecbd3dc8d74f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a7d273df0>]}
[0m07:24:42.425328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '749daafd-c998-48b7-8607-ecbd3dc8d74f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a7d3dccd0>]}
[0m07:24:42.426262 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m07:24:42.428772 [info ] [MainThread]: 
[0m07:24:42.430279 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:24:42.432321 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m07:24:42.433047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:24:42.782335 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m07:24:42.783434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:24:43.080907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '749daafd-c998-48b7-8607-ecbd3dc8d74f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a7d3dca60>]}
[0m07:24:43.082059 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:24:43.083062 [info ] [MainThread]: 
[0m07:24:43.088219 [debug] [Thread-1 (]: Began running node model.bc_sales.country_facts
[0m07:24:43.089052 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m07:24:43.090539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.country_facts)
[0m07:24:43.091063 [debug] [Thread-1 (]: Began compiling node model.bc_sales.country_facts
[0m07:24:43.096124 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m07:24:43.097127 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (compile): 07:24:43.091356 => 07:24:43.096799
[0m07:24:43.097685 [debug] [Thread-1 (]: Began executing node model.bc_sales.country_facts
[0m07:24:43.123375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:24:43.473600 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m07:24:43.474603 [debug] [Thread-1 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
),

country_ref as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
)

select
    countries.cc_ref as ref,
    count(countries.cc_ref) as total_transactions,
    avg(countries.amount_paid_usd) as average_sale_usd,
    sum(countries.amount_paid_usd) as total_sales_usd,
    country_ref.country_code as cc
from countries
outter join country_ref
on countries.cc_ref = country_ref.cc_ref
group by 1
order by average_sale_usd desc
    );
  
[0m07:24:43.879295 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: countries; Did you mean country? at [32:4]')
[0m07:24:45.402155 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:d7c848c7-4d15-4d9c-82c2-77400eb214d9&page=queryresults
[0m07:24:45.403927 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (execute): 07:24:43.098010 => 07:24:45.403387
[0m07:24:45.408144 [debug] [Thread-1 (]: Database Error in model country_facts (models/core/country_facts.sql)
  Unrecognized name: countries; Did you mean country? at [32:4]
  compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:24:45.409083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '749daafd-c998-48b7-8607-ecbd3dc8d74f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a7cd46a10>]}
[0m07:24:45.410145 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bandcamp_sales_schema.country_facts ...... [[31mERROR[0m in 2.32s]
[0m07:24:45.411509 [debug] [Thread-1 (]: Finished running node model.bc_sales.country_facts
[0m07:24:45.414536 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:24:45.415097 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m07:24:45.415547 [info ] [MainThread]: 
[0m07:24:45.416642 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.99 seconds (2.99s).
[0m07:24:45.417803 [debug] [MainThread]: Command end result
[0m07:24:45.430648 [info ] [MainThread]: 
[0m07:24:45.432233 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:24:45.433245 [info ] [MainThread]: 
[0m07:24:45.434066 [error] [MainThread]: [33mDatabase Error in model country_facts (models/core/country_facts.sql)[0m
[0m07:24:45.434798 [error] [MainThread]:   Unrecognized name: countries; Did you mean country? at [32:4]
[0m07:24:45.435488 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:24:45.436276 [info ] [MainThread]: 
[0m07:24:45.436917 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:24:45.437981 [debug] [MainThread]: Command `dbt build` failed at 07:24:45.437805 after 4.18 seconds
[0m07:24:45.438574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a9075a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a7d5ef280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a7d5ece50>]}
[0m07:24:45.439121 [debug] [MainThread]: Flushing usage events
[0m07:26:28.578933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbee352530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbecfd7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbecfd7820>]}


============================== 07:26:28.582685 | 6eb3b8b7-e26e-4bd1-a2e7-121156154a1e ==============================
[0m07:26:28.582685 [info ] [MainThread]: Running with dbt=1.5.0
[0m07:26:28.583542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:26:29.576547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6eb3b8b7-e26e-4bd1-a2e7-121156154a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbecfd7910>]}
[0m07:26:29.589024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6eb3b8b7-e26e-4bd1-a2e7-121156154a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbdb159f90>]}
[0m07:26:29.609809 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m07:26:29.650029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:26:29.650961 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts.sql
[0m07:26:29.673010 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m07:26:29.710401 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m07:26:29.718045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6eb3b8b7-e26e-4bd1-a2e7-121156154a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbdade7d90>]}
[0m07:26:29.730215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6eb3b8b7-e26e-4bd1-a2e7-121156154a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbdaf50ca0>]}
[0m07:26:29.731059 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m07:26:29.732992 [info ] [MainThread]: 
[0m07:26:29.734200 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:26:29.735809 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m07:26:29.736472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:26:30.085947 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m07:26:30.086733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:26:30.379338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6eb3b8b7-e26e-4bd1-a2e7-121156154a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbdaf50ac0>]}
[0m07:26:30.380535 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:26:30.381199 [info ] [MainThread]: 
[0m07:26:30.385952 [debug] [Thread-1 (]: Began running node model.bc_sales.country_facts
[0m07:26:30.386668 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m07:26:30.387738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.country_facts)
[0m07:26:30.388280 [debug] [Thread-1 (]: Began compiling node model.bc_sales.country_facts
[0m07:26:30.393161 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m07:26:30.394297 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (compile): 07:26:30.388570 => 07:26:30.393946
[0m07:26:30.394870 [debug] [Thread-1 (]: Began executing node model.bc_sales.country_facts
[0m07:26:30.420393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:26:30.762587 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m07:26:30.763608 [debug] [Thread-1 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
),

country_ref as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
)

select
    countries.cc_ref as ref,
    count(countries.cc_ref) as total_transactions,
    avg(countries.amount_paid_usd) as average_sale_usd,
    sum(countries.amount_paid_usd) as total_sales_usd,
    country_ref.country_code as cc
from countries
outter join country_ref
on country_ref.cc_ref = countries.cc_ref
group by 1
order by average_sale_usd desc
    );
  
[0m07:26:31.145060 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: countries; Did you mean country? at [32:25]')
[0m07:26:31.957214 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:03d1c20c-cddd-4505-bb4a-b446498ccfea&page=queryresults
[0m07:26:31.958598 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (execute): 07:26:30.395198 => 07:26:31.958212
[0m07:26:31.962340 [debug] [Thread-1 (]: Database Error in model country_facts (models/core/country_facts.sql)
  Unrecognized name: countries; Did you mean country? at [32:25]
  compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:26:31.963000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eb3b8b7-e26e-4bd1-a2e7-121156154a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbda8b29b0>]}
[0m07:26:31.963910 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bandcamp_sales_schema.country_facts ...... [[31mERROR[0m in 1.58s]
[0m07:26:31.964797 [debug] [Thread-1 (]: Finished running node model.bc_sales.country_facts
[0m07:26:31.967104 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:26:31.967499 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m07:26:31.967955 [info ] [MainThread]: 
[0m07:26:31.968627 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.23 seconds (2.23s).
[0m07:26:31.969521 [debug] [MainThread]: Command end result
[0m07:26:31.980588 [info ] [MainThread]: 
[0m07:26:31.981489 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:26:31.982205 [info ] [MainThread]: 
[0m07:26:31.982885 [error] [MainThread]: [33mDatabase Error in model country_facts (models/core/country_facts.sql)[0m
[0m07:26:31.983496 [error] [MainThread]:   Unrecognized name: countries; Did you mean country? at [32:25]
[0m07:26:31.984197 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:26:31.984778 [info ] [MainThread]: 
[0m07:26:31.985406 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:26:31.986375 [debug] [MainThread]: Command `dbt build` failed at 07:26:31.986202 after 3.42 seconds
[0m07:26:31.986850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbee352530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbede814b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbdb1665c0>]}
[0m07:26:31.987359 [debug] [MainThread]: Flushing usage events
[0m07:27:27.097222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb189f4a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb188bd37f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb188bd37c0>]}


============================== 07:27:27.100826 | dbe799d9-ef9b-499f-b581-5b153fc1ee5c ==============================
[0m07:27:27.100826 [info ] [MainThread]: Running with dbt=1.5.0
[0m07:27:27.101749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'debug': 'False', 'profiles_dir': '/home/j/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:27:28.098167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbe799d9-ef9b-499f-b581-5b153fc1ee5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb188bd38b0>]}
[0m07:27:28.110682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbe799d9-ef9b-499f-b581-5b153fc1ee5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb176d09240>]}
[0m07:27:28.132751 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m07:27:28.173187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:27:28.174151 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts.sql
[0m07:27:28.196230 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m07:27:28.234060 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m07:27:28.241860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbe799d9-ef9b-499f-b581-5b153fc1ee5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb17658fdc0>]}
[0m07:27:28.254245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbe799d9-ef9b-499f-b581-5b153fc1ee5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb176af8c10>]}
[0m07:27:28.255067 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m07:27:28.256879 [info ] [MainThread]: 
[0m07:27:28.258132 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:27:28.259743 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m07:27:28.260452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:27:28.739991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m07:27:28.740732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:27:29.034839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbe799d9-ef9b-499f-b581-5b153fc1ee5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb176af89a0>]}
[0m07:27:29.036165 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:27:29.036947 [info ] [MainThread]: 
[0m07:27:29.042119 [debug] [Thread-1 (]: Began running node model.bc_sales.country_facts
[0m07:27:29.042958 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m07:27:29.044217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.country_facts)
[0m07:27:29.044796 [debug] [Thread-1 (]: Began compiling node model.bc_sales.country_facts
[0m07:27:29.049648 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m07:27:29.050710 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (compile): 07:27:29.045102 => 07:27:29.050387
[0m07:27:29.051254 [debug] [Thread-1 (]: Began executing node model.bc_sales.country_facts
[0m07:27:29.076881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:27:29.433383 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m07:27:29.434402 [debug] [Thread-1 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
),

country_ref as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
)

select
    countries.cc_ref as ref,
    count(countries.cc_ref) as total_transactions,
    avg(countries.amount_paid_usd) as average_sale_usd,
    sum(countries.amount_paid_usd) as total_sales_usd
from countries
right join country_ref
on countries.cc_ref = country_ref.cc_ref
group by 1
order by average_sale_usd desc
    );
  
[0m07:27:31.836175 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:2bf5810f-c9b1-4806-ad82-7321229b4489&page=queryresults
[0m07:27:31.858192 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (execute): 07:27:29.051584 => 07:27:31.857892
[0m07:27:31.859257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbe799d9-ef9b-499f-b581-5b153fc1ee5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1765a7cd0>]}
[0m07:27:31.860138 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bandcamp_sales_schema.country_facts .......... [[32mCREATE TABLE (186.0 rows, 15.3 MiB processed)[0m in 2.82s]
[0m07:27:31.861276 [debug] [Thread-1 (]: Finished running node model.bc_sales.country_facts
[0m07:27:31.863557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:27:31.864026 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m07:27:31.864424 [info ] [MainThread]: 
[0m07:27:31.865257 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.61 seconds (3.61s).
[0m07:27:31.866500 [debug] [MainThread]: Command end result
[0m07:27:31.877103 [info ] [MainThread]: 
[0m07:27:31.878274 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:27:31.878916 [info ] [MainThread]: 
[0m07:27:31.879533 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:27:31.880724 [debug] [MainThread]: Command `dbt build` succeeded at 07:27:31.880519 after 4.79 seconds
[0m07:27:31.881192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb189f4a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb176d09240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb176af8e20>]}
[0m07:27:31.881793 [debug] [MainThread]: Flushing usage events
[0m07:28:58.445285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02c8d5e560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02c79e3820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02c79e3850>]}


============================== 07:28:58.449579 | 620360b0-c43a-4fc3-b39f-cf23af487e77 ==============================
[0m07:28:58.449579 [info ] [MainThread]: Running with dbt=1.5.0
[0m07:28:58.451564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'profiles_dir': '/home/j/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:28:59.450633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '620360b0-c43a-4fc3-b39f-cf23af487e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02c79e3940>]}
[0m07:28:59.463679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '620360b0-c43a-4fc3-b39f-cf23af487e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b5b6d240>]}
[0m07:28:59.486835 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m07:28:59.527626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:28:59.528619 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts.sql
[0m07:28:59.551208 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m07:28:59.589646 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m07:28:59.598941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '620360b0-c43a-4fc3-b39f-cf23af487e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b57f3dc0>]}
[0m07:28:59.612016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '620360b0-c43a-4fc3-b39f-cf23af487e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b595cca0>]}
[0m07:28:59.613134 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m07:28:59.615141 [info ] [MainThread]: 
[0m07:28:59.616456 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:28:59.618099 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m07:28:59.618775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:28:59.962789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m07:28:59.963675 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:00.283452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '620360b0-c43a-4fc3-b39f-cf23af487e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b595ca30>]}
[0m07:29:00.284718 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:29:00.285438 [info ] [MainThread]: 
[0m07:29:00.290670 [debug] [Thread-1 (]: Began running node model.bc_sales.country_facts
[0m07:29:00.291433 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m07:29:00.292714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.country_facts)
[0m07:29:00.293256 [debug] [Thread-1 (]: Began compiling node model.bc_sales.country_facts
[0m07:29:00.298242 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m07:29:00.299256 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (compile): 07:29:00.293580 => 07:29:00.298930
[0m07:29:00.299845 [debug] [Thread-1 (]: Began executing node model.bc_sales.country_facts
[0m07:29:00.325859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:00.697877 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m07:29:00.698949 [debug] [Thread-1 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
),

country_ref as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
)

select
    countries.cc_ref as ref,
    count(countries.cc_ref) as total_transactions,
    avg(countries.amount_paid_usd) as average_sale_usd,
    sum(countries.amount_paid_usd) as total_sales_usd
from countries
outter join country_ref
on countries.cc_ref = country_ref.cc_ref
group by 1
order by average_sale_usd desc
    );
  
[0m07:29:01.107231 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: countries; Did you mean country? at [31:4]')
[0m07:29:02.474408 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:749acb08-7c95-42ca-bc68-6fd652d8dbab&page=queryresults
[0m07:29:02.476122 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (execute): 07:29:00.300177 => 07:29:02.475613
[0m07:29:02.480278 [debug] [Thread-1 (]: Database Error in model country_facts (models/core/country_facts.sql)
  Unrecognized name: countries; Did you mean country? at [31:4]
  compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:29:02.481118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '620360b0-c43a-4fc3-b39f-cf23af487e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b52b2a70>]}
[0m07:29:02.482141 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bandcamp_sales_schema.country_facts ...... [[31mERROR[0m in 2.19s]
[0m07:29:02.483155 [debug] [Thread-1 (]: Finished running node model.bc_sales.country_facts
[0m07:29:02.486046 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:29:02.486541 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m07:29:02.486974 [info ] [MainThread]: 
[0m07:29:02.487653 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m07:29:02.488701 [debug] [MainThread]: Command end result
[0m07:29:02.502326 [info ] [MainThread]: 
[0m07:29:02.503505 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:29:02.504257 [info ] [MainThread]: 
[0m07:29:02.505037 [error] [MainThread]: [33mDatabase Error in model country_facts (models/core/country_facts.sql)[0m
[0m07:29:02.505710 [error] [MainThread]:   Unrecognized name: countries; Did you mean country? at [31:4]
[0m07:29:02.506303 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:29:02.506893 [info ] [MainThread]: 
[0m07:29:02.507540 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:29:02.508676 [debug] [MainThread]: Command `dbt build` failed at 07:29:02.508473 after 4.07 seconds
[0m07:29:02.509237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02c8d5e560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b57baf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b580d5d0>]}
[0m07:29:02.509823 [debug] [MainThread]: Flushing usage events
[0m07:35:53.190120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e02842590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e014c78b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e014c7880>]}


============================== 07:35:53.193821 | 245e68d4-953b-4512-8f91-f446712286a7 ==============================
[0m07:35:53.193821 [info ] [MainThread]: Running with dbt=1.5.0
[0m07:35:53.195858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'profiles_dir': '/home/j/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:35:54.184306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '245e68d4-953b-4512-8f91-f446712286a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e014c7970>]}
[0m07:35:54.197183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '245e68d4-953b-4512-8f91-f446712286a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7def716680>]}
[0m07:35:54.219419 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m07:35:54.260788 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:35:54.261748 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts.sql
[0m07:35:54.284665 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m07:35:54.322550 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m07:35:54.330963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '245e68d4-953b-4512-8f91-f446712286a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7deef97df0>]}
[0m07:35:54.343169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '245e68d4-953b-4512-8f91-f446712286a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7def508cd0>]}
[0m07:35:54.344016 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m07:35:54.345883 [info ] [MainThread]: 
[0m07:35:54.347089 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:35:54.348795 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m07:35:54.349771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:35:54.724360 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m07:35:54.725186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:35:55.025321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '245e68d4-953b-4512-8f91-f446712286a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7def508a60>]}
[0m07:35:55.026541 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:35:55.027298 [info ] [MainThread]: 
[0m07:35:55.032371 [debug] [Thread-1 (]: Began running node model.bc_sales.country_facts
[0m07:35:55.033129 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m07:35:55.034293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.country_facts)
[0m07:35:55.034845 [debug] [Thread-1 (]: Began compiling node model.bc_sales.country_facts
[0m07:35:55.039917 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m07:35:55.040965 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (compile): 07:35:55.035154 => 07:35:55.040628
[0m07:35:55.041523 [debug] [Thread-1 (]: Began executing node model.bc_sales.country_facts
[0m07:35:55.064658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:35:55.414860 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m07:35:55.415950 [debug] [Thread-1 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
),

country_ref as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
)

select
    country_ref.cc_ref as ref,
    count(countries.cc_ref) as total_transactions,
    avg(countries.amount_paid_usd) as average_sale_usd,
    sum(countries.amount_paid_usd) as total_sales_usd
    country_ref.country_code as cc
from countries
outter join country_ref
on countries.cc_ref = country_ref.cc_ref
group by countries.cc_ref
order by average_sale_usd desc
    );
  
[0m07:35:55.563678 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "country_ref" at [29:5]')
[0m07:35:56.525007 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:US:99a49c31-c304-4916-8ae2-52172a4ebe9a&page=queryresults
[0m07:35:56.526405 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (execute): 07:35:55.041861 => 07:35:56.526033
[0m07:35:56.530108 [debug] [Thread-1 (]: Database Error in model country_facts (models/core/country_facts.sql)
  Syntax error: Expected ")" but got identifier "country_ref" at [29:5]
  compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:35:56.530806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '245e68d4-953b-4512-8f91-f446712286a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7deee6b430>]}
[0m07:35:56.531661 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bandcamp_sales_schema.country_facts ...... [[31mERROR[0m in 1.50s]
[0m07:35:56.532577 [debug] [Thread-1 (]: Finished running node model.bc_sales.country_facts
[0m07:35:56.534904 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:35:56.535284 [debug] [MainThread]: Connection 'list_datatalksclub-375802' was properly closed.
[0m07:35:56.535596 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m07:35:56.536078 [info ] [MainThread]: 
[0m07:35:56.536786 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m07:35:56.537725 [debug] [MainThread]: Command end result
[0m07:35:56.548955 [info ] [MainThread]: 
[0m07:35:56.549926 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:35:56.550625 [info ] [MainThread]: 
[0m07:35:56.551278 [error] [MainThread]: [33mDatabase Error in model country_facts (models/core/country_facts.sql)[0m
[0m07:35:56.552011 [error] [MainThread]:   Syntax error: Expected ")" but got identifier "country_ref" at [29:5]
[0m07:35:56.552622 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:35:56.553240 [info ] [MainThread]: 
[0m07:35:56.553943 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:35:56.554961 [debug] [MainThread]: Command `dbt build` failed at 07:35:56.554787 after 3.37 seconds
[0m07:35:56.555459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e02842590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7def508940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7def508760>]}
[0m07:35:56.556081 [debug] [MainThread]: Flushing usage events
[0m07:36:27.386028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd87195a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8705e37c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8705e37f0>]}


============================== 07:36:27.390157 | 236201d3-2c87-4aae-a2f8-9b74559f10fa ==============================
[0m07:36:27.390157 [info ] [MainThread]: Running with dbt=1.5.0
[0m07:36:27.391425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'version_check': 'True', 'profiles_dir': '/home/j/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:36:28.372147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '236201d3-2c87-4aae-a2f8-9b74559f10fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8705e38e0>]}
[0m07:36:28.385193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '236201d3-2c87-4aae-a2f8-9b74559f10fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd85e7e11b0>]}
[0m07:36:28.407250 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m07:36:28.448320 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:36:28.449380 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts.sql
[0m07:36:28.471395 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m07:36:28.508991 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m07:36:28.516746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '236201d3-2c87-4aae-a2f8-9b74559f10fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd85e46bdf0>]}
[0m07:36:28.529091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '236201d3-2c87-4aae-a2f8-9b74559f10fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd85e5d8c70>]}
[0m07:36:28.529967 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m07:36:28.532352 [info ] [MainThread]: 
[0m07:36:28.533875 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:36:28.535464 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m07:36:28.536116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:36:28.884020 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m07:36:28.884963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:36:29.179405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '236201d3-2c87-4aae-a2f8-9b74559f10fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd85e5d8a90>]}
[0m07:36:29.180578 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:36:29.181564 [info ] [MainThread]: 
[0m07:36:29.186471 [debug] [Thread-1 (]: Began running node model.bc_sales.country_facts
[0m07:36:29.187178 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m07:36:29.188568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.country_facts)
[0m07:36:29.189104 [debug] [Thread-1 (]: Began compiling node model.bc_sales.country_facts
[0m07:36:29.194079 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m07:36:29.195054 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (compile): 07:36:29.189399 => 07:36:29.194724
[0m07:36:29.195587 [debug] [Thread-1 (]: Began executing node model.bc_sales.country_facts
[0m07:36:29.218809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:36:29.583645 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m07:36:29.584675 [debug] [Thread-1 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
),

country_ref as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
)

select
    country_ref.cc_ref as ref,
    count(countries.cc_ref) as total_transactions,
    avg(countries.amount_paid_usd) as average_sale_usd,
    sum(countries.amount_paid_usd) as total_sales_usd,
    country_ref.country_code as cc
from countries
outter join country_ref
on countries.cc_ref = country_ref.cc_ref
group by countries.cc_ref
order by average_sale_usd desc
    );
  
[0m07:36:29.969306 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: countries; Did you mean country? at [32:4]')
[0m07:36:30.930865 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:d42f3c57-2af9-4f08-af57-5b107280e59e&page=queryresults
[0m07:36:30.932305 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (execute): 07:36:29.195984 => 07:36:30.931909
[0m07:36:30.935938 [debug] [Thread-1 (]: Database Error in model country_facts (models/core/country_facts.sql)
  Unrecognized name: countries; Did you mean country? at [32:4]
  compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:36:30.936583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '236201d3-2c87-4aae-a2f8-9b74559f10fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd85df3ece0>]}
[0m07:36:30.937412 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bandcamp_sales_schema.country_facts ...... [[31mERROR[0m in 1.75s]
[0m07:36:30.938289 [debug] [Thread-1 (]: Finished running node model.bc_sales.country_facts
[0m07:36:30.940655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:36:30.941093 [debug] [MainThread]: Connection 'list_datatalksclub-375802' was properly closed.
[0m07:36:30.941427 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m07:36:30.941823 [info ] [MainThread]: 
[0m07:36:30.942449 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.41 seconds (2.41s).
[0m07:36:30.943357 [debug] [MainThread]: Command end result
[0m07:36:30.954867 [info ] [MainThread]: 
[0m07:36:30.955888 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:36:30.956596 [info ] [MainThread]: 
[0m07:36:30.957273 [error] [MainThread]: [33mDatabase Error in model country_facts (models/core/country_facts.sql)[0m
[0m07:36:30.957914 [error] [MainThread]:   Unrecognized name: countries; Did you mean country? at [32:4]
[0m07:36:30.958518 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:36:30.959098 [info ] [MainThread]: 
[0m07:36:30.959723 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:36:30.960860 [debug] [MainThread]: Command `dbt build` failed at 07:36:30.960698 after 3.58 seconds
[0m07:36:30.961368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd87195a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd87142a950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd85e423eb0>]}
[0m07:36:30.962070 [debug] [MainThread]: Flushing usage events
[0m07:37:27.715134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb72c42590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb718c78b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb718c7880>]}


============================== 07:37:27.719026 | 66dc61ea-037b-4fc1-9811-d3d1c21e9ee7 ==============================
[0m07:37:27.719026 [info ] [MainThread]: Running with dbt=1.5.0
[0m07:37:27.720051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/j/.dbt', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:37:28.751006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66dc61ea-037b-4fc1-9811-d3d1c21e9ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb718c7970>]}
[0m07:37:28.763614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66dc61ea-037b-4fc1-9811-d3d1c21e9ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5fae11b0>]}
[0m07:37:28.786373 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m07:37:28.827107 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:37:28.828108 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts.sql
[0m07:37:28.851278 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m07:37:28.890502 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m07:37:28.898360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66dc61ea-037b-4fc1-9811-d3d1c21e9ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5f76bdf0>]}
[0m07:37:28.910776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66dc61ea-037b-4fc1-9811-d3d1c21e9ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5f8d8cd0>]}
[0m07:37:28.911536 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m07:37:28.913505 [info ] [MainThread]: 
[0m07:37:28.914776 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:37:28.916389 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m07:37:28.917016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:29.289244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m07:37:29.290080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:37:29.594671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66dc61ea-037b-4fc1-9811-d3d1c21e9ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5f8d8a60>]}
[0m07:37:29.596066 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:37:29.596901 [info ] [MainThread]: 
[0m07:37:29.602467 [debug] [Thread-1 (]: Began running node model.bc_sales.country_facts
[0m07:37:29.603337 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m07:37:29.604706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.country_facts)
[0m07:37:29.605264 [debug] [Thread-1 (]: Began compiling node model.bc_sales.country_facts
[0m07:37:29.610545 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m07:37:29.611556 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (compile): 07:37:29.605570 => 07:37:29.611211
[0m07:37:29.612126 [debug] [Thread-1 (]: Began executing node model.bc_sales.country_facts
[0m07:37:29.639196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:37:29.982421 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m07:37:29.983450 [debug] [Thread-1 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
),

country_ref as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
)

select
    country_ref.cc_ref as ref,
    count(countries.cc_ref) as total_transactions,
    avg(countries.amount_paid_usd) as average_sale_usd,
    sum(countries.amount_paid_usd) as total_sales_usd,
    country_ref.country_code as cc
from countries
left join country_ref
on countries.cc_ref = country_ref.cc_ref
group by countries.cc_ref
order by average_sale_usd desc
    );
  
[0m07:37:30.359038 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references country_ref.cc_ref which is neither grouped nor aggregated at [25:5]')
[0m07:37:30.745347 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:6c64d041-1777-4ec4-af60-3d0f255cf315&page=queryresults
[0m07:37:30.747049 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (execute): 07:37:29.612493 => 07:37:30.746684
[0m07:37:30.750818 [debug] [Thread-1 (]: Database Error in model country_facts (models/core/country_facts.sql)
  SELECT list expression references country_ref.cc_ref which is neither grouped nor aggregated at [25:5]
  compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:37:30.751573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66dc61ea-037b-4fc1-9811-d3d1c21e9ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5f242a10>]}
[0m07:37:30.752496 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bandcamp_sales_schema.country_facts ...... [[31mERROR[0m in 1.15s]
[0m07:37:30.753715 [debug] [Thread-1 (]: Finished running node model.bc_sales.country_facts
[0m07:37:30.756280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:37:30.756700 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m07:37:30.757083 [info ] [MainThread]: 
[0m07:37:30.757711 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m07:37:30.758603 [debug] [MainThread]: Command end result
[0m07:37:30.769610 [info ] [MainThread]: 
[0m07:37:30.770517 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:37:30.771165 [info ] [MainThread]: 
[0m07:37:30.771856 [error] [MainThread]: [33mDatabase Error in model country_facts (models/core/country_facts.sql)[0m
[0m07:37:30.772474 [error] [MainThread]:   SELECT list expression references country_ref.cc_ref which is neither grouped nor aggregated at [25:5]
[0m07:37:30.773072 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:37:30.773641 [info ] [MainThread]: 
[0m07:37:30.774252 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:37:30.775216 [debug] [MainThread]: Command `dbt build` failed at 07:37:30.775057 after 3.07 seconds
[0m07:37:30.775719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb72c42590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5faeb3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5faebb20>]}
[0m07:37:30.776345 [debug] [MainThread]: Flushing usage events
[0m07:38:43.984470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce69b52500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce687db820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce687db7f0>]}


============================== 07:38:43.988062 | 04cf6f39-14f0-488d-b869-39f2f254d4cd ==============================
[0m07:38:43.988062 [info ] [MainThread]: Running with dbt=1.5.0
[0m07:38:43.989094 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:38:44.975956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04cf6f39-14f0-488d-b869-39f2f254d4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce687db8e0>]}
[0m07:38:44.988715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04cf6f39-14f0-488d-b869-39f2f254d4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce569691b0>]}
[0m07:38:45.011397 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m07:38:45.052359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:38:45.053331 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts.sql
[0m07:38:45.075945 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m07:38:45.114168 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m07:38:45.122454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04cf6f39-14f0-488d-b869-39f2f254d4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce565ebdf0>]}
[0m07:38:45.134837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04cf6f39-14f0-488d-b869-39f2f254d4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce5675cc40>]}
[0m07:38:45.135645 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m07:38:45.137693 [info ] [MainThread]: 
[0m07:38:45.138998 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:38:45.140629 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m07:38:45.141264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:38:45.486577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m07:38:45.487384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:38:45.770734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04cf6f39-14f0-488d-b869-39f2f254d4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce5675c9d0>]}
[0m07:38:45.771945 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:38:45.772643 [info ] [MainThread]: 
[0m07:38:45.777464 [debug] [Thread-1 (]: Began running node model.bc_sales.country_facts
[0m07:38:45.778166 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m07:38:45.779334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.country_facts)
[0m07:38:45.779926 [debug] [Thread-1 (]: Began compiling node model.bc_sales.country_facts
[0m07:38:45.784652 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m07:38:45.785643 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (compile): 07:38:45.780286 => 07:38:45.785331
[0m07:38:45.786128 [debug] [Thread-1 (]: Began executing node model.bc_sales.country_facts
[0m07:38:45.811751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:38:46.167675 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m07:38:46.168760 [debug] [Thread-1 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
),

country_ref as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
)

select
    country_ref.cc_ref as ref,
    count(countries.cc_ref) as total_transactions,
    avg(countries.amount_paid_usd) as average_sale_usd,
    sum(countries.amount_paid_usd) as total_sales_usd,
    country_ref.country_code as cc
from countries
left join country_ref
on countries.cc_ref = country_ref.cc_ref
group by country_ref.cc_ref
order by average_sale_usd desc
    );
  
[0m07:38:46.579359 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references country_ref.country_code which is neither grouped nor aggregated at [29:5]')
[0m07:38:47.462679 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:79a35dc6-3e8d-468b-a6e3-c0641619434b&page=queryresults
[0m07:38:47.464666 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (execute): 07:38:45.786480 => 07:38:47.464286
[0m07:38:47.468340 [debug] [Thread-1 (]: Database Error in model country_facts (models/core/country_facts.sql)
  SELECT list expression references country_ref.country_code which is neither grouped nor aggregated at [29:5]
  compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:38:47.469092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04cf6f39-14f0-488d-b869-39f2f254d4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce560be9b0>]}
[0m07:38:47.469944 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bandcamp_sales_schema.country_facts ...... [[31mERROR[0m in 1.69s]
[0m07:38:47.471078 [debug] [Thread-1 (]: Finished running node model.bc_sales.country_facts
[0m07:38:47.473419 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:38:47.473947 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m07:38:47.474378 [info ] [MainThread]: 
[0m07:38:47.475520 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.34 seconds (2.34s).
[0m07:38:47.476633 [debug] [MainThread]: Command end result
[0m07:38:47.488400 [info ] [MainThread]: 
[0m07:38:47.489337 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:38:47.489976 [info ] [MainThread]: 
[0m07:38:47.490581 [error] [MainThread]: [33mDatabase Error in model country_facts (models/core/country_facts.sql)[0m
[0m07:38:47.491200 [error] [MainThread]:   SELECT list expression references country_ref.country_code which is neither grouped nor aggregated at [29:5]
[0m07:38:47.491896 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:38:47.492530 [info ] [MainThread]: 
[0m07:38:47.493143 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:38:47.494107 [debug] [MainThread]: Command `dbt build` failed at 07:38:47.493952 after 3.52 seconds
[0m07:38:47.494614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce69b52500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce6b104310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce565a3e80>]}
[0m07:38:47.495091 [debug] [MainThread]: Flushing usage events
[0m07:45:15.669765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa949b56530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9487df7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9487df820>]}


============================== 07:45:15.673414 | 097d5d3f-7c81-411f-a174-dd0cebe738cb ==============================
[0m07:45:15.673414 [info ] [MainThread]: Running with dbt=1.5.0
[0m07:45:15.675318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:45:16.732981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '097d5d3f-7c81-411f-a174-dd0cebe738cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9487df910>]}
[0m07:45:16.746177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '097d5d3f-7c81-411f-a174-dd0cebe738cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa936969240>]}
[0m07:45:16.768476 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m07:45:16.809873 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:45:16.810809 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts.sql
[0m07:45:16.833024 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m07:45:16.871836 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m07:45:16.879504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '097d5d3f-7c81-411f-a174-dd0cebe738cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9365f7d90>]}
[0m07:45:16.892142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '097d5d3f-7c81-411f-a174-dd0cebe738cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93675cca0>]}
[0m07:45:16.893212 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m07:45:16.895341 [info ] [MainThread]: 
[0m07:45:16.896819 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:45:16.898535 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m07:45:16.899324 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:45:17.246080 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m07:45:17.246901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:45:17.539763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '097d5d3f-7c81-411f-a174-dd0cebe738cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93675cac0>]}
[0m07:45:17.541079 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:45:17.541823 [info ] [MainThread]: 
[0m07:45:17.547096 [debug] [Thread-1 (]: Began running node model.bc_sales.country_facts
[0m07:45:17.547973 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m07:45:17.549226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.country_facts)
[0m07:45:17.549888 [debug] [Thread-1 (]: Began compiling node model.bc_sales.country_facts
[0m07:45:17.554966 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m07:45:17.556054 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (compile): 07:45:17.550216 => 07:45:17.555644
[0m07:45:17.556605 [debug] [Thread-1 (]: Began executing node model.bc_sales.country_facts
[0m07:45:17.582988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:45:17.948005 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m07:45:17.949351 [debug] [Thread-1 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
),

country_ref as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
)

select
    countries.cc_ref as ref,
    count(countries.cc_ref) as total_transactions,
    avg(countries.amount_paid_usd) as average_sale_usd,
    sum(countries.amount_paid_usd) as total_sales_usd,
    country_ref.country_code as cc
from countries
inner join country_ref
on countries.cc_ref = country_ref.cc_ref
group by country_ref.cc_ref
order by average_sale_usd desc
    );
  
[0m07:45:18.371306 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references countries.cc_ref which is neither grouped nor aggregated at [25:5]')
[0m07:45:19.158857 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:8d51e6da-cfe5-48fc-908e-5d6e2398525c&page=queryresults
[0m07:45:19.160682 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (execute): 07:45:17.556942 => 07:45:19.160309
[0m07:45:19.164473 [debug] [Thread-1 (]: Database Error in model country_facts (models/core/country_facts.sql)
  SELECT list expression references countries.cc_ref which is neither grouped nor aggregated at [25:5]
  compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:45:19.165356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097d5d3f-7c81-411f-a174-dd0cebe738cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9360bec20>]}
[0m07:45:19.166263 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bandcamp_sales_schema.country_facts ...... [[31mERROR[0m in 1.62s]
[0m07:45:19.167448 [debug] [Thread-1 (]: Finished running node model.bc_sales.country_facts
[0m07:45:19.170198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:45:19.170719 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m07:45:19.171181 [info ] [MainThread]: 
[0m07:45:19.171899 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.27 seconds (2.27s).
[0m07:45:19.173103 [debug] [MainThread]: Command end result
[0m07:45:19.184693 [info ] [MainThread]: 
[0m07:45:19.185630 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:45:19.186303 [info ] [MainThread]: 
[0m07:45:19.187067 [error] [MainThread]: [33mDatabase Error in model country_facts (models/core/country_facts.sql)[0m
[0m07:45:19.187671 [error] [MainThread]:   SELECT list expression references countries.cc_ref which is neither grouped nor aggregated at [25:5]
[0m07:45:19.188435 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m07:45:19.189065 [info ] [MainThread]: 
[0m07:45:19.189868 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:45:19.191011 [debug] [MainThread]: Command `dbt build` failed at 07:45:19.190834 after 3.53 seconds
[0m07:45:19.191541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa949b56530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9496854b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa936972530>]}
[0m07:45:19.192124 [debug] [MainThread]: Flushing usage events
[0m08:05:04.933374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17bba42590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17ba6cb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17ba6cb880>]}


============================== 08:05:04.937142 | 236a0b3a-d7c8-4d89-8096-a0b7c23c9c46 ==============================
[0m08:05:04.937142 [info ] [MainThread]: Running with dbt=1.5.0
[0m08:05:04.938224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/j/.dbt', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:05:05.933343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '236a0b3a-d7c8-4d89-8096-a0b7c23c9c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17ba6cb970>]}
[0m08:05:05.946286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '236a0b3a-d7c8-4d89-8096-a0b7c23c9c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a88111b0>]}
[0m08:05:05.968826 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m08:05:06.010067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m08:05:06.010912 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/core/country_facts_view.sql
[0m08:05:06.011527 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts.sql
[0m08:05:06.033466 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts_view.sql
[0m08:05:06.051374 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m08:05:06.076949 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m08:05:06.084655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '236a0b3a-d7c8-4d89-8096-a0b7c23c9c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8490d60>]}
[0m08:05:06.097245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '236a0b3a-d7c8-4d89-8096-a0b7c23c9c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8608df0>]}
[0m08:05:06.098002 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m08:05:06.099931 [info ] [MainThread]: 
[0m08:05:06.101188 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:05:06.102749 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m08:05:06.103359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:05:06.465847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m08:05:06.466674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:05:06.798871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '236a0b3a-d7c8-4d89-8096-a0b7c23c9c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a86086a0>]}
[0m08:05:06.800103 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:05:06.801051 [info ] [MainThread]: 
[0m08:05:06.806746 [debug] [Thread-1 (]: Began running node model.bc_sales.country_facts
[0m08:05:06.807559 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m08:05:06.809114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.country_facts)
[0m08:05:06.809643 [debug] [Thread-1 (]: Began compiling node model.bc_sales.country_facts
[0m08:05:06.815028 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m08:05:06.816282 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (compile): 08:05:06.810189 => 08:05:06.815866
[0m08:05:06.816889 [debug] [Thread-1 (]: Began executing node model.bc_sales.country_facts
[0m08:05:06.844017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:05:07.199211 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m08:05:07.200252 [debug] [Thread-1 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
)--,

--country_ref as (
--    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
--)

select
    countries.cc_ref as ref,
    count(countries.cc_ref) as total_transactions,
    avg(countries.amount_paid_usd) as average_sale_usd,
    sum(countries.amount_paid_usd) as total_sales_usd,
from countries
--inner join country_ref
--on countries.cc_ref = country_ref.cc_ref
group by country_ref.cc_ref
order by average_sale_usd desc
    );
  
[0m08:05:07.617366 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: country_ref; Did you mean countries? at [32:10]')
[0m08:05:08.806566 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:ead4f1fe-03b7-4070-ac45-fbbc25f9aa98&page=queryresults
[0m08:05:08.808069 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (execute): 08:05:06.817234 => 08:05:08.807626
[0m08:05:08.812083 [debug] [Thread-1 (]: Database Error in model country_facts (models/core/country_facts.sql)
  Unrecognized name: country_ref; Did you mean countries? at [32:10]
  compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m08:05:08.812816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '236a0b3a-d7c8-4d89-8096-a0b7c23c9c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a3f3aaa0>]}
[0m08:05:08.813700 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bandcamp_sales_schema.country_facts ...... [[31mERROR[0m in 2.00s]
[0m08:05:08.814627 [debug] [Thread-1 (]: Finished running node model.bc_sales.country_facts
[0m08:05:08.817146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:05:08.817631 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m08:05:08.818063 [info ] [MainThread]: 
[0m08:05:08.819003 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.72 seconds (2.72s).
[0m08:05:08.820106 [debug] [MainThread]: Command end result
[0m08:05:08.831482 [info ] [MainThread]: 
[0m08:05:08.832463 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:05:08.833106 [info ] [MainThread]: 
[0m08:05:08.833768 [error] [MainThread]: [33mDatabase Error in model country_facts (models/core/country_facts.sql)[0m
[0m08:05:08.834423 [error] [MainThread]:   Unrecognized name: country_ref; Did you mean countries? at [32:10]
[0m08:05:08.835018 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/country_facts.sql
[0m08:05:08.835606 [info ] [MainThread]: 
[0m08:05:08.836351 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:05:08.837321 [debug] [MainThread]: Command `dbt build` failed at 08:05:08.837152 after 3.91 seconds
[0m08:05:08.837809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17bba42590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a88111b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17bd1f8310>]}
[0m08:05:08.838310 [debug] [MainThread]: Flushing usage events
[0m08:07:13.333329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d4034a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3efd3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3efd3880>]}


============================== 08:07:13.337008 | 4afcd12a-5ba4-4f6d-a90c-45669c621783 ==============================
[0m08:07:13.337008 [info ] [MainThread]: Running with dbt=1.5.0
[0m08:07:13.337930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'debug': 'False', 'profiles_dir': '/home/j/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:07:14.348705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4afcd12a-5ba4-4f6d-a90c-45669c621783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3efd3970>]}
[0m08:07:14.361535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4afcd12a-5ba4-4f6d-a90c-45669c621783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2d1351b0>]}
[0m08:07:14.384950 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m08:07:14.427869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m08:07:14.428856 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts.sql
[0m08:07:14.429443 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts_view.sql
[0m08:07:14.451856 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m08:07:14.469779 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts_view.sql
[0m08:07:14.495207 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m08:07:14.502871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4afcd12a-5ba4-4f6d-a90c-45669c621783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2cf4c910>]}
[0m08:07:14.515488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4afcd12a-5ba4-4f6d-a90c-45669c621783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2cf2d240>]}
[0m08:07:14.516929 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m08:07:14.519292 [info ] [MainThread]: 
[0m08:07:14.520717 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:07:14.522395 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m08:07:14.523155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:07:14.873464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m08:07:14.874305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:07:15.179423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4afcd12a-5ba4-4f6d-a90c-45669c621783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2cf2cc10>]}
[0m08:07:15.180766 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:07:15.181820 [info ] [MainThread]: 
[0m08:07:15.187052 [debug] [Thread-1 (]: Began running node model.bc_sales.country_facts
[0m08:07:15.187966 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m08:07:15.189437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.country_facts)
[0m08:07:15.189944 [debug] [Thread-1 (]: Began compiling node model.bc_sales.country_facts
[0m08:07:15.195078 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m08:07:15.196188 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (compile): 08:07:15.190470 => 08:07:15.195824
[0m08:07:15.196766 [debug] [Thread-1 (]: Began executing node model.bc_sales.country_facts
[0m08:07:15.224015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:07:15.592374 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m08:07:15.593486 [debug] [Thread-1 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      

-- TODO

with countries as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
)--,

--country_ref as (
--    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
--)

select
    countries.cc_ref as ref,
    count(countries.cc_ref) as total_transactions,
    avg(countries.amount_paid_usd) as average_sale_usd,
    sum(countries.amount_paid_usd) as total_sales_usd,
from countries
--inner join country_ref
--on countries.cc_ref = country_ref.cc_ref
group by countries.cc_ref
order by average_sale_usd desc
    );
  
[0m08:07:17.665454 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:c7c19a16-20e0-4a70-9357-658a2b20023e&page=queryresults
[0m08:07:17.688956 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts (execute): 08:07:15.197079 => 08:07:17.688616
[0m08:07:17.690292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4afcd12a-5ba4-4f6d-a90c-45669c621783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2cdd3e20>]}
[0m08:07:17.691288 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bandcamp_sales_schema.country_facts .......... [[32mCREATE TABLE (186.0 rows, 15.3 MiB processed)[0m in 2.50s]
[0m08:07:17.692627 [debug] [Thread-1 (]: Finished running node model.bc_sales.country_facts
[0m08:07:17.695183 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:07:17.695641 [debug] [MainThread]: Connection 'model.bc_sales.country_facts' was properly closed.
[0m08:07:17.696137 [info ] [MainThread]: 
[0m08:07:17.696906 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.18 seconds (3.18s).
[0m08:07:17.698029 [debug] [MainThread]: Command end result
[0m08:07:17.710177 [info ] [MainThread]: 
[0m08:07:17.711300 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:07:17.712152 [info ] [MainThread]: 
[0m08:07:17.712866 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:07:17.713967 [debug] [MainThread]: Command `dbt build` succeeded at 08:07:17.713789 after 4.39 seconds
[0m08:07:17.714490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d4034a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2d13f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2cd9f9d0>]}
[0m08:07:17.715029 [debug] [MainThread]: Flushing usage events
[0m08:07:31.248938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c8242590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c6ec78b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c6ec7880>]}


============================== 08:07:31.252794 | 520cfeae-096f-4284-8bf5-d3083ce9c63d ==============================
[0m08:07:31.252794 [info ] [MainThread]: Running with dbt=1.5.0
[0m08:07:31.253879 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/j/.dbt', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:07:32.269735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '520cfeae-096f-4284-8bf5-d3083ce9c63d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c6ec7970>]}
[0m08:07:32.282133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '520cfeae-096f-4284-8bf5-d3083ce9c63d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0b504df60>]}
[0m08:07:32.305075 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m08:07:32.346181 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:07:32.346821 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:07:32.347671 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m08:07:32.356651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '520cfeae-096f-4284-8bf5-d3083ce9c63d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0b4c980d0>]}
[0m08:07:32.370180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '520cfeae-096f-4284-8bf5-d3083ce9c63d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0b4e59150>]}
[0m08:07:32.370949 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m08:07:32.373219 [info ] [MainThread]: 
[0m08:07:32.374596 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:07:32.376352 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m08:07:32.377102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:07:32.715575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m08:07:32.716601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:07:32.985459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '520cfeae-096f-4284-8bf5-d3083ce9c63d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0b4e58b20>]}
[0m08:07:32.986667 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:07:32.987717 [info ] [MainThread]: 
[0m08:07:32.993090 [debug] [Thread-1 (]: Began running node model.bc_sales.country_facts_view
[0m08:07:32.993921 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.country_facts_view .......... [RUN]
[0m08:07:32.995531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.country_facts_view)
[0m08:07:32.996166 [debug] [Thread-1 (]: Began compiling node model.bc_sales.country_facts_view
[0m08:07:33.001408 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.country_facts_view"
[0m08:07:33.002490 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts_view (compile): 08:07:32.996523 => 08:07:33.002128
[0m08:07:33.003003 [debug] [Thread-1 (]: Began executing node model.bc_sales.country_facts_view
[0m08:07:33.054711 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.country_facts_view"
[0m08:07:33.055939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:07:33.105289 [debug] [Thread-1 (]: On model.bc_sales.country_facts_view: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts_view"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts_view`
    
    

    OPTIONS()
    as (
      

with facts as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
),

refs as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
)

select
    facts.ref as ref,
    facts.total_transactions as total_transactions,
    facts.average_sales_usd as avg_sales_usd,
    facts.total_sales_usd as total_sales_usd,
    refs.country_code as cc
from facts
left join refs
on facts.ref = refs.cc_ref
where total_transactions > 100
    );
  
[0m08:07:33.774273 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name average_sales_usd not found inside facts at [25:11]')
[0m08:07:35.166906 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:e9765649-1ff4-4dfa-a761-0db9ecaaaf59&page=queryresults
[0m08:07:35.168732 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts_view (execute): 08:07:33.003315 => 08:07:35.168224
[0m08:07:35.173399 [debug] [Thread-1 (]: Database Error in model country_facts_view (models/core/country_facts_view.sql)
  Name average_sales_usd not found inside facts at [25:11]
  compiled Code at target/run/bc_sales/models/core/country_facts_view.sql
[0m08:07:35.174454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '520cfeae-096f-4284-8bf5-d3083ce9c63d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0b4e4a680>]}
[0m08:07:35.175580 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bandcamp_sales_schema.country_facts_view . [[31mERROR[0m in 2.18s]
[0m08:07:35.176682 [debug] [Thread-1 (]: Finished running node model.bc_sales.country_facts_view
[0m08:07:35.179565 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:07:35.180131 [debug] [MainThread]: Connection 'model.bc_sales.country_facts_view' was properly closed.
[0m08:07:35.180587 [info ] [MainThread]: 
[0m08:07:35.181576 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m08:07:35.182613 [debug] [MainThread]: Command end result
[0m08:07:35.210545 [info ] [MainThread]: 
[0m08:07:35.211843 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:07:35.212628 [info ] [MainThread]: 
[0m08:07:35.213339 [error] [MainThread]: [33mDatabase Error in model country_facts_view (models/core/country_facts_view.sql)[0m
[0m08:07:35.214051 [error] [MainThread]:   Name average_sales_usd not found inside facts at [25:11]
[0m08:07:35.214716 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/country_facts_view.sql
[0m08:07:35.215314 [info ] [MainThread]: 
[0m08:07:35.216008 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:07:35.217084 [debug] [MainThread]: Command `dbt build` failed at 08:07:35.216914 after 3.98 seconds
[0m08:07:35.217635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c8242590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0b4c7aaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0b4c7ba00>]}
[0m08:07:35.218196 [debug] [MainThread]: Flushing usage events
[0m08:08:35.339268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b6a4a5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b59cf880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b59cf8b0>]}


============================== 08:08:35.343235 | 593ea46f-71bf-4d69-a1f0-6243bb2c44da ==============================
[0m08:08:35.343235 [info ] [MainThread]: Running with dbt=1.5.0
[0m08:08:35.344583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'profiles_dir': '/home/j/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:08:36.354478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '593ea46f-71bf-4d69-a1f0-6243bb2c44da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b59cf9a0>]}
[0m08:08:36.367752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '593ea46f-71bf-4d69-a1f0-6243bb2c44da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a37c1f90>]}
[0m08:08:36.389764 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m08:08:36.430817 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:08:36.431787 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts_view.sql
[0m08:08:36.453738 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts_view.sql
[0m08:08:36.477904 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m08:08:36.486249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '593ea46f-71bf-4d69-a1f0-6243bb2c44da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a34640d0>]}
[0m08:08:36.499484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '593ea46f-71bf-4d69-a1f0-6243bb2c44da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a35c5240>]}
[0m08:08:36.500441 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m08:08:36.502317 [info ] [MainThread]: 
[0m08:08:36.503533 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:08:36.505148 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m08:08:36.505804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:08:36.853037 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m08:08:36.853847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:08:37.144817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '593ea46f-71bf-4d69-a1f0-6243bb2c44da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a35c4c10>]}
[0m08:08:37.145985 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:08:37.146966 [info ] [MainThread]: 
[0m08:08:37.152143 [debug] [Thread-1 (]: Began running node model.bc_sales.country_facts_view
[0m08:08:37.152906 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.country_facts_view .......... [RUN]
[0m08:08:37.154494 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bc_sales.country_facts_view'
[0m08:08:37.154958 [debug] [Thread-1 (]: Began compiling node model.bc_sales.country_facts_view
[0m08:08:37.160012 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.country_facts_view"
[0m08:08:37.160998 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts_view (compile): 08:08:37.155486 => 08:08:37.160680
[0m08:08:37.161541 [debug] [Thread-1 (]: Began executing node model.bc_sales.country_facts_view
[0m08:08:37.212756 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.country_facts_view"
[0m08:08:37.213826 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:08:37.263289 [debug] [Thread-1 (]: On model.bc_sales.country_facts_view: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts_view"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts_view`
    
    

    OPTIONS()
    as (
      

with facts as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
),

refs as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
)

select
    facts.ref as ref,
    facts.total_transactions as total_transactions,
    facts.average_sale_usd as avg_sale_usd,
    facts.total_sales_usd as total_sales_usd,
    refs.country_code as cc
from facts
left join refs
on facts.ref = refs.cc_ref
where total_transactions > 100
    );
  
[0m08:08:39.234458 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:e56ded32-7c75-4e72-8c01-4899aac243cf&page=queryresults
[0m08:08:39.255637 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts_view (execute): 08:08:37.161842 => 08:08:39.255308
[0m08:08:39.256987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '593ea46f-71bf-4d69-a1f0-6243bb2c44da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a34dbfd0>]}
[0m08:08:39.258077 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bandcamp_sales_schema.country_facts_view ..... [[32mCREATE TABLE (78.0 rows, 10.9 KiB processed)[0m in 2.10s]
[0m08:08:39.259436 [debug] [Thread-1 (]: Finished running node model.bc_sales.country_facts_view
[0m08:08:39.262052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:08:39.262503 [debug] [MainThread]: Connection 'list_datatalksclub-375802_bandcamp_sales_schema' was properly closed.
[0m08:08:39.262824 [debug] [MainThread]: Connection 'model.bc_sales.country_facts_view' was properly closed.
[0m08:08:39.263235 [info ] [MainThread]: 
[0m08:08:39.263937 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.76 seconds (2.76s).
[0m08:08:39.265110 [debug] [MainThread]: Command end result
[0m08:08:39.288990 [info ] [MainThread]: 
[0m08:08:39.290450 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:08:39.291439 [info ] [MainThread]: 
[0m08:08:39.292275 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:08:39.293357 [debug] [MainThread]: Command `dbt build` succeeded at 08:08:39.293177 after 3.96 seconds
[0m08:08:39.293886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b6a4a5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b81f4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a347bac0>]}
[0m08:08:39.294432 [debug] [MainThread]: Flushing usage events
[0m08:11:26.570015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a054a5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc19f1cf8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc19f1cf8b0>]}


============================== 08:11:26.573833 | 00fe0e1e-19b2-452e-9c7e-b7d6e7697ac9 ==============================
[0m08:11:26.573833 [info ] [MainThread]: Running with dbt=1.5.0
[0m08:11:26.574842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/j/.dbt', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:11:27.592810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00fe0e1e-19b2-452e-9c7e-b7d6e7697ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc19f1cf9a0>]}
[0m08:11:27.605822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00fe0e1e-19b2-452e-9c7e-b7d6e7697ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc18d2e9f90>]}
[0m08:11:27.628526 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m08:11:27.670056 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:11:27.671008 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts_view.sql
[0m08:11:27.693698 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts_view.sql
[0m08:11:27.719553 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m08:11:27.728329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00fe0e1e-19b2-452e-9c7e-b7d6e7697ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc18cf980d0>]}
[0m08:11:27.742410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00fe0e1e-19b2-452e-9c7e-b7d6e7697ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc18d0f5240>]}
[0m08:11:27.743263 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m08:11:27.745497 [info ] [MainThread]: 
[0m08:11:27.746887 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:11:27.748615 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m08:11:27.749451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:11:28.113995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m08:11:28.114787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:28.410391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00fe0e1e-19b2-452e-9c7e-b7d6e7697ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc18d0f4c10>]}
[0m08:11:28.411990 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:11:28.412877 [info ] [MainThread]: 
[0m08:11:28.418250 [debug] [Thread-1 (]: Began running node model.bc_sales.country_facts_view
[0m08:11:28.419129 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.country_facts_view .......... [RUN]
[0m08:11:28.420471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.country_facts_view)
[0m08:11:28.421279 [debug] [Thread-1 (]: Began compiling node model.bc_sales.country_facts_view
[0m08:11:28.426451 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.country_facts_view"
[0m08:11:28.427438 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts_view (compile): 08:11:28.421682 => 08:11:28.427108
[0m08:11:28.427999 [debug] [Thread-1 (]: Began executing node model.bc_sales.country_facts_view
[0m08:11:28.448561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:28.791181 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.country_facts_view"
[0m08:11:28.792253 [debug] [Thread-1 (]: On model.bc_sales.country_facts_view: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts_view"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts_view`
    
    

    OPTIONS()
    as (
      

with facts as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
),

refs as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
)

select
    facts.ref as ref,
    facts.total_transactions as total_transactions,
    facts.average_sale_usd as avg_sale_usd,
    facts.total_sales_usd as total_sales_usd,
    refs.country_code as cc
from facts
left join refs
on facts.ref = refs.cc_ref
where total_transactions > 100
order by 3 desc
    );
  
[0m08:11:30.947869 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:01afbe46-0c0a-45d1-beb4-d72a13de1178&page=queryresults
[0m08:11:30.972084 [debug] [Thread-1 (]: Timing info for model.bc_sales.country_facts_view (execute): 08:11:28.428398 => 08:11:30.971704
[0m08:11:30.973251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00fe0e1e-19b2-452e-9c7e-b7d6e7697ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc18d00ff40>]}
[0m08:11:30.974170 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bandcamp_sales_schema.country_facts_view ..... [[32mCREATE TABLE (78.0 rows, 10.9 KiB processed)[0m in 2.55s]
[0m08:11:30.975386 [debug] [Thread-1 (]: Finished running node model.bc_sales.country_facts_view
[0m08:11:30.977693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:11:30.978116 [debug] [MainThread]: Connection 'model.bc_sales.country_facts_view' was properly closed.
[0m08:11:30.978530 [info ] [MainThread]: 
[0m08:11:30.979472 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.23 seconds (3.23s).
[0m08:11:30.980631 [debug] [MainThread]: Command end result
[0m08:11:31.003589 [info ] [MainThread]: 
[0m08:11:31.004707 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:11:31.005406 [info ] [MainThread]: 
[0m08:11:31.006075 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:11:31.007278 [debug] [MainThread]: Command `dbt build` succeeded at 08:11:31.006983 after 4.45 seconds
[0m08:11:31.007992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a054a5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a1cfc310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc18cffe230>]}
[0m08:11:31.008599 [debug] [MainThread]: Flushing usage events
[0m08:49:48.116733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c335a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c1fdf8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c1fdf880>]}


============================== 08:49:48.120768 | 03781f10-9e30-4d13-86b9-c503570c830b ==============================
[0m08:49:48.120768 [info ] [MainThread]: Running with dbt=1.5.0
[0m08:49:48.122825 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'profiles_dir': '/home/j/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:49:49.374044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03781f10-9e30-4d13-86b9-c503570c830b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c1fdf970>]}
[0m08:49:49.387802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03781f10-9e30-4d13-86b9-c503570c830b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67b01f11b0>]}
[0m08:49:49.411117 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m08:49:49.462291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m08:49:49.463195 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/core/artist_facts.sql
[0m08:49:49.463865 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/staging/stg_higher_activity_countries.sql
[0m08:49:49.464452 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts.sql
[0m08:49:49.464990 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/country_facts_view.sql
[0m08:49:49.488760 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_facts.sql
[0m08:49:49.506911 [debug] [MainThread]: 1603: static parser failed on staging/stg_higher_activity_countries.sql
[0m08:49:49.528835 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_higher_activity_countries.sql
[0m08:49:49.531260 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m08:49:49.535984 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts_view.sql
[0m08:49:49.561716 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m08:49:49.569873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03781f10-9e30-4d13-86b9-c503570c830b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67afea5630>]}
[0m08:49:49.584446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03781f10-9e30-4d13-86b9-c503570c830b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67afe01300>]}
[0m08:49:49.585202 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m08:49:49.587219 [info ] [MainThread]: 
[0m08:49:49.588558 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:49:49.590261 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m08:49:49.590976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:49:49.970489 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m08:49:49.971271 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:49:50.288107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03781f10-9e30-4d13-86b9-c503570c830b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67afe00cd0>]}
[0m08:49:50.289414 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:49:50.290490 [info ] [MainThread]: 
[0m08:49:50.300426 [debug] [Thread-1 (]: Began running node model.bc_sales.artist_facts
[0m08:49:50.301398 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.artist_facts ................ [RUN]
[0m08:49:50.302885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.artist_facts)
[0m08:49:50.303408 [debug] [Thread-1 (]: Began compiling node model.bc_sales.artist_facts
[0m08:49:50.308415 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.artist_facts"
[0m08:49:50.309566 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_facts (compile): 08:49:50.304081 => 08:49:50.309222
[0m08:49:50.310079 [debug] [Thread-1 (]: Began executing node model.bc_sales.artist_facts
[0m08:49:50.354340 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.artist_facts"
[0m08:49:50.355500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:49:50.404451 [debug] [Thread-1 (]: On model.bc_sales.artist_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.artist_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_facts`
    
    

    OPTIONS()
    as (
      

with sales as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_higher_activity_countries`
)

select
    cc_ref as cc_ref,
    artist_name as artist,
    sum(amount_paid_usd) as total_sales_usd,
    avg(amount_paid_usd) as avg_sales_usd,
from sales
group by 1,2
order by 1,2,3 desc
    );
  
[0m08:49:54.558079 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:2e2339e7-1cb6-4853-9d4c-1967fb81acfb&page=queryresults
[0m08:49:54.579880 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_facts (execute): 08:49:50.310367 => 08:49:54.579512
[0m08:49:54.581200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03781f10-9e30-4d13-86b9-c503570c830b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67affeb3d0>]}
[0m08:49:54.582275 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bandcamp_sales_schema.artist_facts ........... [[32mCREATE TABLE (361.0k rows, 29.5 MiB processed)[0m in 4.28s]
[0m08:49:54.583630 [debug] [Thread-1 (]: Finished running node model.bc_sales.artist_facts
[0m08:49:54.586418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:49:54.586899 [debug] [MainThread]: Connection 'model.bc_sales.artist_facts' was properly closed.
[0m08:49:54.587339 [info ] [MainThread]: 
[0m08:49:54.588316 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.00 seconds (5.00s).
[0m08:49:54.589581 [debug] [MainThread]: Command end result
[0m08:49:54.604560 [info ] [MainThread]: 
[0m08:49:54.605986 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:49:54.606846 [info ] [MainThread]: 
[0m08:49:54.607830 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:49:54.609098 [debug] [MainThread]: Command `dbt build` succeeded at 08:49:54.608921 after 6.50 seconds
[0m08:49:54.609630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c335a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67b01f11b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67afe01510>]}
[0m08:49:54.610189 [debug] [MainThread]: Flushing usage events
[0m08:54:17.413052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e2152560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e0dd7880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e0dd7850>]}


============================== 08:54:17.416818 | de1efd4d-8dd0-4d41-81b9-49572ac27d83 ==============================
[0m08:54:17.416818 [info ] [MainThread]: Running with dbt=1.5.0
[0m08:54:17.417875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/j/.dbt', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:54:18.445895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de1efd4d-8dd0-4d41-81b9-49572ac27d83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e0dd7940>]}
[0m08:54:18.458939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de1efd4d-8dd0-4d41-81b9-49572ac27d83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0cef9dfc0>]}
[0m08:54:18.481541 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m08:54:18.524396 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:54:18.525374 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/artist_facts.sql
[0m08:54:18.549647 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_facts.sql
[0m08:54:18.574716 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m08:54:18.582853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de1efd4d-8dd0-4d41-81b9-49572ac27d83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0cec480d0>]}
[0m08:54:18.596340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de1efd4d-8dd0-4d41-81b9-49572ac27d83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ceda96f0>]}
[0m08:54:18.597157 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m08:54:18.599040 [info ] [MainThread]: 
[0m08:54:18.600365 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:54:18.601992 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m08:54:18.602661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:54:18.948509 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m08:54:18.949355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:54:19.264467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de1efd4d-8dd0-4d41-81b9-49572ac27d83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ceda90c0>]}
[0m08:54:19.265709 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:54:19.266521 [info ] [MainThread]: 
[0m08:54:19.272407 [debug] [Thread-1 (]: Began running node model.bc_sales.artist_facts
[0m08:54:19.273339 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.artist_facts ................ [RUN]
[0m08:54:19.274924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.artist_facts)
[0m08:54:19.275580 [debug] [Thread-1 (]: Began compiling node model.bc_sales.artist_facts
[0m08:54:19.281373 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.artist_facts"
[0m08:54:19.282683 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_facts (compile): 08:54:19.276026 => 08:54:19.282162
[0m08:54:19.283494 [debug] [Thread-1 (]: Began executing node model.bc_sales.artist_facts
[0m08:54:19.306811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:54:19.658188 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.artist_facts"
[0m08:54:19.659221 [debug] [Thread-1 (]: On model.bc_sales.artist_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.artist_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_facts`
    
    

    OPTIONS()
    as (
      

with sales as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_higher_activity_countries`
)

select
    cc_ref as cc_ref,
    artist_name as artist,
    sum(amount_paid_usd) as total_sales_usd,
    avg(amount_paid_usd) as avg_sales_usd,
from sales
group by 1,2
order by 1, 3 desc
    );
  
[0m08:54:23.296795 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:b6d3a6fb-04f3-44be-8689-2c1d7e3dc4bf&page=queryresults
[0m08:54:23.327451 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_facts (execute): 08:54:19.283941 => 08:54:23.327086
[0m08:54:23.329300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de1efd4d-8dd0-4d41-81b9-49572ac27d83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ce6c4cd0>]}
[0m08:54:23.330506 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bandcamp_sales_schema.artist_facts ........... [[32mCREATE TABLE (361.0k rows, 29.5 MiB processed)[0m in 4.05s]
[0m08:54:23.332027 [debug] [Thread-1 (]: Finished running node model.bc_sales.artist_facts
[0m08:54:23.334731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:54:23.335281 [debug] [MainThread]: Connection 'list_datatalksclub-375802' was properly closed.
[0m08:54:23.335636 [debug] [MainThread]: Connection 'model.bc_sales.artist_facts' was properly closed.
[0m08:54:23.336132 [info ] [MainThread]: 
[0m08:54:23.337185 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.74 seconds (4.74s).
[0m08:54:23.338489 [debug] [MainThread]: Command end result
[0m08:54:23.355358 [info ] [MainThread]: 
[0m08:54:23.357111 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:54:23.358230 [info ] [MainThread]: 
[0m08:54:23.359092 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:54:23.360428 [debug] [MainThread]: Command `dbt build` succeeded at 08:54:23.360233 after 5.96 seconds
[0m08:54:23.360960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e2152560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e1dd31c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ceda93f0>]}
[0m08:54:23.361635 [debug] [MainThread]: Flushing usage events
[0m09:33:43.508121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d054e560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86cf1d7880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86cf1d7850>]}


============================== 09:33:43.512802 | e0642f7f-cdd9-4d2c-9dd0-d58f464380c4 ==============================
[0m09:33:43.512802 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:33:43.513887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:33:45.029790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0642f7f-cdd9-4d2c-9dd0-d58f464380c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86cf1d7940>]}
[0m09:33:45.043042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0642f7f-cdd9-4d2c-9dd0-d58f464380c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86bd409240>]}
[0m09:33:45.067928 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m09:33:45.130686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m09:33:45.131642 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/core/artist_max_sales_facts.sql
[0m09:33:45.132324 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/core/artist_facts_view.sql
[0m09:33:45.158940 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_max_sales_facts.sql
[0m09:33:45.180012 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_facts_view.sql
[0m09:33:45.199072 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m09:33:45.207976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0642f7f-cdd9-4d2c-9dd0-d58f464380c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86bd0bc4f0>]}
[0m09:33:45.229658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0642f7f-cdd9-4d2c-9dd0-d58f464380c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86bd13fc40>]}
[0m09:33:45.230658 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:33:45.233179 [info ] [MainThread]: 
[0m09:33:45.234661 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:33:45.237198 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m09:33:45.237966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:33:45.633523 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m09:33:45.634326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:33:45.963832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0642f7f-cdd9-4d2c-9dd0-d58f464380c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86bd13f550>]}
[0m09:33:45.965121 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:33:45.966249 [info ] [MainThread]: 
[0m09:33:45.973487 [debug] [Thread-1 (]: Began running node model.bc_sales.artist_max_sales_facts
[0m09:33:45.974519 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.artist_max_sales_facts ...... [RUN]
[0m09:33:45.976519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.artist_max_sales_facts)
[0m09:33:45.977110 [debug] [Thread-1 (]: Began compiling node model.bc_sales.artist_max_sales_facts
[0m09:33:45.982350 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.artist_max_sales_facts"
[0m09:33:45.983587 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_max_sales_facts (compile): 09:33:45.977554 => 09:33:45.983220
[0m09:33:45.984316 [debug] [Thread-1 (]: Began executing node model.bc_sales.artist_max_sales_facts
[0m09:33:46.039382 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.artist_max_sales_facts"
[0m09:33:46.040691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:33:46.091107 [debug] [Thread-1 (]: On model.bc_sales.artist_max_sales_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.artist_max_sales_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_max_sales_facts`
    
    

    OPTIONS()
    as (
      

with facts as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_facts`
),

refs as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
),

with max_total_sales as (
    select
        facts.cc_ref as ref,
        --facts.artist,
        max(facts.total_usd) as max_sales_usd
    from facts
    group by 1
    order by 1
)

select
    max_total_sales.ref as ref,
    max_total_sales.max_sales_usd as max_sales_usd,
    facts.artist as artist
from max_total_sales
left join facts
on max_total_sales.ref = facts.cc_ref
and max_total_sales.max_sales_usd = facts.total_usd
    );
  
[0m09:33:46.449011 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword SELECT but got keyword WITH at [22:1]')
[0m09:33:47.121781 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:US:88f91ee0-97d4-48d1-bf27-e69e51a5dc8c&page=queryresults
[0m09:33:47.123616 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_max_sales_facts (execute): 09:33:45.984669 => 09:33:47.123236
[0m09:33:47.131345 [debug] [Thread-1 (]: Database Error in model artist_max_sales_facts (models/core/artist_max_sales_facts.sql)
  Syntax error: Expected keyword SELECT but got keyword WITH at [22:1]
  compiled Code at target/run/bc_sales/models/core/artist_max_sales_facts.sql
[0m09:33:47.132313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0642f7f-cdd9-4d2c-9dd0-d58f464380c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86bd1f0e80>]}
[0m09:33:47.133351 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bandcamp_sales_schema.artist_max_sales_facts  [[31mERROR[0m in 1.16s]
[0m09:33:47.134510 [debug] [Thread-1 (]: Finished running node model.bc_sales.artist_max_sales_facts
[0m09:33:47.137253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:33:47.137710 [debug] [MainThread]: Connection 'model.bc_sales.artist_max_sales_facts' was properly closed.
[0m09:33:47.138116 [info ] [MainThread]: 
[0m09:33:47.138803 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.90 seconds (1.90s).
[0m09:33:47.139743 [debug] [MainThread]: Command end result
[0m09:33:47.166788 [info ] [MainThread]: 
[0m09:33:47.167760 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:33:47.168518 [info ] [MainThread]: 
[0m09:33:47.169185 [error] [MainThread]: [33mDatabase Error in model artist_max_sales_facts (models/core/artist_max_sales_facts.sql)[0m
[0m09:33:47.169904 [error] [MainThread]:   Syntax error: Expected keyword SELECT but got keyword WITH at [22:1]
[0m09:33:47.170552 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/artist_max_sales_facts.sql
[0m09:33:47.171165 [info ] [MainThread]: 
[0m09:33:47.171854 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:33:47.173091 [debug] [MainThread]: Command `dbt build` failed at 09:33:47.172918 after 3.68 seconds
[0m09:33:47.173591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d054e560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86bd409240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86bd0cf100>]}
[0m09:33:47.174107 [debug] [MainThread]: Flushing usage events
[0m09:34:19.465956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63554a5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6341cf880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6341cf8b0>]}


============================== 09:34:19.471036 | b1e59ebe-af46-490c-8f62-4d0e693a8e6d ==============================
[0m09:34:19.471036 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:34:19.472755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:34:20.528694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1e59ebe-af46-490c-8f62-4d0e693a8e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6341cf9a0>]}
[0m09:34:20.545657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1e59ebe-af46-490c-8f62-4d0e693a8e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6223351b0>]}
[0m09:34:20.568263 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m09:34:20.612153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:34:20.613095 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/artist_max_sales_facts.sql
[0m09:34:20.636400 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_max_sales_facts.sql
[0m09:34:20.661589 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m09:34:20.669603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1e59ebe-af46-490c-8f62-4d0e693a8e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd621fd8580>]}
[0m09:34:20.683054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1e59ebe-af46-490c-8f62-4d0e693a8e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6221362c0>]}
[0m09:34:20.684184 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:34:20.686430 [info ] [MainThread]: 
[0m09:34:20.687837 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:34:20.689578 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m09:34:20.690256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:34:21.034027 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m09:34:21.034878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:34:21.354193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1e59ebe-af46-490c-8f62-4d0e693a8e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd622335210>]}
[0m09:34:21.355425 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:34:21.356282 [info ] [MainThread]: 
[0m09:34:21.361460 [debug] [Thread-1 (]: Began running node model.bc_sales.artist_max_sales_facts
[0m09:34:21.362284 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.artist_max_sales_facts ...... [RUN]
[0m09:34:21.363840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.artist_max_sales_facts)
[0m09:34:21.364390 [debug] [Thread-1 (]: Began compiling node model.bc_sales.artist_max_sales_facts
[0m09:34:21.369469 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.artist_max_sales_facts"
[0m09:34:21.370576 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_max_sales_facts (compile): 09:34:21.364719 => 09:34:21.370219
[0m09:34:21.371156 [debug] [Thread-1 (]: Began executing node model.bc_sales.artist_max_sales_facts
[0m09:34:21.423755 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.artist_max_sales_facts"
[0m09:34:21.425037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:34:21.475092 [debug] [Thread-1 (]: On model.bc_sales.artist_max_sales_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.artist_max_sales_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_max_sales_facts`
    
    

    OPTIONS()
    as (
      

with facts as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_facts`
),

refs as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
),

max_total_sales as (
    select
        facts.cc_ref as ref,
        --facts.artist,
        max(facts.total_usd) as max_sales_usd
    from facts
    group by 1
    order by 1
)

select
    max_total_sales.ref as ref,
    max_total_sales.max_sales_usd as max_sales_usd,
    facts.artist as artist
from max_total_sales
left join facts
on max_total_sales.ref = facts.cc_ref
and max_total_sales.max_sales_usd = facts.total_usd
    );
  
[0m09:34:22.169009 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name total_usd not found inside facts at [26:19]')
[0m09:34:23.325828 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:07772145-0b9c-40b0-bc1b-d66afe370d1c&page=queryresults
[0m09:34:23.327648 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_max_sales_facts (execute): 09:34:21.371573 => 09:34:23.327235
[0m09:34:23.331798 [debug] [Thread-1 (]: Database Error in model artist_max_sales_facts (models/core/artist_max_sales_facts.sql)
  Name total_usd not found inside facts at [26:19]
  compiled Code at target/run/bc_sales/models/core/artist_max_sales_facts.sql
[0m09:34:23.332667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e59ebe-af46-490c-8f62-4d0e693a8e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd621fd9690>]}
[0m09:34:23.333567 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bandcamp_sales_schema.artist_max_sales_facts  [[31mERROR[0m in 1.97s]
[0m09:34:23.334687 [debug] [Thread-1 (]: Finished running node model.bc_sales.artist_max_sales_facts
[0m09:34:23.337045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:34:23.337490 [debug] [MainThread]: Connection 'list_datatalksclub-375802' was properly closed.
[0m09:34:23.337863 [debug] [MainThread]: Connection 'model.bc_sales.artist_max_sales_facts' was properly closed.
[0m09:34:23.338275 [info ] [MainThread]: 
[0m09:34:23.339238 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.65 seconds (2.65s).
[0m09:34:23.340359 [debug] [MainThread]: Command end result
[0m09:34:23.361090 [info ] [MainThread]: 
[0m09:34:23.362050 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:34:23.362722 [info ] [MainThread]: 
[0m09:34:23.363335 [error] [MainThread]: [33mDatabase Error in model artist_max_sales_facts (models/core/artist_max_sales_facts.sql)[0m
[0m09:34:23.363984 [error] [MainThread]:   Name total_usd not found inside facts at [26:19]
[0m09:34:23.364579 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/artist_max_sales_facts.sql
[0m09:34:23.365198 [info ] [MainThread]: 
[0m09:34:23.365893 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:34:23.366887 [debug] [MainThread]: Command `dbt build` failed at 09:34:23.366722 after 3.91 seconds
[0m09:34:23.367422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63554a5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd636cfc310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd621fef550>]}
[0m09:34:23.367984 [debug] [MainThread]: Flushing usage events
[0m09:35:17.125063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201cf5a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201bbdf7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201bbdf7c0>]}


============================== 09:35:17.128691 | b5ca35d0-6599-44f9-abcb-85da606ea7ac ==============================
[0m09:35:17.128691 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:35:17.130610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:35:18.154306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5ca35d0-6599-44f9-abcb-85da606ea7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201bbdf8b0>]}
[0m09:35:18.166913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5ca35d0-6599-44f9-abcb-85da606ea7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2009de9240>]}
[0m09:35:18.188965 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m09:35:18.230166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:35:18.231113 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/artist_max_sales_facts.sql
[0m09:35:18.254072 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_max_sales_facts.sql
[0m09:35:18.279061 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m09:35:18.287303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5ca35d0-6599-44f9-abcb-85da606ea7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2009a94490>]}
[0m09:35:18.300780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5ca35d0-6599-44f9-abcb-85da606ea7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2009bf0610>]}
[0m09:35:18.301580 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:35:18.303592 [info ] [MainThread]: 
[0m09:35:18.304954 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:35:18.306581 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m09:35:18.307218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:35:18.653305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m09:35:18.654128 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:35:18.970134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5ca35d0-6599-44f9-abcb-85da606ea7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2009bf1de0>]}
[0m09:35:18.971326 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:35:18.972075 [info ] [MainThread]: 
[0m09:35:18.977285 [debug] [Thread-1 (]: Began running node model.bc_sales.artist_max_sales_facts
[0m09:35:18.978131 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.artist_max_sales_facts ...... [RUN]
[0m09:35:18.979590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.artist_max_sales_facts)
[0m09:35:18.980248 [debug] [Thread-1 (]: Began compiling node model.bc_sales.artist_max_sales_facts
[0m09:35:18.985135 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.artist_max_sales_facts"
[0m09:35:18.986192 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_max_sales_facts (compile): 09:35:18.980572 => 09:35:18.985834
[0m09:35:18.986711 [debug] [Thread-1 (]: Began executing node model.bc_sales.artist_max_sales_facts
[0m09:35:19.037383 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.artist_max_sales_facts"
[0m09:35:19.038449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:19.087617 [debug] [Thread-1 (]: On model.bc_sales.artist_max_sales_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.artist_max_sales_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_max_sales_facts`
    
    

    OPTIONS()
    as (
      

with facts as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_facts`
),

refs as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
),

max_total_sales as (
    select
        facts.cc_ref as ref,
        --facts.artist,
        max(facts.total_sales_usd) as max_sales_usd
    from facts
    group by 1
    order by 1
)

select
    max_total_sales.ref as ref,
    max_total_sales.max_sales_usd as max_sales_usd,
    facts.artist as artist
from max_total_sales
left join facts
on max_total_sales.ref = facts.cc_ref
and max_total_sales.max_sales_usd = facts.total_usd
    );
  
[0m09:35:19.682240 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name total_usd not found inside facts at [39:43]')
[0m09:35:20.235380 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:a3e2218e-0c64-4a68-b712-c71082ac1e3b&page=queryresults
[0m09:35:20.236882 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_max_sales_facts (execute): 09:35:18.987096 => 09:35:20.236477
[0m09:35:20.240863 [debug] [Thread-1 (]: Database Error in model artist_max_sales_facts (models/core/artist_max_sales_facts.sql)
  Name total_usd not found inside facts at [39:43]
  compiled Code at target/run/bc_sales/models/core/artist_max_sales_facts.sql
[0m09:35:20.241733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5ca35d0-6599-44f9-abcb-85da606ea7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2009a954b0>]}
[0m09:35:20.242628 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bandcamp_sales_schema.artist_max_sales_facts  [[31mERROR[0m in 1.26s]
[0m09:35:20.243584 [debug] [Thread-1 (]: Finished running node model.bc_sales.artist_max_sales_facts
[0m09:35:20.245980 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:35:20.246450 [debug] [MainThread]: Connection 'model.bc_sales.artist_max_sales_facts' was properly closed.
[0m09:35:20.246851 [info ] [MainThread]: 
[0m09:35:20.247750 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.94 seconds (1.94s).
[0m09:35:20.249328 [debug] [MainThread]: Command end result
[0m09:35:20.273327 [info ] [MainThread]: 
[0m09:35:20.274339 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:35:20.275012 [info ] [MainThread]: 
[0m09:35:20.275650 [error] [MainThread]: [33mDatabase Error in model artist_max_sales_facts (models/core/artist_max_sales_facts.sql)[0m
[0m09:35:20.276434 [error] [MainThread]:   Name total_usd not found inside facts at [39:43]
[0m09:35:20.277022 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/artist_max_sales_facts.sql
[0m09:35:20.277630 [info ] [MainThread]: 
[0m09:35:20.278262 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:35:20.279260 [debug] [MainThread]: Command `dbt build` failed at 09:35:20.279087 after 3.16 seconds
[0m09:35:20.279754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201cf5a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2009ab35e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2009ab1e70>]}
[0m09:35:20.280345 [debug] [MainThread]: Flushing usage events
[0m09:35:47.448118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cdea4a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cdd9cf850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cdd9cf880>]}


============================== 09:35:47.451869 | 1a348999-e68c-4f7d-ac3e-62734ceb7ec7 ==============================
[0m09:35:47.451869 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:35:47.452888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'profiles_dir': '/home/j/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:35:48.466663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a348999-e68c-4f7d-ac3e-62734ceb7ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cdd9cf970>]}
[0m09:35:48.479228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a348999-e68c-4f7d-ac3e-62734ceb7ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ccb85df60>]}
[0m09:35:48.501939 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m09:35:48.542954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:35:48.543960 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/artist_max_sales_facts.sql
[0m09:35:48.566122 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_max_sales_facts.sql
[0m09:35:48.590438 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m09:35:48.598977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a348999-e68c-4f7d-ac3e-62734ceb7ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ccb518550>]}
[0m09:35:48.612430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a348999-e68c-4f7d-ac3e-62734ceb7ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ccb6706d0>]}
[0m09:35:48.613479 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:35:48.615657 [info ] [MainThread]: 
[0m09:35:48.617152 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:35:48.618858 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m09:35:48.619452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:35:48.978385 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m09:35:48.979237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:35:49.286906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a348999-e68c-4f7d-ac3e-62734ceb7ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cde9cb2b0>]}
[0m09:35:49.288273 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:35:49.289119 [info ] [MainThread]: 
[0m09:35:49.294728 [debug] [Thread-1 (]: Began running node model.bc_sales.artist_max_sales_facts
[0m09:35:49.295628 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.artist_max_sales_facts ...... [RUN]
[0m09:35:49.297423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.artist_max_sales_facts)
[0m09:35:49.298097 [debug] [Thread-1 (]: Began compiling node model.bc_sales.artist_max_sales_facts
[0m09:35:49.303093 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.artist_max_sales_facts"
[0m09:35:49.304199 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_max_sales_facts (compile): 09:35:49.298455 => 09:35:49.303843
[0m09:35:49.304796 [debug] [Thread-1 (]: Began executing node model.bc_sales.artist_max_sales_facts
[0m09:35:49.358179 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.artist_max_sales_facts"
[0m09:35:49.359263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:49.414125 [debug] [Thread-1 (]: On model.bc_sales.artist_max_sales_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.artist_max_sales_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_max_sales_facts`
    
    

    OPTIONS()
    as (
      

with facts as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_facts`
),

refs as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
),

max_total_sales as (
    select
        facts.cc_ref as ref,
        --facts.artist,
        max(facts.total_sales_usd) as max_sales_usd
    from facts
    group by 1
    order by 1
)

select
    max_total_sales.ref as ref,
    max_total_sales.max_sales_usd as max_sales_usd,
    facts.artist as artist
from max_total_sales
left join facts
on max_total_sales.ref = facts.cc_ref
and max_total_sales.max_sales_usd = facts.total_sales_usd
    );
  
[0m09:35:51.974275 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:5db8fa9c-0abd-4ea1-869a-fac9500740e2&page=queryresults
[0m09:35:51.995833 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_max_sales_facts (execute): 09:35:49.305298 => 09:35:51.995435
[0m09:35:51.997166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a348999-e68c-4f7d-ac3e-62734ceb7ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ccb5193c0>]}
[0m09:35:51.998200 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bandcamp_sales_schema.artist_max_sales_facts . [[32mCREATE TABLE (118.0 rows, 13.5 MiB processed)[0m in 2.70s]
[0m09:35:51.999862 [debug] [Thread-1 (]: Finished running node model.bc_sales.artist_max_sales_facts
[0m09:35:52.002415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:35:52.002870 [debug] [MainThread]: Connection 'list_datatalksclub-375802' was properly closed.
[0m09:35:52.003208 [debug] [MainThread]: Connection 'model.bc_sales.artist_max_sales_facts' was properly closed.
[0m09:35:52.003613 [info ] [MainThread]: 
[0m09:35:52.004664 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.39 seconds (3.39s).
[0m09:35:52.005902 [debug] [MainThread]: Command end result
[0m09:35:52.031239 [info ] [MainThread]: 
[0m09:35:52.032443 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:35:52.033204 [info ] [MainThread]: 
[0m09:35:52.033878 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:35:52.035127 [debug] [MainThread]: Command `dbt build` succeeded at 09:35:52.034856 after 4.60 seconds
[0m09:35:52.035664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cdea4a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ce01f4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ccb85df60>]}
[0m09:35:52.036283 [debug] [MainThread]: Flushing usage events
[0m09:45:11.591447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62484a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6237d38b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6237d3880>]}


============================== 09:45:11.595231 | 304ada48-d259-44bd-9f5f-f14739718798 ==============================
[0m09:45:11.595231 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:45:11.596602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:45:12.609493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '304ada48-d259-44bd-9f5f-f14739718798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6237d3970>]}
[0m09:45:12.622434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '304ada48-d259-44bd-9f5f-f14739718798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd611651f60>]}
[0m09:45:12.644816 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m09:45:12.687013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m09:45:12.687926 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/core/artist_max_avg_facts.sql
[0m09:45:12.688601 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/artist_max_sales_facts.sql
[0m09:45:12.710858 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_max_avg_facts.sql
[0m09:45:12.728711 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_max_sales_facts.sql
[0m09:45:12.741013 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m09:45:12.749452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '304ada48-d259-44bd-9f5f-f14739718798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd61130cb20>]}
[0m09:45:12.762541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '304ada48-d259-44bd-9f5f-f14739718798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6114663b0>]}
[0m09:45:12.763441 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:45:12.765575 [info ] [MainThread]: 
[0m09:45:12.766922 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:45:12.768557 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m09:45:12.769219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:45:13.140017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m09:45:13.140861 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:45:13.450722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '304ada48-d259-44bd-9f5f-f14739718798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd611651330>]}
[0m09:45:13.452148 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:45:13.453355 [info ] [MainThread]: 
[0m09:45:13.458961 [debug] [Thread-1 (]: Began running node model.bc_sales.artist_max_avg_facts
[0m09:45:13.459845 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.artist_max_avg_facts ........ [RUN]
[0m09:45:13.461195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.artist_max_avg_facts)
[0m09:45:13.461700 [debug] [Thread-1 (]: Began compiling node model.bc_sales.artist_max_avg_facts
[0m09:45:13.466667 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.artist_max_avg_facts"
[0m09:45:13.467620 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_max_avg_facts (compile): 09:45:13.461992 => 09:45:13.467299
[0m09:45:13.468453 [debug] [Thread-1 (]: Began executing node model.bc_sales.artist_max_avg_facts
[0m09:45:13.520848 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.artist_max_avg_facts"
[0m09:45:13.521966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:45:13.570738 [debug] [Thread-1 (]: On model.bc_sales.artist_max_avg_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.artist_max_avg_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_max_avg_facts`
    
    

    OPTIONS()
    as (
      

with facts as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_facts`
),

refs as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
),

max_avg_sales as (
    select
        facts.cc_ref as ref,
        --facts.artist,
        max(facts.avg_usd) as max_avg_usd
    from facts
    group by 1
)

select
    max_avg_sales as.ref as ref,
    max_avg_sales.max_avg_usd as max_avg_usd,
    facts.artist as artist
from max_avg_sales
left join facts
on max_avg_sales.ref = facts.cc_ref
and max_avg_sales.max_avg_usd = facts.avg_sales_usd
order by 1
    );
  
[0m09:45:13.858767 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "." at [32:21]')
[0m09:45:14.670484 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:US:629ef30a-0987-427f-bda6-16e6c7ef0ecc&page=queryresults
[0m09:45:14.672447 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_max_avg_facts (execute): 09:45:13.468890 => 09:45:14.671975
[0m09:45:14.677047 [debug] [Thread-1 (]: Database Error in model artist_max_avg_facts (models/core/artist_max_avg_facts.sql)
  Syntax error: Unexpected "." at [32:21]
  compiled Code at target/run/bc_sales/models/core/artist_max_avg_facts.sql
[0m09:45:14.678146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '304ada48-d259-44bd-9f5f-f14739718798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd611371690>]}
[0m09:45:14.679169 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bandcamp_sales_schema.artist_max_avg_facts  [[31mERROR[0m in 1.22s]
[0m09:45:14.680229 [debug] [Thread-1 (]: Finished running node model.bc_sales.artist_max_avg_facts
[0m09:45:14.682901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:45:14.683354 [debug] [MainThread]: Connection 'model.bc_sales.artist_max_avg_facts' was properly closed.
[0m09:45:14.683760 [info ] [MainThread]: 
[0m09:45:14.684541 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.92 seconds (1.92s).
[0m09:45:14.685533 [debug] [MainThread]: Command end result
[0m09:45:14.698648 [info ] [MainThread]: 
[0m09:45:14.699942 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:45:14.700843 [info ] [MainThread]: 
[0m09:45:14.701659 [error] [MainThread]: [33mDatabase Error in model artist_max_avg_facts (models/core/artist_max_avg_facts.sql)[0m
[0m09:45:14.702344 [error] [MainThread]:   Syntax error: Unexpected "." at [32:21]
[0m09:45:14.702977 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/artist_max_avg_facts.sql
[0m09:45:14.703646 [info ] [MainThread]: 
[0m09:45:14.704407 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:45:14.705503 [debug] [MainThread]: Command `dbt build` failed at 09:45:14.705327 after 3.12 seconds
[0m09:45:14.706046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62484a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd611664f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd611665f30>]}
[0m09:45:14.706600 [debug] [MainThread]: Flushing usage events
[0m09:47:16.780008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd114b62590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1137e78b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1137e7880>]}


============================== 09:47:16.783663 | 4eb2df4b-f230-4e53-a6e5-1ec037b4fbf5 ==============================
[0m09:47:16.783663 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:47:16.784939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'version_check': 'True', 'profiles_dir': '/home/j/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:47:17.800157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4eb2df4b-f230-4e53-a6e5-1ec037b4fbf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1137e7970>]}
[0m09:47:17.813814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4eb2df4b-f230-4e53-a6e5-1ec037b4fbf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1019a5f60>]}
[0m09:47:17.836613 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m09:47:17.879368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:47:17.880423 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/artist_max_avg_facts.sql
[0m09:47:17.903569 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_max_avg_facts.sql
[0m09:47:17.929981 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m09:47:17.938854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4eb2df4b-f230-4e53-a6e5-1ec037b4fbf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd101664ac0>]}
[0m09:47:17.952544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4eb2df4b-f230-4e53-a6e5-1ec037b4fbf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1015c27a0>]}
[0m09:47:17.953360 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:47:17.955527 [info ] [MainThread]: 
[0m09:47:17.956943 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:47:17.958534 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m09:47:17.959172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:47:18.332757 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m09:47:18.333482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:47:18.647413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eb2df4b-f230-4e53-a6e5-1ec037b4fbf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1015c23b0>]}
[0m09:47:18.648658 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:47:18.649667 [info ] [MainThread]: 
[0m09:47:18.654620 [debug] [Thread-1 (]: Began running node model.bc_sales.artist_max_avg_facts
[0m09:47:18.655366 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.artist_max_avg_facts ........ [RUN]
[0m09:47:18.656699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.artist_max_avg_facts)
[0m09:47:18.657197 [debug] [Thread-1 (]: Began compiling node model.bc_sales.artist_max_avg_facts
[0m09:47:18.662008 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.artist_max_avg_facts"
[0m09:47:18.663025 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_max_avg_facts (compile): 09:47:18.657484 => 09:47:18.662664
[0m09:47:18.663508 [debug] [Thread-1 (]: Began executing node model.bc_sales.artist_max_avg_facts
[0m09:47:18.715033 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.artist_max_avg_facts"
[0m09:47:18.716127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:47:18.765062 [debug] [Thread-1 (]: On model.bc_sales.artist_max_avg_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.artist_max_avg_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_max_avg_facts`
    
    

    OPTIONS()
    as (
      

with facts as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_facts`
),

refs as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
),

max_avg_sales as (
    select
        facts.cc_ref as ref,
        --facts.artist,
        max(facts.avg_usd) as max_avg_usd
    from facts
    group by 1
)

select
    max_avg_sales.ref as ref,
    max_avg_sales.max_avg_usd as max_avg_usd,
    facts.artist as artist
from max_avg_sales
left join facts
on max_avg_sales.ref = facts.cc_ref
and max_avg_sales.max_avg_usd = facts.avg_sales_usd
order by 1
    );
  
[0m09:47:19.469672 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name avg_usd not found inside facts at [26:19]')
[0m09:47:20.304491 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:5ef07ef2-5ed3-49e6-850a-dbd0487672f7&page=queryresults
[0m09:47:20.306397 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_max_avg_facts (execute): 09:47:18.663964 => 09:47:20.305901
[0m09:47:20.311041 [debug] [Thread-1 (]: Database Error in model artist_max_avg_facts (models/core/artist_max_avg_facts.sql)
  Name avg_usd not found inside facts at [26:19]
  compiled Code at target/run/bc_sales/models/core/artist_max_avg_facts.sql
[0m09:47:20.312166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eb2df4b-f230-4e53-a6e5-1ec037b4fbf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd101665b70>]}
[0m09:47:20.313347 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bandcamp_sales_schema.artist_max_avg_facts  [[31mERROR[0m in 1.66s]
[0m09:47:20.314402 [debug] [Thread-1 (]: Finished running node model.bc_sales.artist_max_avg_facts
[0m09:47:20.317157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:47:20.317656 [debug] [MainThread]: Connection 'list_datatalksclub-375802' was properly closed.
[0m09:47:20.317995 [debug] [MainThread]: Connection 'model.bc_sales.artist_max_avg_facts' was properly closed.
[0m09:47:20.318422 [info ] [MainThread]: 
[0m09:47:20.319453 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m09:47:20.320610 [debug] [MainThread]: Command end result
[0m09:47:20.346134 [info ] [MainThread]: 
[0m09:47:20.347659 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:47:20.348447 [info ] [MainThread]: 
[0m09:47:20.349603 [error] [MainThread]: [33mDatabase Error in model artist_max_avg_facts (models/core/artist_max_avg_facts.sql)[0m
[0m09:47:20.350220 [error] [MainThread]:   Name avg_usd not found inside facts at [26:19]
[0m09:47:20.350846 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/artist_max_avg_facts.sql
[0m09:47:20.351489 [info ] [MainThread]: 
[0m09:47:20.352215 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:47:20.353361 [debug] [MainThread]: Command `dbt build` failed at 09:47:20.353183 after 3.58 seconds
[0m09:47:20.353922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd114b62590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd114673070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd10167b640>]}
[0m09:47:20.354495 [debug] [MainThread]: Flushing usage events
[0m09:48:12.963759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eee3525c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eecfdb880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eecfdb8b0>]}


============================== 09:48:12.968681 | ea42ceab-df64-4b76-a4f2-bca9c9458a7a ==============================
[0m09:48:12.968681 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:48:12.970822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:48:14.008236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea42ceab-df64-4b76-a4f2-bca9c9458a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eecfdb9a0>]}
[0m09:48:14.021127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea42ceab-df64-4b76-a4f2-bca9c9458a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1edb151f90>]}
[0m09:48:14.043812 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m09:48:14.088831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:48:14.089834 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/artist_max_avg_facts.sql
[0m09:48:14.112224 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_max_avg_facts.sql
[0m09:48:14.138900 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m09:48:14.147855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea42ceab-df64-4b76-a4f2-bca9c9458a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1edae04af0>]}
[0m09:48:14.162279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea42ceab-df64-4b76-a4f2-bca9c9458a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1edaf62860>]}
[0m09:48:14.163136 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:48:14.165181 [info ] [MainThread]: 
[0m09:48:14.166483 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:48:14.168167 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m09:48:14.168849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:48:14.528128 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m09:48:14.528962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:48:14.864451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea42ceab-df64-4b76-a4f2-bca9c9458a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eedfd1300>]}
[0m09:48:14.865638 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:48:14.866351 [info ] [MainThread]: 
[0m09:48:14.871295 [debug] [Thread-1 (]: Began running node model.bc_sales.artist_max_avg_facts
[0m09:48:14.872159 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.artist_max_avg_facts ........ [RUN]
[0m09:48:14.873372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.artist_max_avg_facts)
[0m09:48:14.873909 [debug] [Thread-1 (]: Began compiling node model.bc_sales.artist_max_avg_facts
[0m09:48:14.878834 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.artist_max_avg_facts"
[0m09:48:14.879937 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_max_avg_facts (compile): 09:48:14.874227 => 09:48:14.879512
[0m09:48:14.880515 [debug] [Thread-1 (]: Began executing node model.bc_sales.artist_max_avg_facts
[0m09:48:14.932627 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.artist_max_avg_facts"
[0m09:48:14.933727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:48:14.983330 [debug] [Thread-1 (]: On model.bc_sales.artist_max_avg_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.artist_max_avg_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_max_avg_facts`
    
    

    OPTIONS()
    as (
      

with facts as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_facts`
),

refs as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
),

max_avg_sales as (
    select
        facts.cc_ref as ref,
        --facts.artist,
        max(facts.avg_sales_usd) as max_avg_usd
    from facts
    group by 1
)

select
    max_avg_sales.ref as ref,
    max_avg_sales.max_avg_usd as max_avg_usd,
    facts.artist as artist
from max_avg_sales
left join facts
on max_avg_sales.ref = facts.cc_ref
and max_avg_sales.max_avg_usd = facts.avg_sales_usd
order by 1
    );
  
[0m09:48:29.674370 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:b8c67ce4-4f07-44bd-8c58-3d0afb752965&page=queryresults
[0m09:48:29.697100 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_max_avg_facts (execute): 09:48:14.880845 => 09:48:29.696714
[0m09:48:29.698496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea42ceab-df64-4b76-a4f2-bca9c9458a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eef904310>]}
[0m09:48:29.699657 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bandcamp_sales_schema.artist_max_avg_facts ... [[32mCREATE TABLE (119.0 rows, 13.5 MiB processed)[0m in 14.83s]
[0m09:48:29.701119 [debug] [Thread-1 (]: Finished running node model.bc_sales.artist_max_avg_facts
[0m09:48:29.704011 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:48:29.704572 [debug] [MainThread]: Connection 'list_datatalksclub-375802' was properly closed.
[0m09:48:29.704969 [debug] [MainThread]: Connection 'model.bc_sales.artist_max_avg_facts' was properly closed.
[0m09:48:29.705415 [info ] [MainThread]: 
[0m09:48:29.706585 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.54 seconds (15.54s).
[0m09:48:29.708175 [debug] [MainThread]: Command end result
[0m09:48:29.722135 [info ] [MainThread]: 
[0m09:48:29.723657 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:48:29.724724 [info ] [MainThread]: 
[0m09:48:29.725719 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:48:29.726959 [debug] [MainThread]: Command `dbt build` succeeded at 09:48:29.726770 after 16.77 seconds
[0m09:48:29.727508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eee3525c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eedfd1300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eef904310>]}
[0m09:48:29.728170 [debug] [MainThread]: Flushing usage events
[0m09:56:48.475751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f690d842560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f690c4cb880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f690c4cb850>]}


============================== 09:56:48.479368 | 785e19f3-eff8-4825-8c4c-bf9901c16a30 ==============================
[0m09:56:48.479368 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:56:48.480414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:56:49.497733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '785e19f3-eff8-4825-8c4c-bf9901c16a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f690c4cb940>]}
[0m09:56:49.510597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '785e19f3-eff8-4825-8c4c-bf9901c16a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68fa6f1fc0>]}
[0m09:56:49.533422 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m09:56:49.575797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:56:49.576800 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/artist_facts.sql
[0m09:56:49.599062 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_facts.sql
[0m09:56:49.624184 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m09:56:49.632273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '785e19f3-eff8-4825-8c4c-bf9901c16a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68fa3b8a90>]}
[0m09:56:49.646529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '785e19f3-eff8-4825-8c4c-bf9901c16a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68fa50a800>]}
[0m09:56:49.647327 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:56:49.649419 [info ] [MainThread]: 
[0m09:56:49.650683 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:56:49.652316 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m09:56:49.652954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:56:50.021809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m09:56:50.022713 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:56:50.338864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '785e19f3-eff8-4825-8c4c-bf9901c16a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68fa5088b0>]}
[0m09:56:50.340176 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:56:50.340958 [info ] [MainThread]: 
[0m09:56:50.346163 [debug] [Thread-1 (]: Began running node model.bc_sales.artist_facts
[0m09:56:50.346937 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.artist_facts ................ [RUN]
[0m09:56:50.348195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.artist_facts)
[0m09:56:50.348751 [debug] [Thread-1 (]: Began compiling node model.bc_sales.artist_facts
[0m09:56:50.353109 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.artist_facts"
[0m09:56:50.354203 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_facts (compile): 09:56:50.349050 => 09:56:50.353863
[0m09:56:50.354760 [debug] [Thread-1 (]: Began executing node model.bc_sales.artist_facts
[0m09:56:50.374536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:50.739485 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.artist_facts"
[0m09:56:50.740629 [debug] [Thread-1 (]: On model.bc_sales.artist_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.artist_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_facts`
    
    

    OPTIONS()
    as (
      

with sales as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_higher_activity_countries`
)

select
    cc_ref as cc_ref,
    artist_name as artist,
    count(artist_name) as txns,
    sum(amount_paid_usd) as total_sales_usd,
    avg(amount_paid_usd) as avg_sales_usd,
from sales
where txns > 3
group by 1,2
order by 1, 3 desc
    );
  
[0m09:56:51.158825 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: txns at [25:7]')
[0m09:56:51.573756 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:cf92747b-97d0-4310-94c8-bdc10c0835a2&page=queryresults
[0m09:56:51.575569 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_facts (execute): 09:56:50.355080 => 09:56:51.575190
[0m09:56:51.579569 [debug] [Thread-1 (]: Database Error in model artist_facts (models/core/artist_facts.sql)
  Unrecognized name: txns at [25:7]
  compiled Code at target/run/bc_sales/models/core/artist_facts.sql
[0m09:56:51.580364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '785e19f3-eff8-4825-8c4c-bf9901c16a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68fa3b9e10>]}
[0m09:56:51.581259 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bandcamp_sales_schema.artist_facts ....... [[31mERROR[0m in 1.23s]
[0m09:56:51.582457 [debug] [Thread-1 (]: Finished running node model.bc_sales.artist_facts
[0m09:56:51.585027 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:56:51.585492 [debug] [MainThread]: Connection 'model.bc_sales.artist_facts' was properly closed.
[0m09:56:51.585884 [info ] [MainThread]: 
[0m09:56:51.586528 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.94 seconds (1.94s).
[0m09:56:51.587436 [debug] [MainThread]: Command end result
[0m09:56:51.610055 [info ] [MainThread]: 
[0m09:56:51.610994 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:56:51.611656 [info ] [MainThread]: 
[0m09:56:51.612332 [error] [MainThread]: [33mDatabase Error in model artist_facts (models/core/artist_facts.sql)[0m
[0m09:56:51.612914 [error] [MainThread]:   Unrecognized name: txns at [25:7]
[0m09:56:51.613660 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/artist_facts.sql
[0m09:56:51.614272 [info ] [MainThread]: 
[0m09:56:51.614916 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:56:51.615943 [debug] [MainThread]: Command `dbt build` failed at 09:56:51.615746 after 3.15 seconds
[0m09:56:51.616476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f690d842560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68fa3c5a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68fa3c6b30>]}
[0m09:56:51.616997 [debug] [MainThread]: Flushing usage events
[0m09:58:00.181768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7fa176590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7f8dff8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7f8dff880>]}


============================== 09:58:00.185586 | 51430d4b-b2a9-4f3f-843d-769e2198706f ==============================
[0m09:58:00.185586 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:58:00.187609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:58:01.234846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51430d4b-b2a9-4f3f-843d-769e2198706f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7f8dff970>]}
[0m09:58:01.249497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51430d4b-b2a9-4f3f-843d-769e2198706f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7e6ed11b0>]}
[0m09:58:01.272207 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m09:58:01.317039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:58:01.317973 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/artist_facts.sql
[0m09:58:01.342660 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_facts.sql
[0m09:58:01.370839 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m09:58:01.379089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51430d4b-b2a9-4f3f-843d-769e2198706f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7e6b8cac0>]}
[0m09:58:01.392996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51430d4b-b2a9-4f3f-843d-769e2198706f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7e6ade7a0>]}
[0m09:58:01.393781 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m09:58:01.395807 [info ] [MainThread]: 
[0m09:58:01.397080 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:58:01.398643 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m09:58:01.399278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:01.766236 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m09:58:01.767054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:02.104054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51430d4b-b2a9-4f3f-843d-769e2198706f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7e6ade3b0>]}
[0m09:58:02.105250 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:58:02.106259 [info ] [MainThread]: 
[0m09:58:02.111381 [debug] [Thread-1 (]: Began running node model.bc_sales.artist_facts
[0m09:58:02.112221 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.artist_facts ................ [RUN]
[0m09:58:02.113620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.artist_facts)
[0m09:58:02.114113 [debug] [Thread-1 (]: Began compiling node model.bc_sales.artist_facts
[0m09:58:02.118716 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.artist_facts"
[0m09:58:02.119714 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_facts (compile): 09:58:02.114418 => 09:58:02.119381
[0m09:58:02.120349 [debug] [Thread-1 (]: Began executing node model.bc_sales.artist_facts
[0m09:58:02.140220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:58:02.502137 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.artist_facts"
[0m09:58:02.503120 [debug] [Thread-1 (]: On model.bc_sales.artist_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.artist_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_facts`
    
    

    OPTIONS()
    as (
      

with sales as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_higher_activity_countries`
)

select
    cc_ref as cc_ref,
    artist_name as artist,
    count(artist_name) as txns,
    sum(amount_paid_usd) as total_sales_usd,
    avg(amount_paid_usd) as avg_sales_usd,
from sales
group by 1,2
where txns > 3
order by 1, 3 desc
    );
  
[0m09:58:02.676662 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword WHERE at [26:1]')
[0m09:58:03.488673 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:US:28918d2c-88c3-4256-aa48-795a6f7f0cfe&page=queryresults
[0m09:58:03.490058 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_facts (execute): 09:58:02.120662 => 09:58:03.489692
[0m09:58:03.493810 [debug] [Thread-1 (]: Database Error in model artist_facts (models/core/artist_facts.sql)
  Syntax error: Expected ")" but got keyword WHERE at [26:1]
  compiled Code at target/run/bc_sales/models/core/artist_facts.sql
[0m09:58:03.494497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51430d4b-b2a9-4f3f-843d-769e2198706f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7e6b8dde0>]}
[0m09:58:03.495332 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bandcamp_sales_schema.artist_facts ....... [[31mERROR[0m in 1.38s]
[0m09:58:03.496252 [debug] [Thread-1 (]: Finished running node model.bc_sales.artist_facts
[0m09:58:03.498619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:58:03.499017 [debug] [MainThread]: Connection 'list_datatalksclub-375802' was properly closed.
[0m09:58:03.499351 [debug] [MainThread]: Connection 'model.bc_sales.artist_facts' was properly closed.
[0m09:58:03.499717 [info ] [MainThread]: 
[0m09:58:03.500505 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.10 seconds (2.10s).
[0m09:58:03.501427 [debug] [MainThread]: Command end result
[0m09:58:03.521919 [info ] [MainThread]: 
[0m09:58:03.523040 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:58:03.523930 [info ] [MainThread]: 
[0m09:58:03.524681 [error] [MainThread]: [33mDatabase Error in model artist_facts (models/core/artist_facts.sql)[0m
[0m09:58:03.525413 [error] [MainThread]:   Syntax error: Expected ")" but got keyword WHERE at [26:1]
[0m09:58:03.526050 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/artist_facts.sql
[0m09:58:03.526708 [info ] [MainThread]: 
[0m09:58:03.527381 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:58:03.528422 [debug] [MainThread]: Command `dbt build` failed at 09:58:03.528260 after 3.36 seconds
[0m09:58:03.529013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7fa176590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7f9c87070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7e6cdd780>]}
[0m09:58:03.529541 [debug] [MainThread]: Flushing usage events
[0m10:08:12.157351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff476862590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4757eb850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4757eb880>]}


============================== 10:08:12.161026 | d12247d7-a17d-4e06-932f-20043c9a214d ==============================
[0m10:08:12.161026 [info ] [MainThread]: Running with dbt=1.5.0
[0m10:08:12.162261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'profiles_dir': '/home/j/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:08:13.180405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd12247d7-a17d-4e06-932f-20043c9a214d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4757eb970>]}
[0m10:08:13.193844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd12247d7-a17d-4e06-932f-20043c9a214d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4635dd1b0>]}
[0m10:08:13.217156 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m10:08:13.259683 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m10:08:13.260670 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/core/complete_artist_by_country.sql
[0m10:08:13.261268 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/artist_facts.sql
[0m10:08:13.283725 [debug] [MainThread]: 1699: static parser successfully parsed core/complete_artist_by_country.sql
[0m10:08:13.302597 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_facts.sql
[0m10:08:13.315464 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m10:08:13.329435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd12247d7-a17d-4e06-932f-20043c9a214d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4632950f0>]}
[0m10:08:13.344199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd12247d7-a17d-4e06-932f-20043c9a214d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4631ee920>]}
[0m10:08:13.345047 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m10:08:13.347196 [info ] [MainThread]: 
[0m10:08:13.350057 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:08:13.352707 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m10:08:13.355141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:08:13.738358 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bandcamp_sales_schema'
[0m10:08:13.739176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:08:14.040068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd12247d7-a17d-4e06-932f-20043c9a214d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4631ec9d0>]}
[0m10:08:14.041313 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:08:14.042106 [info ] [MainThread]: 
[0m10:08:14.047146 [debug] [Thread-1 (]: Began running node model.bc_sales.complete_artist_by_country
[0m10:08:14.048002 [info ] [Thread-1 (]: 1 of 1 START sql table model bandcamp_sales_schema.complete_artist_by_country .. [RUN]
[0m10:08:14.049243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.complete_artist_by_country)
[0m10:08:14.049808 [debug] [Thread-1 (]: Began compiling node model.bc_sales.complete_artist_by_country
[0m10:08:14.054914 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.complete_artist_by_country"
[0m10:08:14.056183 [debug] [Thread-1 (]: Timing info for model.bc_sales.complete_artist_by_country (compile): 10:08:14.050118 => 10:08:14.055810
[0m10:08:14.056761 [debug] [Thread-1 (]: Began executing node model.bc_sales.complete_artist_by_country
[0m10:08:14.111268 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.complete_artist_by_country"
[0m10:08:14.112380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:08:14.161345 [debug] [Thread-1 (]: On model.bc_sales.complete_artist_by_country: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.complete_artist_by_country"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`complete_artist_by_country`
    
    

    OPTIONS()
    as (
      

with refs as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
),

max_totals as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_max_sales_facts`
),

max_avg as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_max_avg_facts`
)

select
    refs.cc_ref as ref,
    refs.country_code,
    max_totals.artist as highest_selling,
    max_avg.artist as highest_average,
from refs
right join max_totals
on refs.cc_ref = max_totals.ref
right join max_avg
on refs.cc_ref = max_avg.ref
order by 1
    );
  
[0m10:08:16.252289 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:39be61ce-0841-4124-aed2-8d040b770449&page=queryresults
[0m10:08:16.273702 [debug] [Thread-1 (]: Timing info for model.bc_sales.complete_artist_by_country (execute): 10:08:14.057084 => 10:08:16.273351
[0m10:08:16.275026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd12247d7-a17d-4e06-932f-20043c9a214d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff46321e7d0>]}
[0m10:08:16.276122 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bandcamp_sales_schema.complete_artist_by_country  [[32mCREATE TABLE (123.0 rows, 7.4 KiB processed)[0m in 2.23s]
[0m10:08:16.277462 [debug] [Thread-1 (]: Finished running node model.bc_sales.complete_artist_by_country
[0m10:08:16.280295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:08:16.280782 [debug] [MainThread]: Connection 'list_datatalksclub-375802' was properly closed.
[0m10:08:16.281115 [debug] [MainThread]: Connection 'model.bc_sales.complete_artist_by_country' was properly closed.
[0m10:08:16.281529 [info ] [MainThread]: 
[0m10:08:16.282534 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.93 seconds (2.93s).
[0m10:08:16.283893 [debug] [MainThread]: Command end result
[0m10:08:16.297080 [info ] [MainThread]: 
[0m10:08:16.298539 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:08:16.299523 [info ] [MainThread]: 
[0m10:08:16.300297 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:08:16.301425 [debug] [MainThread]: Command `dbt build` succeeded at 10:08:16.301247 after 4.15 seconds
[0m10:08:16.301950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff476862590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4635dd1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4633ea770>]}
[0m10:08:16.302486 [debug] [MainThread]: Flushing usage events
[0m10:22:37.026086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28c3d4a530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28c29cf790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28c29cf7c0>]}


============================== 10:22:37.029840 | 2aa81df8-a2ed-4418-846e-0491153c130e ==============================
[0m10:22:37.029840 [info ] [MainThread]: Running with dbt=1.5.0
[0m10:22:37.030874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:22:38.038373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2aa81df8-a2ed-4418-846e-0491153c130e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28c29cf8b0>]}
[0m10:22:38.051040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2aa81df8-a2ed-4418-846e-0491153c130e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28b0b11f60>]}
[0m10:22:38.073603 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m10:22:38.115391 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m10:22:38.116200 [debug] [MainThread]: Partial parsing: deleted file: bc_sales://models/core/artist_facts_view.sql
[0m10:22:38.126537 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m10:22:38.134876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2aa81df8-a2ed-4418-846e-0491153c130e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28b0775300>]}
[0m10:22:38.147713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2aa81df8-a2ed-4418-846e-0491153c130e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28b0732c20>]}
[0m10:22:38.148700 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m10:22:38.151066 [info ] [MainThread]: 
[0m10:22:38.152354 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:22:38.154364 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m10:22:38.154981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:38.486835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m10:22:38.487638 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:38.793531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2aa81df8-a2ed-4418-846e-0491153c130e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28b0732380>]}
[0m10:22:38.794666 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:22:38.795476 [info ] [MainThread]: 
[0m10:22:38.800534 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_country_code_ref
[0m10:22:38.801462 [debug] [Thread-2 (]: Began running node model.bc_sales.stg_higher_activity_countries
[0m10:22:38.803097 [debug] [Thread-3 (]: Began running node model.bc_sales.stg_sales_by_country
[0m10:22:38.802268 [info ] [Thread-1 (]: 1 of 9 START sql view model bandcamp_sales_schema.stg_country_code_ref ......... [RUN]
[0m10:22:38.806398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.stg_country_code_ref)
[0m10:22:38.805184 [info ] [Thread-3 (]: 3 of 9 START sql view model bandcamp_sales_schema.stg_sales_by_country ......... [RUN]
[0m10:22:38.803906 [info ] [Thread-2 (]: 2 of 9 START sql view model bandcamp_sales_schema.stg_higher_activity_countries  [RUN]
[0m10:22:38.809100 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bc_sales.stg_higher_activity_countries'
[0m10:22:38.808053 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales_by_country'
[0m10:22:38.810122 [debug] [Thread-3 (]: Began compiling node model.bc_sales.stg_sales_by_country
[0m10:22:38.809609 [debug] [Thread-2 (]: Began compiling node model.bc_sales.stg_higher_activity_countries
[0m10:22:38.806925 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_country_code_ref
[0m10:22:38.830757 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_country_code_ref"
[0m10:22:38.847437 [debug] [Thread-3 (]: Writing injected SQL for node "model.bc_sales.stg_sales_by_country"
[0m10:22:38.841665 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:22:38.849388 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (compile): 10:22:38.825994 => 10:22:38.849000
[0m10:22:38.850209 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (compile): 10:22:38.810437 => 10:22:38.849883
[0m10:22:38.851317 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_country_code_ref
[0m10:22:38.852054 [debug] [Thread-3 (]: Began executing node model.bc_sales.stg_sales_by_country
[0m10:22:38.949232 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_country_code_ref"
[0m10:22:38.951159 [debug] [Thread-3 (]: Writing runtime sql for node "model.bc_sales.stg_sales_by_country"
[0m10:22:38.951947 [debug] [Thread-2 (]: On model.bc_sales.stg_higher_activity_countries: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_higher_activity_countries"} */

    select cc_ref
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`
    where count > 20
    order by
	cc_ref desc
    limit 1

[0m10:22:38.953273 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:22:38.953894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:39.049144 [debug] [Thread-1 (]: On model.bc_sales.stg_country_code_ref: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_country_code_ref"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`;


[0m10:22:39.100979 [debug] [Thread-3 (]: On model.bc_sales.stg_sales_by_country: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales_by_country"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
  OPTIONS()
  as 

-- Q1

select
  cast(cc_ref as integer) as cc_ref,
  cast(amount_paid_usd as numeric) as amount_paid_usd,

  cast(country_code as string) as country_code,
  cast(country as string) as country

from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_partitioned`

-- limit 10000;


[0m10:22:40.204278 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:81abbb06-6a18-4263-a051-34804632ba6e&page=queryresults
[0m10:22:40.224987 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (execute): 10:22:38.852486 => 10:22:40.224661
[0m10:22:40.226185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aa81df8-a2ed-4418-846e-0491153c130e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28b063efb0>]}
[0m10:22:40.227186 [info ] [Thread-1 (]: 1 of 9 OK created sql view model bandcamp_sales_schema.stg_country_code_ref .... [[32mCREATE VIEW (0 processed)[0m in 1.42s]
[0m10:22:40.228523 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_country_code_ref
[0m10:22:40.257818 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:da77316a-129d-46b5-b970-645dca9516e6&page=queryresults
[0m10:22:40.261054 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (execute): 10:22:38.861103 => 10:22:40.260735
[0m10:22:40.262340 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aa81df8-a2ed-4418-846e-0491153c130e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28b0827130>]}
[0m10:22:40.263319 [info ] [Thread-3 (]: 3 of 9 OK created sql view model bandcamp_sales_schema.stg_sales_by_country .... [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m10:22:40.264541 [debug] [Thread-3 (]: Finished running node model.bc_sales.stg_sales_by_country
[0m10:22:40.265559 [debug] [Thread-4 (]: Began running node model.bc_sales.country_facts
[0m10:22:40.266289 [info ] [Thread-4 (]: 4 of 9 START sql table model bandcamp_sales_schema.country_facts ............... [RUN]
[0m10:22:40.267988 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bc_sales.country_facts'
[0m10:22:40.268663 [debug] [Thread-4 (]: Began compiling node model.bc_sales.country_facts
[0m10:22:40.274159 [debug] [Thread-4 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m10:22:40.279907 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (compile): 10:22:40.269004 => 10:22:40.279416
[0m10:22:40.280561 [debug] [Thread-4 (]: Began executing node model.bc_sales.country_facts
[0m10:22:40.320024 [debug] [Thread-4 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m10:22:40.321186 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:22:40.371400 [debug] [Thread-4 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      


with countries as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
)--, TODO

--country_ref as (
--    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
--)

select
    countries.cc_ref as ref,
    count(countries.cc_ref) as total_transactions,
    avg(countries.amount_paid_usd) as average_sale_usd,
    sum(countries.amount_paid_usd) as total_sales_usd,
from countries
--inner join country_ref --TODO
--on countries.cc_ref = country_ref.cc_ref
group by countries.cc_ref
order by average_sale_usd desc
    );
  
[0m10:22:40.388266 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:af01cd03-9e77-48ff-9021-7603f2ed3f2e&page=queryresults
[0m10:22:40.390072 [debug] [Thread-2 (]: Writing injected SQL for node "model.bc_sales.stg_higher_activity_countries"
[0m10:22:40.391679 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (compile): 10:22:38.815317 => 10:22:40.391116
[0m10:22:40.392698 [debug] [Thread-2 (]: Began executing node model.bc_sales.stg_higher_activity_countries
[0m10:22:40.401771 [debug] [Thread-2 (]: Writing runtime sql for node "model.bc_sales.stg_higher_activity_countries"
[0m10:22:40.403135 [debug] [Thread-2 (]: On model.bc_sales.stg_higher_activity_countries: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_higher_activity_countries"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_higher_activity_countries`
  OPTIONS()
  as 

-- Q2, Q3

select
    cast(cc_ref as integer) as cc_ref,
    cast(artist_name as string) as artist_name,
    cast(amount_paid_usd as numeric) as amount_paid_usd,
    cast(country_code as string) as country_code, --REMOVE THIS TOO??
    cast(country as string) as country -- TODO: REMOVE THIS LINE
from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_clustered`
where cc_ref <= 115
order by
    cc_ref asc,
    artist_name asc;


[0m10:22:40.950122 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:c9e6bb95-9819-418b-8a5c-6bc256e6211d&page=queryresults
[0m10:22:40.953106 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (execute): 10:22:40.393224 => 10:22:40.952798
[0m10:22:40.954253 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aa81df8-a2ed-4418-846e-0491153c130e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28b0775bd0>]}
[0m10:22:40.955140 [info ] [Thread-2 (]: 2 of 9 OK created sql view model bandcamp_sales_schema.stg_higher_activity_countries  [[32mCREATE VIEW (0 processed)[0m in 2.15s]
[0m10:22:40.956329 [debug] [Thread-2 (]: Finished running node model.bc_sales.stg_higher_activity_countries
[0m10:22:40.957323 [debug] [Thread-3 (]: Began running node model.bc_sales.artist_facts
[0m10:22:40.958023 [info ] [Thread-3 (]: 5 of 9 START sql table model bandcamp_sales_schema.artist_facts ................ [RUN]
[0m10:22:40.959272 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bc_sales.stg_sales_by_country, now model.bc_sales.artist_facts)
[0m10:22:40.959866 [debug] [Thread-3 (]: Began compiling node model.bc_sales.artist_facts
[0m10:22:40.965420 [debug] [Thread-3 (]: Writing injected SQL for node "model.bc_sales.artist_facts"
[0m10:22:40.966584 [debug] [Thread-3 (]: Timing info for model.bc_sales.artist_facts (compile): 10:22:40.960390 => 10:22:40.966205
[0m10:22:40.967340 [debug] [Thread-3 (]: Began executing node model.bc_sales.artist_facts
[0m10:22:40.972271 [debug] [Thread-3 (]: Writing runtime sql for node "model.bc_sales.artist_facts"
[0m10:22:40.973316 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:22:41.023760 [debug] [Thread-3 (]: On model.bc_sales.artist_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.artist_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_facts`
    
    

    OPTIONS()
    as (
      

with sales as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_higher_activity_countries`
)

select
    cc_ref as cc_ref,
    artist_name as artist,
    sum(amount_paid_usd) as total_sales_usd,
    avg(amount_paid_usd) as avg_sales_usd,
from sales
group by 1,2
order by 1, 3 desc
    );
  
[0m10:22:42.598249 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:265eeca6-7253-4bee-9408-ccc836873d1d&page=queryresults
[0m10:22:42.601624 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (execute): 10:22:40.280907 => 10:22:42.601288
[0m10:22:42.603040 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aa81df8-a2ed-4418-846e-0491153c130e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28b06a8b80>]}
[0m10:22:42.604119 [info ] [Thread-4 (]: 4 of 9 OK created sql table model bandcamp_sales_schema.country_facts .......... [[32mCREATE TABLE (186.0 rows, 15.3 MiB processed)[0m in 2.34s]
[0m10:22:42.605449 [debug] [Thread-4 (]: Finished running node model.bc_sales.country_facts
[0m10:22:42.606562 [debug] [Thread-2 (]: Began running node model.bc_sales.country_facts_view
[0m10:22:42.607311 [info ] [Thread-2 (]: 6 of 9 START sql table model bandcamp_sales_schema.country_facts_view .......... [RUN]
[0m10:22:42.608621 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bc_sales.stg_higher_activity_countries, now model.bc_sales.country_facts_view)
[0m10:22:42.609138 [debug] [Thread-2 (]: Began compiling node model.bc_sales.country_facts_view
[0m10:22:42.614965 [debug] [Thread-2 (]: Writing injected SQL for node "model.bc_sales.country_facts_view"
[0m10:22:42.616420 [debug] [Thread-2 (]: Timing info for model.bc_sales.country_facts_view (compile): 10:22:42.609444 => 10:22:42.615954
[0m10:22:42.617093 [debug] [Thread-2 (]: Began executing node model.bc_sales.country_facts_view
[0m10:22:42.622461 [debug] [Thread-2 (]: Writing runtime sql for node "model.bc_sales.country_facts_view"
[0m10:22:42.623685 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:22:42.674911 [debug] [Thread-2 (]: On model.bc_sales.country_facts_view: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts_view"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts_view`
    
    

    OPTIONS()
    as (
      

with facts as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
),

refs as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
)

select
    facts.ref as ref,
    facts.total_transactions as total_transactions,
    facts.average_sale_usd as avg_sale_usd,
    facts.total_sales_usd as total_sales_usd,
    refs.country_code as cc--, TODO
    --refs.country as country
from facts
left join refs
on facts.ref = refs.cc_ref
where total_transactions > 100
order by 3 desc
    );
  
[0m10:22:44.731484 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:7b400640-d6cf-4cb7-822e-ff2a03cefec6&page=queryresults
[0m10:22:44.734880 [debug] [Thread-3 (]: Timing info for model.bc_sales.artist_facts (execute): 10:22:40.967753 => 10:22:44.734498
[0m10:22:44.736440 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aa81df8-a2ed-4418-846e-0491153c130e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28b07755a0>]}
[0m10:22:44.737572 [info ] [Thread-3 (]: 5 of 9 OK created sql table model bandcamp_sales_schema.artist_facts ........... [[32mCREATE TABLE (361.0k rows, 29.5 MiB processed)[0m in 3.78s]
[0m10:22:44.738893 [debug] [Thread-3 (]: Finished running node model.bc_sales.artist_facts
[0m10:22:44.740074 [debug] [Thread-4 (]: Began running node model.bc_sales.artist_max_avg_facts
[0m10:22:44.740760 [debug] [Thread-1 (]: Began running node model.bc_sales.artist_max_sales_facts
[0m10:22:44.741542 [info ] [Thread-4 (]: 7 of 9 START sql table model bandcamp_sales_schema.artist_max_avg_facts ........ [RUN]
[0m10:22:44.742625 [info ] [Thread-1 (]: 8 of 9 START sql table model bandcamp_sales_schema.artist_max_sales_facts ...... [RUN]
[0m10:22:44.743941 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bc_sales.country_facts, now model.bc_sales.artist_max_avg_facts)
[0m10:22:44.744992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bc_sales.stg_country_code_ref, now model.bc_sales.artist_max_sales_facts)
[0m10:22:44.745654 [debug] [Thread-4 (]: Began compiling node model.bc_sales.artist_max_avg_facts
[0m10:22:44.746243 [debug] [Thread-1 (]: Began compiling node model.bc_sales.artist_max_sales_facts
[0m10:22:44.759251 [debug] [Thread-4 (]: Writing injected SQL for node "model.bc_sales.artist_max_avg_facts"
[0m10:22:44.764890 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.artist_max_sales_facts"
[0m10:22:44.766659 [debug] [Thread-4 (]: Timing info for model.bc_sales.artist_max_avg_facts (compile): 10:22:44.746668 => 10:22:44.766206
[0m10:22:44.767506 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_max_sales_facts (compile): 10:22:44.759911 => 10:22:44.767138
[0m10:22:44.768142 [debug] [Thread-4 (]: Began executing node model.bc_sales.artist_max_avg_facts
[0m10:22:44.768834 [debug] [Thread-1 (]: Began executing node model.bc_sales.artist_max_sales_facts
[0m10:22:44.779289 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.artist_max_sales_facts"
[0m10:22:44.780048 [debug] [Thread-4 (]: Writing runtime sql for node "model.bc_sales.artist_max_avg_facts"
[0m10:22:44.781481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:44.782292 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:22:44.876017 [debug] [Thread-4 (]: On model.bc_sales.artist_max_avg_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.artist_max_avg_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_max_avg_facts`
    
    

    OPTIONS()
    as (
      

with facts as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_facts`
),

refs as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
),

max_avg_sales as (
    select
        facts.cc_ref as ref,
        --facts.artist,
        max(facts.avg_sales_usd) as max_avg_usd
    from facts
    group by 1
)

select
    max_avg_sales.ref as ref,
    max_avg_sales.max_avg_usd as max_avg_usd,
    facts.artist as artist
from max_avg_sales
left join facts
on max_avg_sales.ref = facts.cc_ref
and max_avg_sales.max_avg_usd = facts.avg_sales_usd
order by 1
    );
  
[0m10:22:44.877317 [debug] [Thread-1 (]: On model.bc_sales.artist_max_sales_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.artist_max_sales_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_max_sales_facts`
    
    

    OPTIONS()
    as (
      

with facts as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_facts`
),

refs as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
),

max_total_sales as (
    select
        facts.cc_ref as ref,
        --facts.artist,
        max(facts.total_sales_usd) as max_sales_usd
    from facts
    group by 1
    order by 1
)

select
    max_total_sales.ref as ref,
    max_total_sales.max_sales_usd as max_sales_usd,
    facts.artist as artist
from max_total_sales
left join facts
on max_total_sales.ref = facts.cc_ref
and max_total_sales.max_sales_usd = facts.total_sales_usd
order by 1
    );
  
[0m10:22:47.301544 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:9b8c172a-2700-4a8b-9f76-6c6dada1485e&page=queryresults
[0m10:22:47.304871 [debug] [Thread-4 (]: Timing info for model.bc_sales.artist_max_avg_facts (execute): 10:22:44.769288 => 10:22:47.304528
[0m10:22:47.306238 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aa81df8-a2ed-4418-846e-0491153c130e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28b070e200>]}
[0m10:22:47.307273 [info ] [Thread-4 (]: 7 of 9 OK created sql table model bandcamp_sales_schema.artist_max_avg_facts ... [[32mCREATE TABLE (119.0 rows, 13.5 MiB processed)[0m in 2.56s]
[0m10:22:47.308925 [debug] [Thread-4 (]: Finished running node model.bc_sales.artist_max_avg_facts
[0m10:22:47.592548 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:a89ff469-1e9e-42bd-9f16-35d2c2c6d1b1&page=queryresults
[0m10:22:47.596138 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_max_sales_facts (execute): 10:22:44.774542 => 10:22:47.595720
[0m10:22:47.597625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aa81df8-a2ed-4418-846e-0491153c130e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28b070dea0>]}
[0m10:22:47.598713 [info ] [Thread-1 (]: 8 of 9 OK created sql table model bandcamp_sales_schema.artist_max_sales_facts . [[32mCREATE TABLE (118.0 rows, 13.5 MiB processed)[0m in 2.85s]
[0m10:22:47.600362 [debug] [Thread-1 (]: Finished running node model.bc_sales.artist_max_sales_facts
[0m10:22:47.601454 [debug] [Thread-1 (]: Began running node model.bc_sales.complete_artist_by_country
[0m10:22:47.602252 [info ] [Thread-1 (]: 9 of 9 START sql table model bandcamp_sales_schema.complete_artist_by_country .. [RUN]
[0m10:22:47.603889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bc_sales.artist_max_sales_facts, now model.bc_sales.complete_artist_by_country)
[0m10:22:47.604428 [debug] [Thread-1 (]: Began compiling node model.bc_sales.complete_artist_by_country
[0m10:22:47.611296 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.complete_artist_by_country"
[0m10:22:47.612770 [debug] [Thread-1 (]: Timing info for model.bc_sales.complete_artist_by_country (compile): 10:22:47.604748 => 10:22:47.612325
[0m10:22:47.613505 [debug] [Thread-1 (]: Began executing node model.bc_sales.complete_artist_by_country
[0m10:22:47.619283 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.complete_artist_by_country"
[0m10:22:47.620507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:47.670060 [debug] [Thread-1 (]: On model.bc_sales.complete_artist_by_country: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.complete_artist_by_country"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`complete_artist_by_country`
    
    

    OPTIONS()
    as (
      

with refs as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
),

max_totals as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_max_sales_facts`
),

max_avg as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_max_avg_facts`
)

select
    refs.cc_ref as ref,
    refs.country_code,
    max_totals.artist as highest_selling,
    max_avg.artist as highest_average,
from refs
right join max_totals
on refs.cc_ref = max_totals.ref
right join max_avg
on refs.cc_ref = max_avg.ref
order by 1
    );
  
[0m10:22:49.399121 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:8dceaab9-4eb9-4271-93dd-c843f8d79b61&page=queryresults
[0m10:22:49.402894 [debug] [Thread-2 (]: Timing info for model.bc_sales.country_facts_view (execute): 10:22:42.617423 => 10:22:49.402526
[0m10:22:49.404480 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aa81df8-a2ed-4418-846e-0491153c130e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28b0775930>]}
[0m10:22:49.405725 [info ] [Thread-2 (]: 6 of 9 OK created sql table model bandcamp_sales_schema.country_facts_view ..... [[32mCREATE TABLE (78.0 rows, 10.9 KiB processed)[0m in 6.80s]
[0m10:22:49.407206 [debug] [Thread-2 (]: Finished running node model.bc_sales.country_facts_view
[0m10:22:49.585988 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:1c7614b7-ff3e-4dbe-9849-8f26e8e633e5&page=queryresults
[0m10:22:49.590312 [debug] [Thread-1 (]: Timing info for model.bc_sales.complete_artist_by_country (execute): 10:22:47.613874 => 10:22:49.589860
[0m10:22:49.591748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aa81df8-a2ed-4418-846e-0491153c130e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28b070e0e0>]}
[0m10:22:49.592962 [info ] [Thread-1 (]: 9 of 9 OK created sql table model bandcamp_sales_schema.complete_artist_by_country  [[32mCREATE TABLE (123.0 rows, 7.4 KiB processed)[0m in 1.99s]
[0m10:22:49.594252 [debug] [Thread-1 (]: Finished running node model.bc_sales.complete_artist_by_country
[0m10:22:49.597381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:22:49.597976 [debug] [MainThread]: Connection 'model.bc_sales.complete_artist_by_country' was properly closed.
[0m10:22:49.598344 [debug] [MainThread]: Connection 'model.bc_sales.artist_facts' was properly closed.
[0m10:22:49.598679 [debug] [MainThread]: Connection 'model.bc_sales.country_facts_view' was properly closed.
[0m10:22:49.599014 [debug] [MainThread]: Connection 'model.bc_sales.artist_max_avg_facts' was properly closed.
[0m10:22:49.599510 [info ] [MainThread]: 
[0m10:22:49.600296 [info ] [MainThread]: Finished running 3 view models, 6 table models in 0 hours 0 minutes and 11.45 seconds (11.45s).
[0m10:22:49.603199 [debug] [MainThread]: Command end result
[0m10:22:49.632868 [info ] [MainThread]: 
[0m10:22:49.634721 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:22:49.635919 [info ] [MainThread]: 
[0m10:22:49.636782 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m10:22:49.638069 [debug] [MainThread]: Command `dbt build` succeeded at 10:22:49.637892 after 12.62 seconds
[0m10:22:49.638610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28c3d4a530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28b06cd000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28c38794b0>]}
[0m10:22:49.639158 [debug] [MainThread]: Flushing usage events
[0m11:08:53.113097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa758952530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7575db7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7575db7f0>]}


============================== 11:08:53.117366 | 9d3428e4-d04b-4f19-a769-75bbb704c92c ==============================
[0m11:08:53.117366 [info ] [MainThread]: Running with dbt=1.5.0
[0m11:08:53.119548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'fail_fast': 'False', 'profiles_dir': '/home/j/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:08:54.419710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d3428e4-d04b-4f19-a769-75bbb704c92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7575db880>]}
[0m11:08:54.432458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d3428e4-d04b-4f19-a769-75bbb704c92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74578f820>]}
[0m11:08:54.455164 [debug] [MainThread]: checksum: 2b6fdde617d5a0a990757f78fa0717194984bf092aff54287207b08feaec457a, vars: {}, profile: , target: prod, version: 1.5.0
[0m11:08:54.474019 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:08:54.474992 [debug] [MainThread]: previous checksum: 2b6fdde617d5a0a990757f78fa0717194984bf092aff54287207b08feaec457a, current checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda
[0m11:08:54.475497 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:08:54.476394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9d3428e4-d04b-4f19-a769-75bbb704c92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74577dff0>]}
[0m11:08:55.687797 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_country_code_ref.sql
[0m11:08:55.706473 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_by_country.sql
[0m11:08:55.711385 [debug] [MainThread]: 1603: static parser failed on staging/stg_higher_activity_countries.sql
[0m11:08:55.734812 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_higher_activity_countries.sql
[0m11:08:55.737368 [debug] [MainThread]: 1699: static parser successfully parsed core/complete_artist_by_country.sql
[0m11:08:55.742006 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts_view.sql
[0m11:08:55.747306 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_facts.sql
[0m11:08:55.751877 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m11:08:55.756553 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_max_sales_facts.sql
[0m11:08:55.761446 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_max_avg_facts.sql
[0m11:08:55.860864 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m11:08:55.869990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d3428e4-d04b-4f19-a769-75bbb704c92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7454c7a30>]}
[0m11:08:55.886549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d3428e4-d04b-4f19-a769-75bbb704c92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa744faa410>]}
[0m11:08:55.887345 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m11:08:55.890119 [info ] [MainThread]: 
[0m11:08:55.891438 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:08:55.893865 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m11:08:55.894534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:56.258730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now create_datatalksclub-375802_bc_production)
[0m11:08:56.260327 [debug] [ThreadPool]: Creating schema "database: "datatalksclub-375802"
schema: "bc_production"
"
[0m11:08:56.365942 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:56.415889 [debug] [ThreadPool]: On create_datatalksclub-375802_bc_production: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "prod", "connection_name": "create_datatalksclub-375802_bc_production"} */
create schema if not exists `datatalksclub-375802`.`bc_production`
  
[0m11:08:57.608670 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:US:ff2fb1ba-e19e-4424-b0f7-302ccbaa759c&page=queryresults
[0m11:08:57.612750 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802_bc_production'
[0m11:08:57.613825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:57.947108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d3428e4-d04b-4f19-a769-75bbb704c92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa744fd3a90>]}
[0m11:08:57.948512 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m11:08:57.949319 [info ] [MainThread]: 
[0m11:08:57.954729 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_country_code_ref
[0m11:08:57.955561 [info ] [Thread-1 (]: 1 of 9 START sql view model bc_production.stg_country_code_ref ................. [RUN]
[0m11:08:57.956922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bc_production, now model.bc_sales.stg_country_code_ref)
[0m11:08:57.957956 [debug] [Thread-2 (]: Began running node model.bc_sales.stg_higher_activity_countries
[0m11:08:57.958681 [debug] [Thread-3 (]: Began running node model.bc_sales.stg_sales_by_country
[0m11:08:57.959391 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_country_code_ref
[0m11:08:57.960256 [info ] [Thread-2 (]: 2 of 9 START sql view model bc_production.stg_higher_activity_countries ........ [RUN]
[0m11:08:57.961342 [info ] [Thread-3 (]: 3 of 9 START sql view model bc_production.stg_sales_by_country ................. [RUN]
[0m11:08:57.969986 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales_by_country'
[0m11:08:57.968427 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly create_datatalksclub-375802_bc_production, now model.bc_sales.stg_higher_activity_countries)
[0m11:08:57.966874 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_country_code_ref"
[0m11:08:57.970919 [debug] [Thread-3 (]: Began compiling node model.bc_sales.stg_sales_by_country
[0m11:08:57.971657 [debug] [Thread-2 (]: Began compiling node model.bc_sales.stg_higher_activity_countries
[0m11:08:57.976905 [debug] [Thread-3 (]: Writing injected SQL for node "model.bc_sales.stg_sales_by_country"
[0m11:08:57.984520 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:08:57.985821 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (compile): 11:08:57.972373 => 11:08:57.985421
[0m11:08:57.986637 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (compile): 11:08:57.961959 => 11:08:57.986290
[0m11:08:57.988369 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_country_code_ref
[0m11:08:57.987519 [debug] [Thread-3 (]: Began executing node model.bc_sales.stg_sales_by_country
[0m11:08:58.082218 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_country_code_ref"
[0m11:08:58.083129 [debug] [Thread-3 (]: Writing runtime sql for node "model.bc_sales.stg_sales_by_country"
[0m11:08:58.084051 [debug] [Thread-2 (]: On model.bc_sales.stg_higher_activity_countries: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "prod", "node_id": "model.bc_sales.stg_higher_activity_countries"} */

    select cc_ref
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`
    where count > 20
    order by
	cc_ref desc
    limit 1

[0m11:08:58.085148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:58.087803 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:08:58.182330 [debug] [Thread-3 (]: On model.bc_sales.stg_sales_by_country: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "prod", "node_id": "model.bc_sales.stg_sales_by_country"} */


  create or replace view `datatalksclub-375802`.`bc_production`.`stg_sales_by_country`
  OPTIONS()
  as 

-- Q1

select
  cast(cc_ref as integer) as cc_ref,
  cast(amount_paid_usd as numeric) as amount_paid_usd,

  cast(country_code as string) as country_code,
  cast(country as string) as country

from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_partitioned`;


[0m11:08:58.232215 [debug] [Thread-1 (]: On model.bc_sales.stg_country_code_ref: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "prod", "node_id": "model.bc_sales.stg_country_code_ref"} */


  create or replace view `datatalksclub-375802`.`bc_production`.`stg_country_code_ref`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`;


[0m11:08:58.837296 [debug] [Thread-3 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "prod", "node_id": "model.bc_sales.stg_sales_by_country"} */


  create or replace view `datatalksclub-375802`.`bc_production`.`stg_sales_by_country`
  OPTIONS()
  as 

-- Q1

select
  cast(cc_ref as integer) as cc_ref,
  cast(amount_paid_usd as numeric) as amount_paid_usd,

  cast(country_code as string) as country_code,
  cast(country as string) as country

from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_partitioned`;


[0m11:08:58.838076 [debug] [Thread-3 (]: BigQuery adapter: 404 Not found: Dataset datatalksclub-375802:bc_production was not found in location us-central1

Location: us-central1
Job ID: 0c231df6-b5cb-43be-8cf0-d3325dc27f28

[0m11:08:58.838880 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (execute): 11:08:58.001487 => 11:08:58.838563
[0m11:08:58.841782 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "prod", "node_id": "model.bc_sales.stg_country_code_ref"} */


  create or replace view `datatalksclub-375802`.`bc_production`.`stg_country_code_ref`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`;


[0m11:08:58.842392 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset datatalksclub-375802:bc_production was not found in location us-central1

Location: us-central1
Job ID: b6d8b073-01fd-4ae5-acb5-48b6b57b89a6

[0m11:08:58.843181 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (execute): 11:08:57.988843 => 11:08:58.842885
[0m11:08:58.854581 [debug] [Thread-1 (]: Runtime Error in model stg_country_code_ref (models/staging/stg_country_code_ref.sql)
  404 Not found: Dataset datatalksclub-375802:bc_production was not found in location us-central1
  
  Location: us-central1
  Job ID: b6d8b073-01fd-4ae5-acb5-48b6b57b89a6
  
[0m11:08:58.856048 [debug] [Thread-3 (]: Runtime Error in model stg_sales_by_country (models/staging/stg_sales_by_country.sql)
  404 Not found: Dataset datatalksclub-375802:bc_production was not found in location us-central1
  
  Location: us-central1
  Job ID: 0c231df6-b5cb-43be-8cf0-d3325dc27f28
  
[0m11:08:58.856897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d3428e4-d04b-4f19-a769-75bbb704c92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa745ba2680>]}
[0m11:08:58.857704 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d3428e4-d04b-4f19-a769-75bbb704c92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa745599ab0>]}
[0m11:08:58.858722 [error] [Thread-1 (]: 1 of 9 ERROR creating sql view model bc_production.stg_country_code_ref ........ [[31mERROR[0m in 0.90s]
[0m11:08:58.859881 [error] [Thread-3 (]: 3 of 9 ERROR creating sql view model bc_production.stg_sales_by_country ........ [[31mERROR[0m in 0.89s]
[0m11:08:58.861025 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_country_code_ref
[0m11:08:58.861697 [debug] [Thread-3 (]: Finished running node model.bc_sales.stg_sales_by_country
[0m11:08:58.863174 [debug] [Thread-4 (]: Began running node model.bc_sales.country_facts
[0m11:08:58.863937 [info ] [Thread-4 (]: 4 of 9 SKIP relation bc_production.country_facts ............................... [[33mSKIP[0m]
[0m11:08:58.864994 [debug] [Thread-4 (]: Finished running node model.bc_sales.country_facts
[0m11:08:58.865824 [debug] [Thread-3 (]: Began running node model.bc_sales.country_facts_view
[0m11:08:58.866421 [info ] [Thread-3 (]: 5 of 9 SKIP relation bc_production.country_facts_view .......................... [[33mSKIP[0m]
[0m11:08:58.867278 [debug] [Thread-3 (]: Finished running node model.bc_sales.country_facts_view
[0m11:08:59.688920 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:892fd3f8-15e3-459b-b143-8e8a287e1184&page=queryresults
[0m11:08:59.690172 [debug] [Thread-2 (]: Writing injected SQL for node "model.bc_sales.stg_higher_activity_countries"
[0m11:08:59.691204 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (compile): 11:08:57.977534 => 11:08:59.690856
[0m11:08:59.691739 [debug] [Thread-2 (]: Began executing node model.bc_sales.stg_higher_activity_countries
[0m11:08:59.698043 [debug] [Thread-2 (]: Writing runtime sql for node "model.bc_sales.stg_higher_activity_countries"
[0m11:08:59.698949 [debug] [Thread-2 (]: On model.bc_sales.stg_higher_activity_countries: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "prod", "node_id": "model.bc_sales.stg_higher_activity_countries"} */


  create or replace view `datatalksclub-375802`.`bc_production`.`stg_higher_activity_countries`
  OPTIONS()
  as 

-- Q2, Q3

select
    cast(cc_ref as integer) as cc_ref,
    cast(artist_name as string) as artist_name,
    cast(amount_paid_usd as numeric) as amount_paid_usd,
    cast(country_code as string) as country_code, --REMOVE THIS TOO??
    cast(country as string) as country -- TODO: REMOVE THIS LINE
from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_clustered`
where cc_ref <= 115
order by
    cc_ref asc,
    artist_name asc;


[0m11:08:59.827121 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "prod", "node_id": "model.bc_sales.stg_higher_activity_countries"} */


  create or replace view `datatalksclub-375802`.`bc_production`.`stg_higher_activity_countries`
  OPTIONS()
  as 

-- Q2, Q3

select
    cast(cc_ref as integer) as cc_ref,
    cast(artist_name as string) as artist_name,
    cast(amount_paid_usd as numeric) as amount_paid_usd,
    cast(country_code as string) as country_code, --REMOVE THIS TOO??
    cast(country as string) as country -- TODO: REMOVE THIS LINE
from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_clustered`
where cc_ref <= 115
order by
    cc_ref asc,
    artist_name asc;


[0m11:08:59.828036 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset datatalksclub-375802:bc_production was not found in location us-central1

Location: us-central1
Job ID: 83566530-dd9d-40c0-bbb0-aecd3227e01d

[0m11:08:59.828905 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (execute): 11:08:59.692199 => 11:08:59.828596
[0m11:08:59.830912 [debug] [Thread-2 (]: Runtime Error in model stg_higher_activity_countries (models/staging/stg_higher_activity_countries.sql)
  404 Not found: Dataset datatalksclub-375802:bc_production was not found in location us-central1
  
  Location: us-central1
  Job ID: 83566530-dd9d-40c0-bbb0-aecd3227e01d
  
[0m11:08:59.831554 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d3428e4-d04b-4f19-a769-75bbb704c92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74554eb30>]}
[0m11:08:59.832417 [error] [Thread-2 (]: 2 of 9 ERROR creating sql view model bc_production.stg_higher_activity_countries  [[31mERROR[0m in 1.86s]
[0m11:08:59.833395 [debug] [Thread-2 (]: Finished running node model.bc_sales.stg_higher_activity_countries
[0m11:08:59.834570 [debug] [Thread-4 (]: Began running node model.bc_sales.artist_facts
[0m11:08:59.835124 [info ] [Thread-4 (]: 6 of 9 SKIP relation bc_production.artist_facts ................................ [[33mSKIP[0m]
[0m11:08:59.836008 [debug] [Thread-4 (]: Finished running node model.bc_sales.artist_facts
[0m11:08:59.837204 [debug] [Thread-3 (]: Began running node model.bc_sales.artist_max_avg_facts
[0m11:08:59.837771 [debug] [Thread-1 (]: Began running node model.bc_sales.artist_max_sales_facts
[0m11:08:59.838323 [info ] [Thread-3 (]: 7 of 9 SKIP relation bc_production.artist_max_avg_facts ........................ [[33mSKIP[0m]
[0m11:08:59.839151 [info ] [Thread-1 (]: 8 of 9 SKIP relation bc_production.artist_max_sales_facts ...................... [[33mSKIP[0m]
[0m11:08:59.840484 [debug] [Thread-1 (]: Finished running node model.bc_sales.artist_max_sales_facts
[0m11:08:59.839970 [debug] [Thread-3 (]: Finished running node model.bc_sales.artist_max_avg_facts
[0m11:08:59.841530 [debug] [Thread-4 (]: Began running node model.bc_sales.complete_artist_by_country
[0m11:08:59.842137 [info ] [Thread-4 (]: 9 of 9 SKIP relation bc_production.complete_artist_by_country .................. [[33mSKIP[0m]
[0m11:08:59.842956 [debug] [Thread-4 (]: Finished running node model.bc_sales.complete_artist_by_country
[0m11:08:59.845319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:08:59.845723 [debug] [MainThread]: Connection 'model.bc_sales.stg_higher_activity_countries' was properly closed.
[0m11:08:59.846047 [debug] [MainThread]: Connection 'model.bc_sales.stg_country_code_ref' was properly closed.
[0m11:08:59.846355 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales_by_country' was properly closed.
[0m11:08:59.846813 [info ] [MainThread]: 
[0m11:08:59.847434 [info ] [MainThread]: Finished running 3 view models, 6 table models in 0 hours 0 minutes and 3.96 seconds (3.96s).
[0m11:08:59.848888 [debug] [MainThread]: Command end result
[0m11:08:59.862744 [info ] [MainThread]: 
[0m11:08:59.863642 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m11:08:59.864665 [info ] [MainThread]: 
[0m11:08:59.865533 [error] [MainThread]: [33mRuntime Error in model stg_country_code_ref (models/staging/stg_country_code_ref.sql)[0m
[0m11:08:59.866405 [error] [MainThread]:   404 Not found: Dataset datatalksclub-375802:bc_production was not found in location us-central1
[0m11:08:59.867079 [error] [MainThread]:   
[0m11:08:59.867737 [error] [MainThread]:   Location: us-central1
[0m11:08:59.868499 [error] [MainThread]:   Job ID: b6d8b073-01fd-4ae5-acb5-48b6b57b89a6
[0m11:08:59.869208 [error] [MainThread]:   
[0m11:08:59.869904 [info ] [MainThread]: 
[0m11:08:59.870601 [error] [MainThread]: [33mRuntime Error in model stg_sales_by_country (models/staging/stg_sales_by_country.sql)[0m
[0m11:08:59.871387 [error] [MainThread]:   404 Not found: Dataset datatalksclub-375802:bc_production was not found in location us-central1
[0m11:08:59.872118 [error] [MainThread]:   
[0m11:08:59.872728 [error] [MainThread]:   Location: us-central1
[0m11:08:59.873279 [error] [MainThread]:   Job ID: 0c231df6-b5cb-43be-8cf0-d3325dc27f28
[0m11:08:59.873834 [error] [MainThread]:   
[0m11:08:59.874398 [info ] [MainThread]: 
[0m11:08:59.874983 [error] [MainThread]: [33mRuntime Error in model stg_higher_activity_countries (models/staging/stg_higher_activity_countries.sql)[0m
[0m11:08:59.875537 [error] [MainThread]:   404 Not found: Dataset datatalksclub-375802:bc_production was not found in location us-central1
[0m11:08:59.876237 [error] [MainThread]:   
[0m11:08:59.876812 [error] [MainThread]:   Location: us-central1
[0m11:08:59.877428 [error] [MainThread]:   Job ID: 83566530-dd9d-40c0-bbb0-aecd3227e01d
[0m11:08:59.877990 [error] [MainThread]:   
[0m11:08:59.878571 [info ] [MainThread]: 
[0m11:08:59.879194 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=6 TOTAL=9
[0m11:08:59.880275 [debug] [MainThread]: Command `dbt build` failed at 11:08:59.880114 after 6.78 seconds
[0m11:08:59.880782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa758952530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa745b80d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa745be1270>]}
[0m11:08:59.881268 [debug] [MainThread]: Flushing usage events
[0m12:08:37.920530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f99e62590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f98deb820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f98deb850>]}


============================== 12:08:37.924337 | fd9735ab-0ed1-4a00-a57f-3901f4fcb510 ==============================
[0m12:08:37.924337 [info ] [MainThread]: Running with dbt=1.5.0
[0m12:08:37.925396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:08:38.936568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd9735ab-0ed1-4a00-a57f-3901f4fcb510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f98deb8e0>]}
[0m12:08:38.949354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd9735ab-0ed1-4a00-a57f-3901f4fcb510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f86bd3820>]}
[0m12:08:38.972139 [debug] [MainThread]: checksum: 2b6fdde617d5a0a990757f78fa0717194984bf092aff54287207b08feaec457a, vars: {}, profile: , target: prod, version: 1.5.0
[0m12:08:39.016531 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m12:08:39.017595 [debug] [MainThread]: Partial parsing: added file: bc_sales://models/core/artist_facts_view.sql
[0m12:08:39.018342 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/core/schema.yml
[0m12:08:39.019498 [debug] [MainThread]: Partial parsing: updated file: bc_sales://models/staging/schema.yml
[0m12:08:39.043197 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_facts_view.sql
[0m12:08:39.061497 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m12:08:39.066173 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_by_country.sql
[0m12:08:39.070753 [debug] [MainThread]: 1699: static parser successfully parsed core/complete_artist_by_country.sql
[0m12:08:39.075725 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_max_avg_facts.sql
[0m12:08:39.080124 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_max_sales_facts.sql
[0m12:08:39.084628 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_facts.sql
[0m12:08:39.088953 [debug] [MainThread]: 1603: static parser failed on staging/stg_higher_activity_countries.sql
[0m12:08:39.111668 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_higher_activity_countries.sql
[0m12:08:39.114280 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts_view.sql
[0m12:08:39.119053 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_country_code_ref.sql
[0m12:08:39.178718 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m12:08:39.187881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd9735ab-0ed1-4a00-a57f-3901f4fcb510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f863340d0>]}
[0m12:08:39.201625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd9735ab-0ed1-4a00-a57f-3901f4fcb510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f867ea9e0>]}
[0m12:08:39.202438 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m12:08:39.205318 [info ] [MainThread]: 
[0m12:08:39.206643 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:08:39.208831 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m12:08:39.209398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:39.565504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bc_production)
[0m12:08:39.566378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:08:39.906332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd9735ab-0ed1-4a00-a57f-3901f4fcb510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f867e8820>]}
[0m12:08:39.907816 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m12:08:39.908611 [info ] [MainThread]: 
[0m12:08:39.915537 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_country_code_ref
[0m12:08:39.919026 [info ] [Thread-1 (]: 1 of 10 START sql view model bc_production.stg_country_code_ref ................ [RUN]
[0m12:08:39.917711 [debug] [Thread-3 (]: Began running node model.bc_sales.stg_sales_by_country
[0m12:08:39.922212 [info ] [Thread-3 (]: 3 of 10 START sql view model bc_production.stg_sales_by_country ................ [RUN]
[0m12:08:39.924055 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales_by_country'
[0m12:08:39.924847 [debug] [Thread-3 (]: Began compiling node model.bc_sales.stg_sales_by_country
[0m12:08:39.916738 [debug] [Thread-2 (]: Began running node model.bc_sales.stg_higher_activity_countries
[0m12:08:39.933575 [info ] [Thread-2 (]: 2 of 10 START sql view model bc_production.stg_higher_activity_countries ....... [RUN]
[0m12:08:39.935595 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bc_sales.stg_higher_activity_countries'
[0m12:08:39.936435 [debug] [Thread-2 (]: Began compiling node model.bc_sales.stg_higher_activity_countries
[0m12:08:39.921126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bc_production, now model.bc_sales.stg_country_code_ref)
[0m12:08:39.941197 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_country_code_ref
[0m12:08:39.932494 [debug] [Thread-3 (]: Writing injected SQL for node "model.bc_sales.stg_sales_by_country"
[0m12:08:39.956909 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (compile): 12:08:39.925325 => 12:08:39.956504
[0m12:08:39.955532 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:08:39.945472 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_country_code_ref"
[0m12:08:39.960716 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (compile): 12:08:39.941584 => 12:08:39.960220
[0m12:08:39.961495 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_country_code_ref
[0m12:08:39.957562 [debug] [Thread-3 (]: Began executing node model.bc_sales.stg_sales_by_country
[0m12:08:40.054783 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_country_code_ref"
[0m12:08:40.057568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:40.055742 [debug] [Thread-3 (]: Writing runtime sql for node "model.bc_sales.stg_sales_by_country"
[0m12:08:40.056645 [debug] [Thread-2 (]: On model.bc_sales.stg_higher_activity_countries: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "prod", "node_id": "model.bc_sales.stg_higher_activity_countries"} */

    select cc_ref
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`
    where count > 20
    order by
	cc_ref desc
    limit 1

[0m12:08:40.058874 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:08:40.151138 [debug] [Thread-1 (]: On model.bc_sales.stg_country_code_ref: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "prod", "node_id": "model.bc_sales.stg_country_code_ref"} */


  create or replace view `datatalksclub-375802`.`bc_production`.`stg_country_code_ref`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`;


[0m12:08:40.204232 [debug] [Thread-3 (]: On model.bc_sales.stg_sales_by_country: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "prod", "node_id": "model.bc_sales.stg_sales_by_country"} */


  create or replace view `datatalksclub-375802`.`bc_production`.`stg_sales_by_country`
  OPTIONS()
  as 

-- Q1

select
  cast(cc_ref as integer) as cc_ref,
  cast(amount_paid_usd as numeric) as amount_paid_usd,

  cast(country_code as string) as country_code,
  cast(country as string) as country

from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_partitioned`;


[0m12:08:40.837720 [debug] [Thread-3 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "prod", "node_id": "model.bc_sales.stg_sales_by_country"} */


  create or replace view `datatalksclub-375802`.`bc_production`.`stg_sales_by_country`
  OPTIONS()
  as 

-- Q1

select
  cast(cc_ref as integer) as cc_ref,
  cast(amount_paid_usd as numeric) as amount_paid_usd,

  cast(country_code as string) as country_code,
  cast(country as string) as country

from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_partitioned`;


[0m12:08:40.838472 [debug] [Thread-3 (]: BigQuery adapter: 404 Not found: Dataset datatalksclub-375802:bc_production was not found in location us-central1

Location: us-central1
Job ID: 09750a55-90ac-4f1b-b45c-c51ed889ec53

[0m12:08:40.839283 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (execute): 12:08:39.973112 => 12:08:40.838982
[0m12:08:40.844839 [debug] [Thread-3 (]: Runtime Error in model stg_sales_by_country (models/staging/stg_sales_by_country.sql)
  404 Not found: Dataset datatalksclub-375802:bc_production was not found in location us-central1
  
  Location: us-central1
  Job ID: 09750a55-90ac-4f1b-b45c-c51ed889ec53
  
[0m12:08:40.845705 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd9735ab-0ed1-4a00-a57f-3901f4fcb510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f863995a0>]}
[0m12:08:40.846621 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model bc_production.stg_sales_by_country ....... [[31mERROR[0m in 0.92s]
[0m12:08:40.847647 [debug] [Thread-3 (]: Finished running node model.bc_sales.stg_sales_by_country
[0m12:08:40.848746 [debug] [Thread-4 (]: Began running node model.bc_sales.country_facts
[0m12:08:40.849558 [info ] [Thread-4 (]: 4 of 10 SKIP relation bc_production.country_facts .............................. [[33mSKIP[0m]
[0m12:08:40.850594 [debug] [Thread-4 (]: Finished running node model.bc_sales.country_facts
[0m12:08:40.905426 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "prod", "node_id": "model.bc_sales.stg_country_code_ref"} */


  create or replace view `datatalksclub-375802`.`bc_production`.`stg_country_code_ref`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`;


[0m12:08:40.906167 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset datatalksclub-375802:bc_production was not found in location us-central1

Location: us-central1
Job ID: 00a47891-6c46-47f9-9c6e-74f6c10fc52e

[0m12:08:40.906964 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (execute): 12:08:39.961963 => 12:08:40.906649
[0m12:08:40.908820 [debug] [Thread-1 (]: Runtime Error in model stg_country_code_ref (models/staging/stg_country_code_ref.sql)
  404 Not found: Dataset datatalksclub-375802:bc_production was not found in location us-central1
  
  Location: us-central1
  Job ID: 00a47891-6c46-47f9-9c6e-74f6c10fc52e
  
[0m12:08:40.909424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd9735ab-0ed1-4a00-a57f-3901f4fcb510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f869bd540>]}
[0m12:08:40.910314 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model bc_production.stg_country_code_ref ....... [[31mERROR[0m in 0.99s]
[0m12:08:40.911789 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_country_code_ref
[0m12:08:40.912864 [debug] [Thread-3 (]: Began running node model.bc_sales.country_facts_view
[0m12:08:40.913476 [info ] [Thread-3 (]: 5 of 10 SKIP relation bc_production.country_facts_view ......................... [[33mSKIP[0m]
[0m12:08:40.914532 [debug] [Thread-3 (]: Finished running node model.bc_sales.country_facts_view
[0m12:08:41.564092 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:60abc800-aee7-4b22-9bc1-bbcf536ae36b&page=queryresults
[0m12:08:41.565274 [debug] [Thread-2 (]: Writing injected SQL for node "model.bc_sales.stg_higher_activity_countries"
[0m12:08:41.566253 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (compile): 12:08:39.936983 => 12:08:41.565920
[0m12:08:41.566825 [debug] [Thread-2 (]: Began executing node model.bc_sales.stg_higher_activity_countries
[0m12:08:41.572996 [debug] [Thread-2 (]: Writing runtime sql for node "model.bc_sales.stg_higher_activity_countries"
[0m12:08:41.573920 [debug] [Thread-2 (]: On model.bc_sales.stg_higher_activity_countries: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "prod", "node_id": "model.bc_sales.stg_higher_activity_countries"} */


  create or replace view `datatalksclub-375802`.`bc_production`.`stg_higher_activity_countries`
  OPTIONS()
  as 

-- Q2, Q3

select
    cast(cc_ref as integer) as cc_ref,
    cast(artist_name as string) as artist_name,
    cast(amount_paid_usd as numeric) as amount_paid_usd,
    cast(country_code as string) as country_code, --REMOVE THIS TOO??
    cast(country as string) as country -- TODO: REMOVE THIS LINE
from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_clustered`
where cc_ref <= 115
order by
    cc_ref asc,
    artist_name asc;


[0m12:08:41.688901 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "prod", "node_id": "model.bc_sales.stg_higher_activity_countries"} */


  create or replace view `datatalksclub-375802`.`bc_production`.`stg_higher_activity_countries`
  OPTIONS()
  as 

-- Q2, Q3

select
    cast(cc_ref as integer) as cc_ref,
    cast(artist_name as string) as artist_name,
    cast(amount_paid_usd as numeric) as amount_paid_usd,
    cast(country_code as string) as country_code, --REMOVE THIS TOO??
    cast(country as string) as country -- TODO: REMOVE THIS LINE
from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_clustered`
where cc_ref <= 115
order by
    cc_ref asc,
    artist_name asc;


[0m12:08:41.689727 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset datatalksclub-375802:bc_production was not found in location us-central1

Location: us-central1
Job ID: 4725626f-4fe5-43db-99d3-855f4f8e7507

[0m12:08:41.690522 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (execute): 12:08:41.567143 => 12:08:41.690206
[0m12:08:41.692568 [debug] [Thread-2 (]: Runtime Error in model stg_higher_activity_countries (models/staging/stg_higher_activity_countries.sql)
  404 Not found: Dataset datatalksclub-375802:bc_production was not found in location us-central1
  
  Location: us-central1
  Job ID: 4725626f-4fe5-43db-99d3-855f4f8e7507
  
[0m12:08:41.693230 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd9735ab-0ed1-4a00-a57f-3901f4fcb510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f869ddd50>]}
[0m12:08:41.694313 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model bc_production.stg_higher_activity_countries  [[31mERROR[0m in 1.76s]
[0m12:08:41.695633 [debug] [Thread-2 (]: Finished running node model.bc_sales.stg_higher_activity_countries
[0m12:08:41.697165 [debug] [Thread-1 (]: Began running node model.bc_sales.artist_facts
[0m12:08:41.697826 [info ] [Thread-1 (]: 6 of 10 SKIP relation bc_production.artist_facts ............................... [[33mSKIP[0m]
[0m12:08:41.698894 [debug] [Thread-1 (]: Finished running node model.bc_sales.artist_facts
[0m12:08:41.700051 [debug] [Thread-3 (]: Began running node model.bc_sales.artist_facts_view
[0m12:08:41.701789 [info ] [Thread-3 (]: 7 of 10 SKIP relation bc_production.artist_facts_view .......................... [[33mSKIP[0m]
[0m12:08:41.701178 [debug] [Thread-4 (]: Began running node model.bc_sales.artist_max_sales_facts
[0m12:08:41.700603 [debug] [Thread-2 (]: Began running node model.bc_sales.artist_max_avg_facts
[0m12:08:41.702890 [debug] [Thread-3 (]: Finished running node model.bc_sales.artist_facts_view
[0m12:08:41.703491 [info ] [Thread-4 (]: 9 of 10 SKIP relation bc_production.artist_max_sales_facts ..................... [[33mSKIP[0m]
[0m12:08:41.704491 [info ] [Thread-2 (]: 8 of 10 SKIP relation bc_production.artist_max_avg_facts ....................... [[33mSKIP[0m]
[0m12:08:41.705627 [debug] [Thread-4 (]: Finished running node model.bc_sales.artist_max_sales_facts
[0m12:08:41.706249 [debug] [Thread-2 (]: Finished running node model.bc_sales.artist_max_avg_facts
[0m12:08:41.707647 [debug] [Thread-1 (]: Began running node model.bc_sales.complete_artist_by_country
[0m12:08:41.708293 [info ] [Thread-1 (]: 10 of 10 SKIP relation bc_production.complete_artist_by_country ................ [[33mSKIP[0m]
[0m12:08:41.709099 [debug] [Thread-1 (]: Finished running node model.bc_sales.complete_artist_by_country
[0m12:08:41.711392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:08:41.711860 [debug] [MainThread]: Connection 'model.bc_sales.stg_country_code_ref' was properly closed.
[0m12:08:41.712263 [debug] [MainThread]: Connection 'model.bc_sales.stg_sales_by_country' was properly closed.
[0m12:08:41.712579 [debug] [MainThread]: Connection 'model.bc_sales.stg_higher_activity_countries' was properly closed.
[0m12:08:41.713032 [info ] [MainThread]: 
[0m12:08:41.713875 [info ] [MainThread]: Finished running 3 view models, 7 table models in 0 hours 0 minutes and 2.51 seconds (2.51s).
[0m12:08:41.715335 [debug] [MainThread]: Command end result
[0m12:08:41.735473 [info ] [MainThread]: 
[0m12:08:41.736496 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m12:08:41.737231 [info ] [MainThread]: 
[0m12:08:41.737873 [error] [MainThread]: [33mRuntime Error in model stg_sales_by_country (models/staging/stg_sales_by_country.sql)[0m
[0m12:08:41.738596 [error] [MainThread]:   404 Not found: Dataset datatalksclub-375802:bc_production was not found in location us-central1
[0m12:08:41.739196 [error] [MainThread]:   
[0m12:08:41.739862 [error] [MainThread]:   Location: us-central1
[0m12:08:41.740449 [error] [MainThread]:   Job ID: 09750a55-90ac-4f1b-b45c-c51ed889ec53
[0m12:08:41.741028 [error] [MainThread]:   
[0m12:08:41.741620 [info ] [MainThread]: 
[0m12:08:41.742210 [error] [MainThread]: [33mRuntime Error in model stg_country_code_ref (models/staging/stg_country_code_ref.sql)[0m
[0m12:08:41.742780 [error] [MainThread]:   404 Not found: Dataset datatalksclub-375802:bc_production was not found in location us-central1
[0m12:08:41.743343 [error] [MainThread]:   
[0m12:08:41.743937 [error] [MainThread]:   Location: us-central1
[0m12:08:41.744497 [error] [MainThread]:   Job ID: 00a47891-6c46-47f9-9c6e-74f6c10fc52e
[0m12:08:41.745064 [error] [MainThread]:   
[0m12:08:41.745646 [info ] [MainThread]: 
[0m12:08:41.746241 [error] [MainThread]: [33mRuntime Error in model stg_higher_activity_countries (models/staging/stg_higher_activity_countries.sql)[0m
[0m12:08:41.746825 [error] [MainThread]:   404 Not found: Dataset datatalksclub-375802:bc_production was not found in location us-central1
[0m12:08:41.747397 [error] [MainThread]:   
[0m12:08:41.747991 [error] [MainThread]:   Location: us-central1
[0m12:08:41.748539 [error] [MainThread]:   Job ID: 4725626f-4fe5-43db-99d3-855f4f8e7507
[0m12:08:41.749136 [error] [MainThread]:   
[0m12:08:41.749788 [info ] [MainThread]: 
[0m12:08:41.750648 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=7 TOTAL=10
[0m12:08:41.751833 [debug] [MainThread]: Command `dbt build` failed at 12:08:41.751617 after 3.84 seconds
[0m12:08:41.752382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f99e62590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f99de32b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f8693c370>]}
[0m12:08:41.752901 [debug] [MainThread]: Flushing usage events
[0m17:33:53.093204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7fc4a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7ebcf790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7ebcf7c0>]}


============================== 17:33:53.097045 | 1babb787-0f8c-4cfd-9de2-f93e8727f85c ==============================
[0m17:33:53.097045 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:33:53.098271 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'version_check': 'True', 'profiles_dir': '/home/j/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:33:54.261307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1babb787-0f8c-4cfd-9de2-f93e8727f85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7ebcf850>]}
[0m17:33:54.275093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1babb787-0f8c-4cfd-9de2-f93e8727f85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6cad07f0>]}
[0m17:33:54.298930 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m17:33:54.319177 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:33:54.320588 [debug] [MainThread]: previous checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, current checksum: 2b6fdde617d5a0a990757f78fa0717194984bf092aff54287207b08feaec457a
[0m17:33:54.321145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1babb787-0f8c-4cfd-9de2-f93e8727f85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6cadeaa0>]}
[0m17:33:55.502700 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_country_code_ref.sql
[0m17:33:55.521043 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_by_country.sql
[0m17:33:55.525974 [debug] [MainThread]: 1603: static parser failed on staging/stg_higher_activity_countries.sql
[0m17:33:55.548004 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_higher_activity_countries.sql
[0m17:33:55.550571 [debug] [MainThread]: 1699: static parser successfully parsed core/complete_artist_by_country.sql
[0m17:33:55.555216 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_facts_view.sql
[0m17:33:55.560339 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts_view.sql
[0m17:33:55.564662 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_facts.sql
[0m17:33:55.569620 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m17:33:55.574201 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_max_sales_facts.sql
[0m17:33:55.579112 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_max_avg_facts.sql
[0m17:33:55.793152 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m17:33:55.801465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1babb787-0f8c-4cfd-9de2-f93e8727f85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7ebcf7c0>]}
[0m17:33:55.820266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1babb787-0f8c-4cfd-9de2-f93e8727f85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6cadde70>]}
[0m17:33:55.821174 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m17:33:55.823856 [info ] [MainThread]: 
[0m17:33:55.825212 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:33:55.827533 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m17:33:55.828302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:56.193007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bandcamp_sales_schema)
[0m17:33:56.193999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:56.549686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1babb787-0f8c-4cfd-9de2-f93e8727f85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6cade8c0>]}
[0m17:33:56.550864 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:33:56.551970 [info ] [MainThread]: 
[0m17:33:56.557971 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_country_code_ref
[0m17:33:56.559508 [debug] [Thread-2 (]: Began running node model.bc_sales.stg_higher_activity_countries
[0m17:33:56.558869 [info ] [Thread-1 (]: 1 of 10 START sql view model bandcamp_sales_schema.stg_country_code_ref ........ [RUN]
[0m17:33:56.560647 [debug] [Thread-3 (]: Began running node model.bc_sales.stg_sales_by_country
[0m17:33:56.561351 [info ] [Thread-2 (]: 2 of 10 START sql view model bandcamp_sales_schema.stg_higher_activity_countries  [RUN]
[0m17:33:56.562610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bandcamp_sales_schema, now model.bc_sales.stg_country_code_ref)
[0m17:33:56.564878 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bc_sales.stg_higher_activity_countries'
[0m17:33:56.563364 [info ] [Thread-3 (]: 3 of 10 START sql view model bandcamp_sales_schema.stg_sales_by_country ........ [RUN]
[0m17:33:56.567384 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales_by_country'
[0m17:33:56.566150 [debug] [Thread-2 (]: Began compiling node model.bc_sales.stg_higher_activity_countries
[0m17:33:56.565604 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_country_code_ref
[0m17:33:56.567918 [debug] [Thread-3 (]: Began compiling node model.bc_sales.stg_sales_by_country
[0m17:33:56.585277 [debug] [Thread-3 (]: Writing injected SQL for node "model.bc_sales.stg_sales_by_country"
[0m17:33:56.580357 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_country_code_ref"
[0m17:33:56.575562 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:33:56.586718 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (compile): 17:33:56.576151 => 17:33:56.586325
[0m17:33:56.587487 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (compile): 17:33:56.580933 => 17:33:56.587092
[0m17:33:56.589445 [debug] [Thread-3 (]: Began executing node model.bc_sales.stg_sales_by_country
[0m17:33:56.588638 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_country_code_ref
[0m17:33:56.693422 [debug] [Thread-3 (]: Writing runtime sql for node "model.bc_sales.stg_sales_by_country"
[0m17:33:56.694166 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_country_code_ref"
[0m17:33:56.694954 [debug] [Thread-2 (]: On model.bc_sales.stg_higher_activity_countries: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_higher_activity_countries"} */

    select cc_ref
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`
    where count > 20
    order by
	cc_ref desc
    limit 1

[0m17:33:56.697614 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:33:56.699096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:56.811939 [debug] [Thread-3 (]: On model.bc_sales.stg_sales_by_country: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_sales_by_country"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
  OPTIONS()
  as 

-- Q1

select
  cast(cc_ref as integer) as cc_ref,
  cast(amount_paid_usd as numeric) as amount_paid_usd,

  cast(country_code as string) as country_code,
  cast(country as string) as country

from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_partitioned`;


[0m17:33:56.854828 [debug] [Thread-1 (]: On model.bc_sales.stg_country_code_ref: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_country_code_ref"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`;


[0m17:33:57.983183 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:3619f7e2-0ad0-4983-890e-f9bc5b8bc99c&page=queryresults
[0m17:33:58.004471 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (execute): 17:33:56.589893 => 17:33:58.004158
[0m17:33:58.005623 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1babb787-0f8c-4cfd-9de2-f93e8727f85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6c992020>]}
[0m17:33:58.006547 [info ] [Thread-3 (]: 3 of 10 OK created sql view model bandcamp_sales_schema.stg_sales_by_country ... [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m17:33:58.008188 [debug] [Thread-3 (]: Finished running node model.bc_sales.stg_sales_by_country
[0m17:33:58.009392 [debug] [Thread-4 (]: Began running node model.bc_sales.country_facts
[0m17:33:58.010166 [info ] [Thread-4 (]: 4 of 10 START sql table model bandcamp_sales_schema.country_facts .............. [RUN]
[0m17:33:58.012086 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bc_sales.country_facts'
[0m17:33:58.012618 [debug] [Thread-4 (]: Began compiling node model.bc_sales.country_facts
[0m17:33:58.017840 [debug] [Thread-4 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m17:33:58.019029 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (compile): 17:33:58.012921 => 17:33:58.018614
[0m17:33:58.019616 [debug] [Thread-4 (]: Began executing node model.bc_sales.country_facts
[0m17:33:58.048071 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:b45c0020-3637-4c78-98d9-93d102640fef&page=queryresults
[0m17:33:58.056209 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (execute): 17:33:56.601128 => 17:33:58.055863
[0m17:33:58.062712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1babb787-0f8c-4cfd-9de2-f93e8727f85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6c983190>]}
[0m17:33:58.066971 [debug] [Thread-4 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m17:33:58.068107 [info ] [Thread-1 (]: 1 of 10 OK created sql view model bandcamp_sales_schema.stg_country_code_ref ... [[32mCREATE VIEW (0 processed)[0m in 1.50s]
[0m17:33:58.069670 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:33:58.070806 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_country_code_ref
[0m17:33:58.122420 [debug] [Thread-4 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
    
    

    OPTIONS()
    as (
      


with countries as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_sales_by_country`
)

select
    countries.cc_ref as ref,
    count(countries.cc_ref) as total_transactions,
    avg(countries.amount_paid_usd) as average_sale_usd,
    sum(countries.amount_paid_usd) as total_sales_usd,
from countries
group by countries.cc_ref
order by average_sale_usd desc
    );
  
[0m17:33:58.373048 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:cab76c02-fcbc-4b6d-8e5b-cf9a6b58a635&page=queryresults
[0m17:33:58.374393 [debug] [Thread-2 (]: Writing injected SQL for node "model.bc_sales.stg_higher_activity_countries"
[0m17:33:58.375499 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (compile): 17:33:56.568296 => 17:33:58.375136
[0m17:33:58.376237 [debug] [Thread-2 (]: Began executing node model.bc_sales.stg_higher_activity_countries
[0m17:33:58.382348 [debug] [Thread-2 (]: Writing runtime sql for node "model.bc_sales.stg_higher_activity_countries"
[0m17:33:58.383330 [debug] [Thread-2 (]: On model.bc_sales.stg_higher_activity_countries: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.stg_higher_activity_countries"} */


  create or replace view `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_higher_activity_countries`
  OPTIONS()
  as 

-- Q2, Q3

select
    cast(cc_ref as integer) as cc_ref,
    cast(artist_name as string) as artist_name,
    cast(amount_paid_usd as numeric) as amount_paid_usd,
    cast(country_code as string) as country_code, --REMOVE THIS TOO??
    cast(country as string) as country -- TODO: REMOVE THIS LINE
from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_clustered`
where cc_ref <= 115
order by
    cc_ref asc,
    artist_name asc;


[0m17:33:59.064694 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:58497a9a-2d00-4188-aa82-0b11bf4d0227&page=queryresults
[0m17:33:59.067825 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (execute): 17:33:58.376594 => 17:33:59.067498
[0m17:33:59.069117 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1babb787-0f8c-4cfd-9de2-f93e8727f85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6c8f4d60>]}
[0m17:33:59.070011 [info ] [Thread-2 (]: 2 of 10 OK created sql view model bandcamp_sales_schema.stg_higher_activity_countries  [[32mCREATE VIEW (0 processed)[0m in 2.51s]
[0m17:33:59.071234 [debug] [Thread-2 (]: Finished running node model.bc_sales.stg_higher_activity_countries
[0m17:33:59.072285 [debug] [Thread-3 (]: Began running node model.bc_sales.artist_facts
[0m17:33:59.073008 [info ] [Thread-3 (]: 5 of 10 START sql table model bandcamp_sales_schema.artist_facts ............... [RUN]
[0m17:33:59.074194 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bc_sales.stg_sales_by_country, now model.bc_sales.artist_facts)
[0m17:33:59.074693 [debug] [Thread-3 (]: Began compiling node model.bc_sales.artist_facts
[0m17:33:59.079422 [debug] [Thread-3 (]: Writing injected SQL for node "model.bc_sales.artist_facts"
[0m17:33:59.080716 [debug] [Thread-3 (]: Timing info for model.bc_sales.artist_facts (compile): 17:33:59.074985 => 17:33:59.080346
[0m17:33:59.081312 [debug] [Thread-3 (]: Began executing node model.bc_sales.artist_facts
[0m17:33:59.086139 [debug] [Thread-3 (]: Writing runtime sql for node "model.bc_sales.artist_facts"
[0m17:33:59.087180 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:33:59.145205 [debug] [Thread-3 (]: On model.bc_sales.artist_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.artist_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_facts`
    
    

    OPTIONS()
    as (
      

with sales as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_higher_activity_countries`
)

select
    cc_ref as cc_ref,
    artist_name as artist,
    sum(amount_paid_usd) as total_sales_usd,
    avg(amount_paid_usd) as avg_sales_usd,
from sales
group by 1,2
order by 1, 3 desc
    );
  
[0m17:34:00.681776 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:ac9c98bf-67c6-470b-9fbd-0a446a03113c&page=queryresults
[0m17:34:00.685611 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (execute): 17:33:58.019998 => 17:34:00.685269
[0m17:34:00.687105 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1babb787-0f8c-4cfd-9de2-f93e8727f85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6c298c70>]}
[0m17:34:00.688205 [info ] [Thread-4 (]: 4 of 10 OK created sql table model bandcamp_sales_schema.country_facts ......... [[32mCREATE TABLE (186.0 rows, 15.3 MiB processed)[0m in 2.68s]
[0m17:34:00.689912 [debug] [Thread-4 (]: Finished running node model.bc_sales.country_facts
[0m17:34:00.690971 [debug] [Thread-4 (]: Began running node model.bc_sales.country_facts_view
[0m17:34:00.691731 [info ] [Thread-4 (]: 6 of 10 START sql table model bandcamp_sales_schema.country_facts_view ......... [RUN]
[0m17:34:00.693816 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bc_sales.country_facts, now model.bc_sales.country_facts_view)
[0m17:34:00.694380 [debug] [Thread-4 (]: Began compiling node model.bc_sales.country_facts_view
[0m17:34:00.700825 [debug] [Thread-4 (]: Writing injected SQL for node "model.bc_sales.country_facts_view"
[0m17:34:00.702336 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts_view (compile): 17:34:00.694700 => 17:34:00.701907
[0m17:34:00.703058 [debug] [Thread-4 (]: Began executing node model.bc_sales.country_facts_view
[0m17:34:00.712443 [debug] [Thread-4 (]: Writing runtime sql for node "model.bc_sales.country_facts_view"
[0m17:34:00.714442 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:34:00.766073 [debug] [Thread-4 (]: On model.bc_sales.country_facts_view: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.country_facts_view"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts_view`
    
    

    OPTIONS()
    as (
      

with facts as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_facts`
),

refs as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
)

select
    facts.ref as ref,
    facts.total_transactions as total_transactions,
    facts.average_sale_usd as avg_sale_usd,
    facts.total_sales_usd as total_sales_usd,
    refs.country_code as cc
from facts
left join refs
on facts.ref = refs.cc_ref
where total_transactions > 100
order by 3 desc
    );
  
[0m17:34:02.575336 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:083c8dc3-58e3-4419-b23e-8f4d9740d2c0&page=queryresults
[0m17:34:02.578765 [debug] [Thread-3 (]: Timing info for model.bc_sales.artist_facts (execute): 17:33:59.081674 => 17:34:02.578445
[0m17:34:02.580052 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1babb787-0f8c-4cfd-9de2-f93e8727f85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6c8f79d0>]}
[0m17:34:02.581002 [info ] [Thread-3 (]: 5 of 10 OK created sql table model bandcamp_sales_schema.artist_facts .......... [[32mCREATE TABLE (361.0k rows, 29.5 MiB processed)[0m in 3.51s]
[0m17:34:02.582495 [debug] [Thread-3 (]: Finished running node model.bc_sales.artist_facts
[0m17:34:02.583512 [debug] [Thread-3 (]: Began running node model.bc_sales.artist_facts_view
[0m17:34:02.584090 [debug] [Thread-1 (]: Began running node model.bc_sales.artist_max_avg_facts
[0m17:34:02.584651 [debug] [Thread-2 (]: Began running node model.bc_sales.artist_max_sales_facts
[0m17:34:02.587270 [info ] [Thread-2 (]: 9 of 10 START sql table model bandcamp_sales_schema.artist_max_sales_facts ..... [RUN]
[0m17:34:02.588677 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bc_sales.stg_higher_activity_countries, now model.bc_sales.artist_max_sales_facts)
[0m17:34:02.585440 [info ] [Thread-3 (]: 7 of 10 START sql table model bandcamp_sales_schema.artist_facts_view .......... [RUN]
[0m17:34:02.586375 [info ] [Thread-1 (]: 8 of 10 START sql table model bandcamp_sales_schema.artist_max_avg_facts ....... [RUN]
[0m17:34:02.589283 [debug] [Thread-2 (]: Began compiling node model.bc_sales.artist_max_sales_facts
[0m17:34:02.590555 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bc_sales.artist_facts, now model.bc_sales.artist_facts_view)
[0m17:34:02.591449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bc_sales.stg_country_code_ref, now model.bc_sales.artist_max_avg_facts)
[0m17:34:02.599159 [debug] [Thread-3 (]: Began compiling node model.bc_sales.artist_facts_view
[0m17:34:02.600054 [debug] [Thread-1 (]: Began compiling node model.bc_sales.artist_max_avg_facts
[0m17:34:02.604752 [debug] [Thread-2 (]: Writing injected SQL for node "model.bc_sales.artist_max_sales_facts"
[0m17:34:02.609824 [debug] [Thread-3 (]: Writing injected SQL for node "model.bc_sales.artist_facts_view"
[0m17:34:02.614951 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.artist_max_avg_facts"
[0m17:34:02.616376 [debug] [Thread-2 (]: Timing info for model.bc_sales.artist_max_sales_facts (compile): 17:34:02.591920 => 17:34:02.615950
[0m17:34:02.617604 [debug] [Thread-3 (]: Timing info for model.bc_sales.artist_facts_view (compile): 17:34:02.605246 => 17:34:02.617237
[0m17:34:02.618354 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_max_avg_facts (compile): 17:34:02.610439 => 17:34:02.618009
[0m17:34:02.620582 [debug] [Thread-1 (]: Began executing node model.bc_sales.artist_max_avg_facts
[0m17:34:02.619913 [debug] [Thread-3 (]: Began executing node model.bc_sales.artist_facts_view
[0m17:34:02.619134 [debug] [Thread-2 (]: Began executing node model.bc_sales.artist_max_sales_facts
[0m17:34:02.625618 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.artist_max_avg_facts"
[0m17:34:02.636556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:02.635271 [debug] [Thread-2 (]: Writing runtime sql for node "model.bc_sales.artist_max_sales_facts"
[0m17:34:02.630474 [debug] [Thread-3 (]: Writing runtime sql for node "model.bc_sales.artist_facts_view"
[0m17:34:02.644706 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:34:02.652603 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:34:02.737828 [debug] [Thread-3 (]: On model.bc_sales.artist_facts_view: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.artist_facts_view"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_facts_view`
    
    

    OPTIONS()
    as (
      

with facts as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_facts`
),

refs as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
),

with max_total_sales as (
    select
        facts.cc_ref as ref,
        --facts.artist,
        max(facts.total_usd) as max_sales_usd
    from facts
    group by 1
    order by 1
)

select
    max_total_sales.ref as ref,
    max_total_sales.max_sales_usd as max_sales_usd,
    facts.artist as artist
from max_total_sales
left join facts
on max_total_sales.ref = facts.cc_ref
and max_total_sales.max_sales_usd = facts.total_usd
    );
  
[0m17:34:02.770074 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:051585f7-1836-4758-bbe3-1731e01ca0f9&page=queryresults
[0m17:34:02.774588 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts_view (execute): 17:34:00.703465 => 17:34:02.774081
[0m17:34:02.784723 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1babb787-0f8c-4cfd-9de2-f93e8727f85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6c8f4a30>]}
[0m17:34:02.786270 [info ] [Thread-4 (]: 6 of 10 OK created sql table model bandcamp_sales_schema.country_facts_view .... [[32mCREATE TABLE (78.0 rows, 10.9 KiB processed)[0m in 2.09s]
[0m17:34:02.788621 [debug] [Thread-4 (]: Finished running node model.bc_sales.country_facts_view
[0m17:34:02.806151 [debug] [Thread-2 (]: On model.bc_sales.artist_max_sales_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.artist_max_sales_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_max_sales_facts`
    
    

    OPTIONS()
    as (
      

with facts as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_facts`
),

refs as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
),

max_total_sales as (
    select
        facts.cc_ref as ref,
        --facts.artist,
        max(facts.total_sales_usd) as max_sales_usd
    from facts
    group by 1
    order by 1
)

select
    max_total_sales.ref as ref,
    max_total_sales.max_sales_usd as max_sales_usd,
    facts.artist as artist
from max_total_sales
left join facts
on max_total_sales.ref = facts.cc_ref
and max_total_sales.max_sales_usd = facts.total_sales_usd
order by 1
    );
  
[0m17:34:02.815672 [debug] [Thread-1 (]: On model.bc_sales.artist_max_avg_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.artist_max_avg_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_max_avg_facts`
    
    

    OPTIONS()
    as (
      

with facts as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_facts`
),

refs as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
),

max_avg_sales as (
    select
        facts.cc_ref as ref,
        --facts.artist,
        max(facts.avg_sales_usd) as max_avg_usd
    from facts
    group by 1
)

select
    max_avg_sales.ref as ref,
    max_avg_sales.max_avg_usd as max_avg_usd,
    facts.artist as artist
from max_avg_sales
left join facts
on max_avg_sales.ref = facts.cc_ref
and max_avg_sales.max_avg_usd = facts.avg_sales_usd
order by 1
    );
  
[0m17:34:03.571924 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword SELECT but got keyword WITH at [22:1]')
[0m17:34:04.408568 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:US:be93f519-13ac-4ff0-9d3e-8d604aa1c65d&page=queryresults
[0m17:34:04.410329 [debug] [Thread-3 (]: Timing info for model.bc_sales.artist_facts_view (execute): 17:34:02.626164 => 17:34:04.409952
[0m17:34:04.418116 [debug] [Thread-3 (]: Database Error in model artist_facts_view (models/core/artist_facts_view.sql)
  Syntax error: Expected keyword SELECT but got keyword WITH at [22:1]
  compiled Code at target/run/bc_sales/models/core/artist_facts_view.sql
[0m17:34:04.419126 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1babb787-0f8c-4cfd-9de2-f93e8727f85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6c10c430>]}
[0m17:34:04.420278 [error] [Thread-3 (]: 7 of 10 ERROR creating sql table model bandcamp_sales_schema.artist_facts_view . [[31mERROR[0m in 1.83s]
[0m17:34:04.421485 [debug] [Thread-3 (]: Finished running node model.bc_sales.artist_facts_view
[0m17:34:05.668044 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:ee4f42ed-2142-45e0-b01a-a2ac3a420684&page=queryresults
[0m17:34:05.671082 [debug] [Thread-2 (]: Timing info for model.bc_sales.artist_max_sales_facts (execute): 17:34:02.631048 => 17:34:05.670773
[0m17:34:05.672352 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1babb787-0f8c-4cfd-9de2-f93e8727f85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6c10d0c0>]}
[0m17:34:05.673303 [info ] [Thread-2 (]: 9 of 10 OK created sql table model bandcamp_sales_schema.artist_max_sales_facts  [[32mCREATE TABLE (118.0 rows, 13.5 MiB processed)[0m in 3.08s]
[0m17:34:05.674762 [debug] [Thread-2 (]: Finished running node model.bc_sales.artist_max_sales_facts
[0m17:34:05.714405 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:efe892c0-d62a-4524-b3c8-b5a929f3b761&page=queryresults
[0m17:34:05.717541 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_max_avg_facts (execute): 17:34:02.620954 => 17:34:05.717256
[0m17:34:05.719233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1babb787-0f8c-4cfd-9de2-f93e8727f85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6c10ccd0>]}
[0m17:34:05.720211 [info ] [Thread-1 (]: 8 of 10 OK created sql table model bandcamp_sales_schema.artist_max_avg_facts .. [[32mCREATE TABLE (119.0 rows, 13.5 MiB processed)[0m in 3.13s]
[0m17:34:05.721578 [debug] [Thread-1 (]: Finished running node model.bc_sales.artist_max_avg_facts
[0m17:34:05.722722 [debug] [Thread-4 (]: Began running node model.bc_sales.complete_artist_by_country
[0m17:34:05.723532 [info ] [Thread-4 (]: 10 of 10 START sql table model bandcamp_sales_schema.complete_artist_by_country  [RUN]
[0m17:34:05.724807 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bc_sales.country_facts_view, now model.bc_sales.complete_artist_by_country)
[0m17:34:05.725663 [debug] [Thread-4 (]: Began compiling node model.bc_sales.complete_artist_by_country
[0m17:34:05.734581 [debug] [Thread-4 (]: Writing injected SQL for node "model.bc_sales.complete_artist_by_country"
[0m17:34:05.735950 [debug] [Thread-4 (]: Timing info for model.bc_sales.complete_artist_by_country (compile): 17:34:05.726003 => 17:34:05.735470
[0m17:34:05.736586 [debug] [Thread-4 (]: Began executing node model.bc_sales.complete_artist_by_country
[0m17:34:05.741629 [debug] [Thread-4 (]: Writing runtime sql for node "model.bc_sales.complete_artist_by_country"
[0m17:34:05.742690 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:34:05.791516 [debug] [Thread-4 (]: On model.bc_sales.complete_artist_by_country: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "dev", "node_id": "model.bc_sales.complete_artist_by_country"} */

  
    

    create or replace table `datatalksclub-375802`.`bandcamp_sales_schema`.`complete_artist_by_country`
    
    

    OPTIONS()
    as (
      

with refs as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`stg_country_code_ref`
),

max_totals as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_max_sales_facts`
),

max_avg as (
    select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`artist_max_avg_facts`
)

select
    refs.cc_ref as ref,
    refs.country_code,
    max_totals.artist as highest_selling,
    max_avg.artist as highest_average,
from refs
right join max_totals
on refs.cc_ref = max_totals.ref
right join max_avg
on refs.cc_ref = max_avg.ref
order by 1
    );
  
[0m17:34:08.073514 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:62cf6a49-9726-4ec0-8ff0-a47abe12e812&page=queryresults
[0m17:34:08.076983 [debug] [Thread-4 (]: Timing info for model.bc_sales.complete_artist_by_country (execute): 17:34:05.736944 => 17:34:08.076669
[0m17:34:08.078410 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1babb787-0f8c-4cfd-9de2-f93e8727f85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6c10ca90>]}
[0m17:34:08.079378 [info ] [Thread-4 (]: 10 of 10 OK created sql table model bandcamp_sales_schema.complete_artist_by_country  [[32mCREATE TABLE (123.0 rows, 7.4 KiB processed)[0m in 2.35s]
[0m17:34:08.080698 [debug] [Thread-4 (]: Finished running node model.bc_sales.complete_artist_by_country
[0m17:34:08.084043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:08.084552 [debug] [MainThread]: Connection 'model.bc_sales.artist_max_avg_facts' was properly closed.
[0m17:34:08.084906 [debug] [MainThread]: Connection 'model.bc_sales.artist_max_sales_facts' was properly closed.
[0m17:34:08.085247 [debug] [MainThread]: Connection 'model.bc_sales.artist_facts_view' was properly closed.
[0m17:34:08.085558 [debug] [MainThread]: Connection 'model.bc_sales.complete_artist_by_country' was properly closed.
[0m17:34:08.086059 [info ] [MainThread]: 
[0m17:34:08.087195 [info ] [MainThread]: Finished running 3 view models, 7 table models in 0 hours 0 minutes and 12.26 seconds (12.26s).
[0m17:34:08.090211 [debug] [MainThread]: Command end result
[0m17:34:08.107099 [info ] [MainThread]: 
[0m17:34:08.108312 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:34:08.109100 [info ] [MainThread]: 
[0m17:34:08.109856 [error] [MainThread]: [33mDatabase Error in model artist_facts_view (models/core/artist_facts_view.sql)[0m
[0m17:34:08.110453 [error] [MainThread]:   Syntax error: Expected keyword SELECT but got keyword WITH at [22:1]
[0m17:34:08.111074 [error] [MainThread]:   compiled Code at target/run/bc_sales/models/core/artist_facts_view.sql
[0m17:34:08.111699 [info ] [MainThread]: 
[0m17:34:08.112380 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m17:34:08.113513 [debug] [MainThread]: Command `dbt build` failed at 17:34:08.113297 after 15.03 seconds
[0m17:34:08.114064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7fc4a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7f7ba380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6cad07f0>]}
[0m17:34:08.114666 [debug] [MainThread]: Flushing usage events
[0m17:36:09.651041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0da04a5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d8fd3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d8fd3880>]}


============================== 17:36:09.654808 | b7123d0a-cd71-406c-b650-dab9a677e762 ==============================
[0m17:36:09.654808 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:36:09.656625 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/j/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/j/bcsales/dbt/bc_sales/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:36:10.671604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7123d0a-cd71-406c-b650-dab9a677e762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d8fd3910>]}
[0m17:36:10.684292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7123d0a-cd71-406c-b650-dab9a677e762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c6e33820>]}
[0m17:36:10.707166 [debug] [MainThread]: checksum: 2b6fdde617d5a0a990757f78fa0717194984bf092aff54287207b08feaec457a, vars: {}, profile: , target: prod, version: 1.5.0
[0m17:36:10.722213 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:36:10.723353 [debug] [MainThread]: previous checksum: 2b6fdde617d5a0a990757f78fa0717194984bf092aff54287207b08feaec457a, current checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda
[0m17:36:10.723979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b7123d0a-cd71-406c-b650-dab9a677e762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c6e3a290>]}
[0m17:36:11.917764 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_country_code_ref.sql
[0m17:36:11.935804 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_by_country.sql
[0m17:36:11.940313 [debug] [MainThread]: 1603: static parser failed on staging/stg_higher_activity_countries.sql
[0m17:36:11.962158 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_higher_activity_countries.sql
[0m17:36:11.964689 [debug] [MainThread]: 1699: static parser successfully parsed core/complete_artist_by_country.sql
[0m17:36:11.968988 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_facts_view.sql
[0m17:36:11.973910 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts_view.sql
[0m17:36:11.978983 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_facts.sql
[0m17:36:11.983579 [debug] [MainThread]: 1699: static parser successfully parsed core/country_facts.sql
[0m17:36:11.988166 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_max_sales_facts.sql
[0m17:36:11.993198 [debug] [MainThread]: 1699: static parser successfully parsed core/artist_max_avg_facts.sql
[0m17:36:12.203734 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bc_sales.example
[0m17:36:12.212173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7123d0a-cd71-406c-b650-dab9a677e762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d8fd3880>]}
[0m17:36:12.227009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7123d0a-cd71-406c-b650-dab9a677e762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c6e39e10>]}
[0m17:36:12.227847 [info ] [MainThread]: Found 10 models, 0 tests, 0 snapshots, 0 analyses, 465 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m17:36:12.230377 [info ] [MainThread]: 
[0m17:36:12.231968 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:36:12.234050 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_datatalksclub-375802'
[0m17:36:12.234740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:12.585200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datatalksclub-375802, now list_datatalksclub-375802_bc_production)
[0m17:36:12.586114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:36:12.918999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7123d0a-cd71-406c-b650-dab9a677e762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c6d02ce0>]}
[0m17:36:12.920450 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m17:36:12.921257 [info ] [MainThread]: 
[0m17:36:12.927379 [debug] [Thread-1 (]: Began running node model.bc_sales.stg_country_code_ref
[0m17:36:12.928284 [debug] [Thread-2 (]: Began running node model.bc_sales.stg_higher_activity_countries
[0m17:36:12.930904 [info ] [Thread-2 (]: 2 of 9 START sql view model bc_production.stg_higher_activity_countries ........ [RUN]
[0m17:36:12.929169 [info ] [Thread-1 (]: 1 of 9 START sql view model bc_production.stg_country_code_ref ................. [RUN]
[0m17:36:12.930131 [debug] [Thread-3 (]: Began running node model.bc_sales.stg_sales_by_country
[0m17:36:12.932378 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bc_sales.stg_higher_activity_countries'
[0m17:36:12.933774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datatalksclub-375802_bc_production, now model.bc_sales.stg_country_code_ref)
[0m17:36:12.935326 [debug] [Thread-2 (]: Began compiling node model.bc_sales.stg_higher_activity_countries
[0m17:36:12.934549 [info ] [Thread-3 (]: 3 of 9 START sql view model bc_production.stg_sales_by_country ................. [RUN]
[0m17:36:12.936288 [debug] [Thread-1 (]: Began compiling node model.bc_sales.stg_country_code_ref
[0m17:36:12.943189 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:36:12.944829 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bc_sales.stg_sales_by_country'
[0m17:36:12.949606 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.stg_country_code_ref"
[0m17:36:12.950610 [debug] [Thread-3 (]: Began compiling node model.bc_sales.stg_sales_by_country
[0m17:36:12.955617 [debug] [Thread-3 (]: Writing injected SQL for node "model.bc_sales.stg_sales_by_country"
[0m17:36:12.957090 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (compile): 17:36:12.945439 => 17:36:12.956627
[0m17:36:12.960521 [debug] [Thread-1 (]: Began executing node model.bc_sales.stg_country_code_ref
[0m17:36:12.968827 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (compile): 17:36:12.951302 => 17:36:12.968122
[0m17:36:12.969914 [debug] [Thread-3 (]: Began executing node model.bc_sales.stg_sales_by_country
[0m17:36:13.068406 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.stg_country_code_ref"
[0m17:36:13.069148 [debug] [Thread-3 (]: Writing runtime sql for node "model.bc_sales.stg_sales_by_country"
[0m17:36:13.070168 [debug] [Thread-2 (]: On model.bc_sales.stg_higher_activity_countries: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "prod", "node_id": "model.bc_sales.stg_higher_activity_countries"} */

    select cc_ref
    from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`
    where count > 20
    order by
	cc_ref desc
    limit 1

[0m17:36:13.071138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:13.081211 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:36:13.164076 [debug] [Thread-1 (]: On model.bc_sales.stg_country_code_ref: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "prod", "node_id": "model.bc_sales.stg_country_code_ref"} */


  create or replace view `datatalksclub-375802`.`bc_production`.`stg_country_code_ref`
  OPTIONS()
  as 

select * from `datatalksclub-375802`.`bandcamp_sales_schema`.`country_code_ref`;


[0m17:36:13.221475 [debug] [Thread-3 (]: On model.bc_sales.stg_sales_by_country: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "prod", "node_id": "model.bc_sales.stg_sales_by_country"} */


  create or replace view `datatalksclub-375802`.`bc_production`.`stg_sales_by_country`
  OPTIONS()
  as 

-- Q1

select
  cast(cc_ref as integer) as cc_ref,
  cast(amount_paid_usd as numeric) as amount_paid_usd,

  cast(country_code as string) as country_code,
  cast(country as string) as country

from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_partitioned`;


[0m17:36:14.044552 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:85bb03ae-af19-4bbe-9b4f-2b6886cdcdda&page=queryresults
[0m17:36:14.064431 [debug] [Thread-1 (]: Timing info for model.bc_sales.stg_country_code_ref (execute): 17:36:12.961102 => 17:36:14.064133
[0m17:36:14.065651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7123d0a-cd71-406c-b650-dab9a677e762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c6d41c60>]}
[0m17:36:14.066653 [info ] [Thread-1 (]: 1 of 9 OK created sql view model bc_production.stg_country_code_ref ............ [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m17:36:14.070631 [debug] [Thread-1 (]: Finished running node model.bc_sales.stg_country_code_ref
[0m17:36:14.285108 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:24ee2c35-cf5d-4a9e-90b3-a7396d0d9986&page=queryresults
[0m17:36:14.288339 [debug] [Thread-3 (]: Timing info for model.bc_sales.stg_sales_by_country (execute): 17:36:12.970489 => 17:36:14.288006
[0m17:36:14.289663 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7123d0a-cd71-406c-b650-dab9a677e762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c6bcdb70>]}
[0m17:36:14.290616 [info ] [Thread-3 (]: 3 of 9 OK created sql view model bc_production.stg_sales_by_country ............ [[32mCREATE VIEW (0 processed)[0m in 1.35s]
[0m17:36:14.291859 [debug] [Thread-3 (]: Finished running node model.bc_sales.stg_sales_by_country
[0m17:36:14.292876 [debug] [Thread-4 (]: Began running node model.bc_sales.country_facts
[0m17:36:14.293546 [info ] [Thread-4 (]: 4 of 9 START sql table model bc_production.country_facts ....................... [RUN]
[0m17:36:14.294971 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bc_sales.country_facts'
[0m17:36:14.295543 [debug] [Thread-4 (]: Began compiling node model.bc_sales.country_facts
[0m17:36:14.300914 [debug] [Thread-4 (]: Writing injected SQL for node "model.bc_sales.country_facts"
[0m17:36:14.302038 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (compile): 17:36:14.295970 => 17:36:14.301653
[0m17:36:14.303376 [debug] [Thread-4 (]: Began executing node model.bc_sales.country_facts
[0m17:36:14.345870 [debug] [Thread-4 (]: Writing runtime sql for node "model.bc_sales.country_facts"
[0m17:36:14.347143 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:36:14.399948 [debug] [Thread-4 (]: On model.bc_sales.country_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "prod", "node_id": "model.bc_sales.country_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bc_production`.`country_facts`
    
    

    OPTIONS()
    as (
      


with countries as (
    select * from `datatalksclub-375802`.`bc_production`.`stg_sales_by_country`
)

select
    countries.cc_ref as ref,
    count(countries.cc_ref) as total_transactions,
    avg(countries.amount_paid_usd) as average_sale_usd,
    sum(countries.amount_paid_usd) as total_sales_usd,
from countries
group by countries.cc_ref
order by average_sale_usd desc
    );
  
[0m17:36:14.485497 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:1023c894-2a2e-4e76-a745-2b61f12777ac&page=queryresults
[0m17:36:14.486854 [debug] [Thread-2 (]: Writing injected SQL for node "model.bc_sales.stg_higher_activity_countries"
[0m17:36:14.487958 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (compile): 17:36:12.936686 => 17:36:14.487523
[0m17:36:14.488561 [debug] [Thread-2 (]: Began executing node model.bc_sales.stg_higher_activity_countries
[0m17:36:14.493917 [debug] [Thread-2 (]: Writing runtime sql for node "model.bc_sales.stg_higher_activity_countries"
[0m17:36:14.494785 [debug] [Thread-2 (]: On model.bc_sales.stg_higher_activity_countries: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "prod", "node_id": "model.bc_sales.stg_higher_activity_countries"} */


  create or replace view `datatalksclub-375802`.`bc_production`.`stg_higher_activity_countries`
  OPTIONS()
  as 

-- Q2, Q3

select
    cast(cc_ref as integer) as cc_ref,
    cast(artist_name as string) as artist_name,
    cast(amount_paid_usd as numeric) as amount_paid_usd,
    cast(country_code as string) as country_code, --REMOVE THIS TOO??
    cast(country as string) as country -- TODO: REMOVE THIS LINE
from `datatalksclub-375802`.`bandcamp_sales_schema`.`sales_clustered`
where cc_ref <= 115
order by
    cc_ref asc,
    artist_name asc;


[0m17:36:15.072984 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:685c027f-c58d-41bf-9518-4b6656d0d521&page=queryresults
[0m17:36:15.075923 [debug] [Thread-2 (]: Timing info for model.bc_sales.stg_higher_activity_countries (execute): 17:36:14.488950 => 17:36:15.075579
[0m17:36:15.077106 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7123d0a-cd71-406c-b650-dab9a677e762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c6c2edd0>]}
[0m17:36:15.077996 [info ] [Thread-2 (]: 2 of 9 OK created sql view model bc_production.stg_higher_activity_countries ... [[32mCREATE VIEW (0 processed)[0m in 2.15s]
[0m17:36:15.079206 [debug] [Thread-2 (]: Finished running node model.bc_sales.stg_higher_activity_countries
[0m17:36:15.080201 [debug] [Thread-3 (]: Began running node model.bc_sales.artist_facts
[0m17:36:15.080892 [info ] [Thread-3 (]: 5 of 9 START sql table model bc_production.artist_facts ........................ [RUN]
[0m17:36:15.082300 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bc_sales.stg_sales_by_country, now model.bc_sales.artist_facts)
[0m17:36:15.082970 [debug] [Thread-3 (]: Began compiling node model.bc_sales.artist_facts
[0m17:36:15.094007 [debug] [Thread-3 (]: Writing injected SQL for node "model.bc_sales.artist_facts"
[0m17:36:15.095168 [debug] [Thread-3 (]: Timing info for model.bc_sales.artist_facts (compile): 17:36:15.083340 => 17:36:15.094795
[0m17:36:15.095823 [debug] [Thread-3 (]: Began executing node model.bc_sales.artist_facts
[0m17:36:15.100570 [debug] [Thread-3 (]: Writing runtime sql for node "model.bc_sales.artist_facts"
[0m17:36:15.101520 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:36:15.151004 [debug] [Thread-3 (]: On model.bc_sales.artist_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "prod", "node_id": "model.bc_sales.artist_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bc_production`.`artist_facts`
    
    

    OPTIONS()
    as (
      

with sales as (
    select * from `datatalksclub-375802`.`bc_production`.`stg_higher_activity_countries`
)

select
    cc_ref as cc_ref,
    artist_name as artist,
    sum(amount_paid_usd) as total_sales_usd,
    avg(amount_paid_usd) as avg_sales_usd,
from sales
group by 1,2
order by 1, 3 desc
    );
  
[0m17:36:16.648347 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:21008db2-45b7-44fc-b970-b14937aff774&page=queryresults
[0m17:36:16.651681 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts (execute): 17:36:14.304179 => 17:36:16.651315
[0m17:36:16.653397 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7123d0a-cd71-406c-b650-dab9a677e762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c65f7d90>]}
[0m17:36:16.654792 [info ] [Thread-4 (]: 4 of 9 OK created sql table model bc_production.country_facts .................. [[32mCREATE TABLE (186.0 rows, 15.3 MiB processed)[0m in 2.36s]
[0m17:36:16.656152 [debug] [Thread-4 (]: Finished running node model.bc_sales.country_facts
[0m17:36:16.657097 [debug] [Thread-4 (]: Began running node model.bc_sales.country_facts_view
[0m17:36:16.657765 [info ] [Thread-4 (]: 6 of 9 START sql table model bc_production.country_facts_view .................. [RUN]
[0m17:36:16.659262 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bc_sales.country_facts, now model.bc_sales.country_facts_view)
[0m17:36:16.659804 [debug] [Thread-4 (]: Began compiling node model.bc_sales.country_facts_view
[0m17:36:16.665513 [debug] [Thread-4 (]: Writing injected SQL for node "model.bc_sales.country_facts_view"
[0m17:36:16.666627 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts_view (compile): 17:36:16.660158 => 17:36:16.666264
[0m17:36:16.667194 [debug] [Thread-4 (]: Began executing node model.bc_sales.country_facts_view
[0m17:36:16.672312 [debug] [Thread-4 (]: Writing runtime sql for node "model.bc_sales.country_facts_view"
[0m17:36:16.673308 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:36:16.723106 [debug] [Thread-4 (]: On model.bc_sales.country_facts_view: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "prod", "node_id": "model.bc_sales.country_facts_view"} */

  
    

    create or replace table `datatalksclub-375802`.`bc_production`.`country_facts_view`
    
    

    OPTIONS()
    as (
      

with facts as (
    select * from `datatalksclub-375802`.`bc_production`.`country_facts`
),

refs as (
    select * from `datatalksclub-375802`.`bc_production`.`stg_country_code_ref`
)

select
    facts.ref as ref,
    facts.total_transactions as total_transactions,
    facts.average_sale_usd as avg_sale_usd,
    facts.total_sales_usd as total_sales_usd,
    refs.country_code as cc
from facts
left join refs
on facts.ref = refs.cc_ref
where total_transactions > 100
order by 3 desc
    );
  
[0m17:36:18.581298 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:c6b10c8e-0646-4fe1-a55c-deae322eaa06&page=queryresults
[0m17:36:18.584601 [debug] [Thread-3 (]: Timing info for model.bc_sales.artist_facts (execute): 17:36:15.096173 => 17:36:18.584260
[0m17:36:18.585902 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7123d0a-cd71-406c-b650-dab9a677e762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c6c2eda0>]}
[0m17:36:18.586955 [info ] [Thread-3 (]: 5 of 9 OK created sql table model bc_production.artist_facts ................... [[32mCREATE TABLE (361.0k rows, 29.5 MiB processed)[0m in 3.50s]
[0m17:36:18.588771 [debug] [Thread-3 (]: Finished running node model.bc_sales.artist_facts
[0m17:36:18.590275 [debug] [Thread-3 (]: Began running node model.bc_sales.artist_max_avg_facts
[0m17:36:18.590984 [debug] [Thread-1 (]: Began running node model.bc_sales.artist_max_sales_facts
[0m17:36:18.591854 [info ] [Thread-3 (]: 7 of 9 START sql table model bc_production.artist_max_avg_facts ................ [RUN]
[0m17:36:18.592561 [info ] [Thread-1 (]: 8 of 9 START sql table model bc_production.artist_max_sales_facts .............. [RUN]
[0m17:36:18.595221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bc_sales.stg_country_code_ref, now model.bc_sales.artist_max_sales_facts)
[0m17:36:18.594276 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bc_sales.artist_facts, now model.bc_sales.artist_max_avg_facts)
[0m17:36:18.595856 [debug] [Thread-1 (]: Began compiling node model.bc_sales.artist_max_sales_facts
[0m17:36:18.596444 [debug] [Thread-3 (]: Began compiling node model.bc_sales.artist_max_avg_facts
[0m17:36:18.603123 [debug] [Thread-1 (]: Writing injected SQL for node "model.bc_sales.artist_max_sales_facts"
[0m17:36:18.609515 [debug] [Thread-3 (]: Writing injected SQL for node "model.bc_sales.artist_max_avg_facts"
[0m17:36:18.611135 [debug] [Thread-3 (]: Timing info for model.bc_sales.artist_max_avg_facts (compile): 17:36:18.603829 => 17:36:18.610706
[0m17:36:18.612102 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_max_sales_facts (compile): 17:36:18.596852 => 17:36:18.611613
[0m17:36:18.612718 [debug] [Thread-3 (]: Began executing node model.bc_sales.artist_max_avg_facts
[0m17:36:18.613361 [debug] [Thread-1 (]: Began executing node model.bc_sales.artist_max_sales_facts
[0m17:36:18.624388 [debug] [Thread-1 (]: Writing runtime sql for node "model.bc_sales.artist_max_sales_facts"
[0m17:36:18.633124 [debug] [Thread-3 (]: Writing runtime sql for node "model.bc_sales.artist_max_avg_facts"
[0m17:36:18.634568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:18.635397 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:36:18.730264 [debug] [Thread-3 (]: On model.bc_sales.artist_max_avg_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "prod", "node_id": "model.bc_sales.artist_max_avg_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bc_production`.`artist_max_avg_facts`
    
    

    OPTIONS()
    as (
      

with facts as (
    select * from `datatalksclub-375802`.`bc_production`.`artist_facts`
),

refs as (
    select * from `datatalksclub-375802`.`bc_production`.`stg_country_code_ref`
),

max_avg_sales as (
    select
        facts.cc_ref as ref,
        --facts.artist,
        max(facts.avg_sales_usd) as max_avg_usd
    from facts
    group by 1
)

select
    max_avg_sales.ref as ref,
    max_avg_sales.max_avg_usd as max_avg_usd,
    facts.artist as artist
from max_avg_sales
left join facts
on max_avg_sales.ref = facts.cc_ref
and max_avg_sales.max_avg_usd = facts.avg_sales_usd
order by 1
    );
  
[0m17:36:18.733008 [debug] [Thread-1 (]: On model.bc_sales.artist_max_sales_facts: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "prod", "node_id": "model.bc_sales.artist_max_sales_facts"} */

  
    

    create or replace table `datatalksclub-375802`.`bc_production`.`artist_max_sales_facts`
    
    

    OPTIONS()
    as (
      

with facts as (
    select * from `datatalksclub-375802`.`bc_production`.`artist_facts`
),

refs as (
    select * from `datatalksclub-375802`.`bc_production`.`stg_country_code_ref`
),

max_total_sales as (
    select
        facts.cc_ref as ref,
        --facts.artist,
        max(facts.total_sales_usd) as max_sales_usd
    from facts
    group by 1
    order by 1
)

select
    max_total_sales.ref as ref,
    max_total_sales.max_sales_usd as max_sales_usd,
    facts.artist as artist
from max_total_sales
left join facts
on max_total_sales.ref = facts.cc_ref
and max_total_sales.max_sales_usd = facts.total_sales_usd
order by 1
    );
  
[0m17:36:18.935702 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:ba9cf089-6ffa-4513-b39e-7a8a42daa13e&page=queryresults
[0m17:36:18.938680 [debug] [Thread-4 (]: Timing info for model.bc_sales.country_facts_view (execute): 17:36:16.667548 => 17:36:18.938389
[0m17:36:18.940787 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7123d0a-cd71-406c-b650-dab9a677e762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c6637b20>]}
[0m17:36:18.944613 [info ] [Thread-4 (]: 6 of 9 OK created sql table model bc_production.country_facts_view ............. [[32mCREATE TABLE (78.0 rows, 10.9 KiB processed)[0m in 2.28s]
[0m17:36:18.945880 [debug] [Thread-4 (]: Finished running node model.bc_sales.country_facts_view
[0m17:36:21.099384 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:f8b08ed1-ab77-436f-9af7-3ac9cb0a8cb7&page=queryresults
[0m17:36:21.102513 [debug] [Thread-1 (]: Timing info for model.bc_sales.artist_max_sales_facts (execute): 17:36:18.618348 => 17:36:21.102215
[0m17:36:21.104350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7123d0a-cd71-406c-b650-dab9a677e762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c445d000>]}
[0m17:36:21.105372 [info ] [Thread-1 (]: 8 of 9 OK created sql table model bc_production.artist_max_sales_facts ......... [[32mCREATE TABLE (118.0 rows, 13.5 MiB processed)[0m in 2.51s]
[0m17:36:21.106726 [debug] [Thread-1 (]: Finished running node model.bc_sales.artist_max_sales_facts
[0m17:36:21.409139 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:bb5f9869-6346-4d17-8ff4-c318c507f34b&page=queryresults
[0m17:36:21.411853 [debug] [Thread-3 (]: Timing info for model.bc_sales.artist_max_avg_facts (execute): 17:36:18.613791 => 17:36:21.411504
[0m17:36:21.413031 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7123d0a-cd71-406c-b650-dab9a677e762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c663b370>]}
[0m17:36:21.413971 [info ] [Thread-3 (]: 7 of 9 OK created sql table model bc_production.artist_max_avg_facts ........... [[32mCREATE TABLE (119.0 rows, 13.5 MiB processed)[0m in 2.82s]
[0m17:36:21.415197 [debug] [Thread-3 (]: Finished running node model.bc_sales.artist_max_avg_facts
[0m17:36:21.416481 [debug] [Thread-2 (]: Began running node model.bc_sales.complete_artist_by_country
[0m17:36:21.417186 [info ] [Thread-2 (]: 9 of 9 START sql table model bc_production.complete_artist_by_country .......... [RUN]
[0m17:36:21.418807 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bc_sales.stg_higher_activity_countries, now model.bc_sales.complete_artist_by_country)
[0m17:36:21.419819 [debug] [Thread-2 (]: Began compiling node model.bc_sales.complete_artist_by_country
[0m17:36:21.427710 [debug] [Thread-2 (]: Writing injected SQL for node "model.bc_sales.complete_artist_by_country"
[0m17:36:21.429197 [debug] [Thread-2 (]: Timing info for model.bc_sales.complete_artist_by_country (compile): 17:36:21.420220 => 17:36:21.428757
[0m17:36:21.429892 [debug] [Thread-2 (]: Began executing node model.bc_sales.complete_artist_by_country
[0m17:36:21.435262 [debug] [Thread-2 (]: Writing runtime sql for node "model.bc_sales.complete_artist_by_country"
[0m17:36:21.436338 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:36:21.486549 [debug] [Thread-2 (]: On model.bc_sales.complete_artist_by_country: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "bc_sales", "target_name": "prod", "node_id": "model.bc_sales.complete_artist_by_country"} */

  
    

    create or replace table `datatalksclub-375802`.`bc_production`.`complete_artist_by_country`
    
    

    OPTIONS()
    as (
      

with refs as (
    select * from `datatalksclub-375802`.`bc_production`.`stg_country_code_ref`
),

max_totals as (
    select * from `datatalksclub-375802`.`bc_production`.`artist_max_sales_facts`
),

max_avg as (
    select * from `datatalksclub-375802`.`bc_production`.`artist_max_avg_facts`
)

select
    refs.cc_ref as ref,
    refs.country_code,
    max_totals.artist as highest_selling,
    max_avg.artist as highest_average,
from refs
right join max_totals
on refs.cc_ref = max_totals.ref
right join max_avg
on refs.cc_ref = max_avg.ref
order by 1
    );
  
[0m17:36:23.664129 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=datatalksclub-375802&j=bq:us-central1:be0ede60-36b0-4e23-951a-426f81af24bc&page=queryresults
[0m17:36:23.667344 [debug] [Thread-2 (]: Timing info for model.bc_sales.complete_artist_by_country (execute): 17:36:21.430281 => 17:36:23.667005
[0m17:36:23.668840 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7123d0a-cd71-406c-b650-dab9a677e762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c6bed960>]}
[0m17:36:23.669942 [info ] [Thread-2 (]: 9 of 9 OK created sql table model bc_production.complete_artist_by_country ..... [[32mCREATE TABLE (123.0 rows, 7.4 KiB processed)[0m in 2.25s]
[0m17:36:23.671256 [debug] [Thread-2 (]: Finished running node model.bc_sales.complete_artist_by_country
[0m17:36:23.674145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:36:23.674589 [debug] [MainThread]: Connection 'model.bc_sales.artist_max_sales_facts' was properly closed.
[0m17:36:23.674931 [debug] [MainThread]: Connection 'model.bc_sales.complete_artist_by_country' was properly closed.
[0m17:36:23.675273 [debug] [MainThread]: Connection 'model.bc_sales.artist_max_avg_facts' was properly closed.
[0m17:36:23.675581 [debug] [MainThread]: Connection 'model.bc_sales.country_facts_view' was properly closed.
[0m17:36:23.676140 [info ] [MainThread]: 
[0m17:36:23.676820 [info ] [MainThread]: Finished running 3 view models, 6 table models in 0 hours 0 minutes and 11.44 seconds (11.44s).
[0m17:36:23.679504 [debug] [MainThread]: Command end result
[0m17:36:23.698786 [info ] [MainThread]: 
[0m17:36:23.700520 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:36:23.701298 [info ] [MainThread]: 
[0m17:36:23.702154 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m17:36:23.703388 [debug] [MainThread]: Command `dbt build` succeeded at 17:36:23.703208 after 14.06 seconds
[0m17:36:23.703984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0da04a5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c7239ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c6bed960>]}
[0m17:36:23.704561 [debug] [MainThread]: Flushing usage events
